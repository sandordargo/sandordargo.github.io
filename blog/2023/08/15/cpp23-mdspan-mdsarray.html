<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="C++23: mdspan" /><meta property="og:locale" content="en_US" /><meta name="description" content="Recently, we discussed that C++23 introduces the multidimensional subscript operator which will work - for the time being - only with new containers. In C++23 that basically means mdspan. In C++26, a similar type mdarray will follow, but it’s also possible that existing types will start supporting the multidimensional subscript operator. In this post, let’s review what this new type - mdspan - is about. An immense work to introduce a new container First of all, let’s remind ourselves what a big work certain people put in into the standardization, or in other words, how much certain people work on making C++ better and safer. They deserve our gratitude. If you look at this page (and at the below screenshot), you’ll see 5 different papers listed next to mdspan. Those 5 papers don’t even include the one for the multidimensional subscript operator! The 5 papers of mdspan in C++23 Why are there five different papers and what are they about? The reason behind this is that we are human beings and we cannot make perfect designs on the first run. To be fair, not even ChatGPT can. If you check the first paper, you’ll see 18 (!) revisions spanning over 7 years (pun intended)! That’s a lot of time and work introducing a new header! The other 4 papers contain minor fixes about changing some types, renaming certain members, adding a missing empty() member function and modifying constructor behaviour. Despite all the work, not every originally proposed feature made it to C++23, for example, submdspan (a view of a subset of an existing mdspan) should follow in the next standard. At the time of writing, only Clang 17 supports it which I don’t have access to and Compiler Explorer doesn’t support it yet either. But we might play with kokkos/mdspan reference implementation even on Compiler Explorer. Main characteristics First of all, mdspan is similar to span in the sense that it’s a non-owning array view. A multidimensional array can map a tuple of indexes to one single element of the underlying container. Each indice can go from zero to the indice’s extent - 1 where the product of extents is the size of the underlying array. Please note that the stdex namespace is to refers to the reference implementation coming from kokkos/mdspan 1 2 3 4 5 6 7 8 9 10 11 12 13 std::array numbers {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; stdex::mdspan mdspanOfNumbers {numbers.data(), stdex::extents{2, 5}}; for (size_t rowIndex=0; rowIndex &lt; mdspanOfNumbers.extent(0); ++rowIndex) { for (size_t columnIndex=0; columnIndex &lt; mdspanOfNumbers.extent(1); ++columnIndex) { std::cout &lt;&lt; mdspanOfNumbers[rowIndex, columnIndex] &lt;&lt; &#39; &#39;; } std::cout &lt;&lt; &#39;\n&#39;; } /* 1 2 3 4 5 6 7 8 9 10 */ Multidimensional arrays have long been useful for representing large amounts of data, describing points in physical space, or expressing approximations of functions. They are a natural way to represent mathematical objects like matrices and tensors. C++, so far, has not provided good enough support for multidimensional arrays. Although there are different options available for the developers (detailed here), they either lack some runtime-aspects, or they don’t provide the desired attributes in terms of type homogeneity or memory allocations. In terms of memory layout, mdspan is really flexible coming with three different layouts. In layout_right, the rightmost index gives access to the row, so it starts with the column on the left - that’s how we used to do things in C and C++. layout_left provides the opposite behaviour where the leftmost index is the row and the rightmost is the column - this emulates Fortran’s and Matlab’s behaviour. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 std::array numbers {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; stdex::mdspan&lt;int, stdex::extents&lt;int, 2, 5&gt;, stdex::layout_right&gt; mdspanOfNumbers {numbers.data()}; for (size_t rowIndex=0; rowIndex &lt; mdspanOfNumbers.extent(0); ++rowIndex) { for (size_t columnIndex=0; columnIndex &lt; mdspanOfNumbers.extent(1); ++columnIndex) { std::cout &lt;&lt; mdspanOfNumbers[rowIndex, columnIndex] &lt;&lt; &#39; &#39;; } std::cout &lt;&lt; &#39;\n&#39;; } /* 1 2 3 4 5 6 7 8 9 10 */ std::array numbers {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; stdex::mdspan&lt;int, stdex::extents&lt;int, 2, 5&gt;, stdex::layout_left&gt; mdspanOfNumbers {numbers.data()}; for (size_t columnIndex=0; columnIndex &lt; mdspanOfNumbers.extent(0); ++columnIndex) { for (size_t rowIndex=0; rowIndex &lt; mdspanOfNumbers.extent(1); ++rowIndex) { std::cout &lt;&lt; mdspanOfNumbers[columnIndex, rowIndex] &lt;&lt; &#39; &#39;; } std::cout &lt;&lt; &#39;\n&#39;; } /* 1 3 5 7 9 2 4 6 8 10 */ Note that in the above two examples, the outputs are the same, but we changed the layout and the order of columns and rows. You can also observe in the above example that while previously we passed the extents as part of the constructor call, we can also pass them as class template arguments. There is also layout_stride available which provides a generalization of the other two which lets you specify a different stride for each extent. As you might have guessed, the reason behind providing different layouts is language interoperability. In mdspan not only the layout is customizable, but also the accessors. Different hardware can have different behaviour and different libraries or language extensions can have different concepts of memory accesses. In order to support the different needs, one can customize the data accessors. You can find an elaborate example here. Now you might ask, why do we get a view (mdspan) before a multidimensional container?! There is ongoing work also for creating a standalone container called mdarray, but the span had the priority. The reason behind this is that we use span-like features more often than the full features containers. We more often pass around containers by reference just to access elements or call the .size() member function than actually performing memory allocations. This is even truer in the world of parallel programming, “where multiple processing units access different elements of the same array in parallel […] memory allocation and deallocation are “synchronization points” for parallel processing units. Conclusion In this post, we discovered another new feature of C++23, multidimensional array views, a.k.a. mdspan. We saw the motivations behind creating this new view and why it’s even more important than an owning container. We saw some of the main characteristics of mdspan, how we can create and use it. We also saw, how customizable it is to provide compatibility with different languages and hardware. We also saw what an immense work it has been to create this new standardized view. You might look for more features that you might have heard about (such as submdspan), but despite all these papers and revisions, not all the parts made it to C++23. Thanks for the work of the authors and thanks to you for reading this article! Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter and let’s connect on Twitter!" /><meta property="og:description" content="Recently, we discussed that C++23 introduces the multidimensional subscript operator which will work - for the time being - only with new containers. In C++23 that basically means mdspan. In C++26, a similar type mdarray will follow, but it’s also possible that existing types will start supporting the multidimensional subscript operator. In this post, let’s review what this new type - mdspan - is about. An immense work to introduce a new container First of all, let’s remind ourselves what a big work certain people put in into the standardization, or in other words, how much certain people work on making C++ better and safer. They deserve our gratitude. If you look at this page (and at the below screenshot), you’ll see 5 different papers listed next to mdspan. Those 5 papers don’t even include the one for the multidimensional subscript operator! The 5 papers of mdspan in C++23 Why are there five different papers and what are they about? The reason behind this is that we are human beings and we cannot make perfect designs on the first run. To be fair, not even ChatGPT can. If you check the first paper, you’ll see 18 (!) revisions spanning over 7 years (pun intended)! That’s a lot of time and work introducing a new header! The other 4 papers contain minor fixes about changing some types, renaming certain members, adding a missing empty() member function and modifying constructor behaviour. Despite all the work, not every originally proposed feature made it to C++23, for example, submdspan (a view of a subset of an existing mdspan) should follow in the next standard. At the time of writing, only Clang 17 supports it which I don’t have access to and Compiler Explorer doesn’t support it yet either. But we might play with kokkos/mdspan reference implementation even on Compiler Explorer. Main characteristics First of all, mdspan is similar to span in the sense that it’s a non-owning array view. A multidimensional array can map a tuple of indexes to one single element of the underlying container. Each indice can go from zero to the indice’s extent - 1 where the product of extents is the size of the underlying array. Please note that the stdex namespace is to refers to the reference implementation coming from kokkos/mdspan 1 2 3 4 5 6 7 8 9 10 11 12 13 std::array numbers {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; stdex::mdspan mdspanOfNumbers {numbers.data(), stdex::extents{2, 5}}; for (size_t rowIndex=0; rowIndex &lt; mdspanOfNumbers.extent(0); ++rowIndex) { for (size_t columnIndex=0; columnIndex &lt; mdspanOfNumbers.extent(1); ++columnIndex) { std::cout &lt;&lt; mdspanOfNumbers[rowIndex, columnIndex] &lt;&lt; &#39; &#39;; } std::cout &lt;&lt; &#39;\n&#39;; } /* 1 2 3 4 5 6 7 8 9 10 */ Multidimensional arrays have long been useful for representing large amounts of data, describing points in physical space, or expressing approximations of functions. They are a natural way to represent mathematical objects like matrices and tensors. C++, so far, has not provided good enough support for multidimensional arrays. Although there are different options available for the developers (detailed here), they either lack some runtime-aspects, or they don’t provide the desired attributes in terms of type homogeneity or memory allocations. In terms of memory layout, mdspan is really flexible coming with three different layouts. In layout_right, the rightmost index gives access to the row, so it starts with the column on the left - that’s how we used to do things in C and C++. layout_left provides the opposite behaviour where the leftmost index is the row and the rightmost is the column - this emulates Fortran’s and Matlab’s behaviour. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 std::array numbers {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; stdex::mdspan&lt;int, stdex::extents&lt;int, 2, 5&gt;, stdex::layout_right&gt; mdspanOfNumbers {numbers.data()}; for (size_t rowIndex=0; rowIndex &lt; mdspanOfNumbers.extent(0); ++rowIndex) { for (size_t columnIndex=0; columnIndex &lt; mdspanOfNumbers.extent(1); ++columnIndex) { std::cout &lt;&lt; mdspanOfNumbers[rowIndex, columnIndex] &lt;&lt; &#39; &#39;; } std::cout &lt;&lt; &#39;\n&#39;; } /* 1 2 3 4 5 6 7 8 9 10 */ std::array numbers {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; stdex::mdspan&lt;int, stdex::extents&lt;int, 2, 5&gt;, stdex::layout_left&gt; mdspanOfNumbers {numbers.data()}; for (size_t columnIndex=0; columnIndex &lt; mdspanOfNumbers.extent(0); ++columnIndex) { for (size_t rowIndex=0; rowIndex &lt; mdspanOfNumbers.extent(1); ++rowIndex) { std::cout &lt;&lt; mdspanOfNumbers[columnIndex, rowIndex] &lt;&lt; &#39; &#39;; } std::cout &lt;&lt; &#39;\n&#39;; } /* 1 3 5 7 9 2 4 6 8 10 */ Note that in the above two examples, the outputs are the same, but we changed the layout and the order of columns and rows. You can also observe in the above example that while previously we passed the extents as part of the constructor call, we can also pass them as class template arguments. There is also layout_stride available which provides a generalization of the other two which lets you specify a different stride for each extent. As you might have guessed, the reason behind providing different layouts is language interoperability. In mdspan not only the layout is customizable, but also the accessors. Different hardware can have different behaviour and different libraries or language extensions can have different concepts of memory accesses. In order to support the different needs, one can customize the data accessors. You can find an elaborate example here. Now you might ask, why do we get a view (mdspan) before a multidimensional container?! There is ongoing work also for creating a standalone container called mdarray, but the span had the priority. The reason behind this is that we use span-like features more often than the full features containers. We more often pass around containers by reference just to access elements or call the .size() member function than actually performing memory allocations. This is even truer in the world of parallel programming, “where multiple processing units access different elements of the same array in parallel […] memory allocation and deallocation are “synchronization points” for parallel processing units. Conclusion In this post, we discovered another new feature of C++23, multidimensional array views, a.k.a. mdspan. We saw the motivations behind creating this new view and why it’s even more important than an owning container. We saw some of the main characteristics of mdspan, how we can create and use it. We also saw, how customizable it is to provide compatibility with different languages and hardware. We also saw what an immense work it has been to create this new standardized view. You might look for more features that you might have heard about (such as submdspan), but despite all these papers and revisions, not all the parts made it to C++23. Thanks for the work of the authors and thanks to you for reading this article! Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter and let’s connect on Twitter!" /><link rel="canonical" href="https://www.sandordargo.com/blog/2023/08/15/cpp23-mdspan-mdsarray" /><meta property="og:url" content="https://www.sandordargo.com/blog/2023/08/15/cpp23-mdspan-mdsarray" /><meta property="og:site_name" content="Sandor Dargo’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-15T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="C++23: mdspan" /><meta name="twitter:site" content="@SandorDargo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-08-15T00:00:00+02:00","datePublished":"2023-08-15T00:00:00+02:00","description":"Recently, we discussed that C++23 introduces the multidimensional subscript operator which will work - for the time being - only with new containers. In C++23 that basically means mdspan. In C++26, a similar type mdarray will follow, but it’s also possible that existing types will start supporting the multidimensional subscript operator. In this post, let’s review what this new type - mdspan - is about. An immense work to introduce a new container First of all, let’s remind ourselves what a big work certain people put in into the standardization, or in other words, how much certain people work on making C++ better and safer. They deserve our gratitude. If you look at this page (and at the below screenshot), you’ll see 5 different papers listed next to mdspan. Those 5 papers don’t even include the one for the multidimensional subscript operator! The 5 papers of mdspan in C++23 Why are there five different papers and what are they about? The reason behind this is that we are human beings and we cannot make perfect designs on the first run. To be fair, not even ChatGPT can. If you check the first paper, you’ll see 18 (!) revisions spanning over 7 years (pun intended)! That’s a lot of time and work introducing a new header! The other 4 papers contain minor fixes about changing some types, renaming certain members, adding a missing empty() member function and modifying constructor behaviour. Despite all the work, not every originally proposed feature made it to C++23, for example, submdspan (a view of a subset of an existing mdspan) should follow in the next standard. At the time of writing, only Clang 17 supports it which I don’t have access to and Compiler Explorer doesn’t support it yet either. But we might play with kokkos/mdspan reference implementation even on Compiler Explorer. Main characteristics First of all, mdspan is similar to span in the sense that it’s a non-owning array view. A multidimensional array can map a tuple of indexes to one single element of the underlying container. Each indice can go from zero to the indice’s extent - 1 where the product of extents is the size of the underlying array. Please note that the stdex namespace is to refers to the reference implementation coming from kokkos/mdspan 1 2 3 4 5 6 7 8 9 10 11 12 13 std::array numbers {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; stdex::mdspan mdspanOfNumbers {numbers.data(), stdex::extents{2, 5}}; for (size_t rowIndex=0; rowIndex &lt; mdspanOfNumbers.extent(0); ++rowIndex) { for (size_t columnIndex=0; columnIndex &lt; mdspanOfNumbers.extent(1); ++columnIndex) { std::cout &lt;&lt; mdspanOfNumbers[rowIndex, columnIndex] &lt;&lt; &#39; &#39;; } std::cout &lt;&lt; &#39;\\n&#39;; } /* 1 2 3 4 5 6 7 8 9 10 */ Multidimensional arrays have long been useful for representing large amounts of data, describing points in physical space, or expressing approximations of functions. They are a natural way to represent mathematical objects like matrices and tensors. C++, so far, has not provided good enough support for multidimensional arrays. Although there are different options available for the developers (detailed here), they either lack some runtime-aspects, or they don’t provide the desired attributes in terms of type homogeneity or memory allocations. In terms of memory layout, mdspan is really flexible coming with three different layouts. In layout_right, the rightmost index gives access to the row, so it starts with the column on the left - that’s how we used to do things in C and C++. layout_left provides the opposite behaviour where the leftmost index is the row and the rightmost is the column - this emulates Fortran’s and Matlab’s behaviour. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 std::array numbers {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; stdex::mdspan&lt;int, stdex::extents&lt;int, 2, 5&gt;, stdex::layout_right&gt; mdspanOfNumbers {numbers.data()}; for (size_t rowIndex=0; rowIndex &lt; mdspanOfNumbers.extent(0); ++rowIndex) { for (size_t columnIndex=0; columnIndex &lt; mdspanOfNumbers.extent(1); ++columnIndex) { std::cout &lt;&lt; mdspanOfNumbers[rowIndex, columnIndex] &lt;&lt; &#39; &#39;; } std::cout &lt;&lt; &#39;\\n&#39;; } /* 1 2 3 4 5 6 7 8 9 10 */ std::array numbers {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; stdex::mdspan&lt;int, stdex::extents&lt;int, 2, 5&gt;, stdex::layout_left&gt; mdspanOfNumbers {numbers.data()}; for (size_t columnIndex=0; columnIndex &lt; mdspanOfNumbers.extent(0); ++columnIndex) { for (size_t rowIndex=0; rowIndex &lt; mdspanOfNumbers.extent(1); ++rowIndex) { std::cout &lt;&lt; mdspanOfNumbers[columnIndex, rowIndex] &lt;&lt; &#39; &#39;; } std::cout &lt;&lt; &#39;\\n&#39;; } /* 1 3 5 7 9 2 4 6 8 10 */ Note that in the above two examples, the outputs are the same, but we changed the layout and the order of columns and rows. You can also observe in the above example that while previously we passed the extents as part of the constructor call, we can also pass them as class template arguments. There is also layout_stride available which provides a generalization of the other two which lets you specify a different stride for each extent. As you might have guessed, the reason behind providing different layouts is language interoperability. In mdspan not only the layout is customizable, but also the accessors. Different hardware can have different behaviour and different libraries or language extensions can have different concepts of memory accesses. In order to support the different needs, one can customize the data accessors. You can find an elaborate example here. Now you might ask, why do we get a view (mdspan) before a multidimensional container?! There is ongoing work also for creating a standalone container called mdarray, but the span had the priority. The reason behind this is that we use span-like features more often than the full features containers. We more often pass around containers by reference just to access elements or call the .size() member function than actually performing memory allocations. This is even truer in the world of parallel programming, “where multiple processing units access different elements of the same array in parallel […] memory allocation and deallocation are “synchronization points” for parallel processing units. Conclusion In this post, we discovered another new feature of C++23, multidimensional array views, a.k.a. mdspan. We saw the motivations behind creating this new view and why it’s even more important than an owning container. We saw some of the main characteristics of mdspan, how we can create and use it. We also saw, how customizable it is to provide compatibility with different languages and hardware. We also saw what an immense work it has been to create this new standardized view. You might look for more features that you might have heard about (such as submdspan), but despite all these papers and revisions, not all the parts made it to C++23. Thanks for the work of the authors and thanks to you for reading this article! Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter and let’s connect on Twitter!","headline":"C++23: mdspan","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sandordargo.com/blog/2023/08/15/cpp23-mdspan-mdsarray"},"url":"https://www.sandordargo.com/blog/2023/08/15/cpp23-mdspan-mdsarray"}</script><title>C++23: mdspan | Sandor Dargo's Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-89625019-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-89625019-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/SANDOR_DARGO_ROUND.JPG" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sandor Dargo's Blog</a></div><div class="site-subtitle font-italic">On C++, software development and books</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/books/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BOOKS</span> </a><li class="nav-item"> <a href="/speaking/" class="nav-link"> <i class="fa-fw fas fa-microphone ml-xl-3 mr-xl-3 unloaded"></i> <span>SPEAKING</span> </a><li class="nav-item"> <a href="/dailycpp/" class="nav-link"> <i class="fa-fw fas fa-link ml-xl-3 mr-xl-3 unloaded"></i> <span>DAILY C++</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>HI...</span> </a></ul><ul class="w-100"><li class="nav-item"> <a href="https://www.patreon.com/sandordargo" class="nav-link"> <img src="https://c5.patreon.com/external/logo/become_a_patron_button.png"></a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/sandordargo" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/SandorDargo" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sandor.dargo','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog"> Blog </a> </span> <span> <a href="/2023"> 2023 </a> </span> <span> <a href="/08"> 08 </a> </span> <span> <a href="/15"> 15 </a> </span> <span>C++23: mdspan</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>C++23: mdspan</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Sandor Dargo </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Aug 15, 2023, 12:00 AM +0200" prep="on" > Aug 15, 2023 <i class="unloaded">2023-08-15T00:00:00+02:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1143 words">6 min</span></div></div><div class="post-content"><p>Recently, we discussed that C++23 introduces the <a href="https://www.sandordargo.com/blog/2023/08/09/cpp23-multidimensional-subscription-operator">multidimensional subscript operator</a> which will work - for the time being - only with new containers. In C++23 that basically means <code class="language-plaintext highlighter-rouge">mdspan</code>. In C++26, a similar type <code class="language-plaintext highlighter-rouge">mdarray</code> will follow, but it’s also possible that existing types will start supporting the multidimensional subscript operator.</p><p>In this post, let’s review what this new type - <code class="language-plaintext highlighter-rouge">mdspan</code> - is about.</p><h2 id="an-immense-work-to-introduce-a-new-container">An immense work to introduce a new container</h2><p>First of all, let’s remind ourselves what a big work certain people put in into the standardization, or in other words, how much certain people work on making C++ better and safer. They deserve our gratitude.</p><p>If you look at this page (and at the below screenshot), you’ll see 5 different papers listed next to mdspan. Those 5 papers don’t even include the one for the <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2128r6.pdf">multidimensional subscript operator</a>!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/mdspan-papers.png" alt="The 5 papers of mdspan in C++23" title="The 5 papers of mdspan in C++23" /> <em>The 5 papers of mdspan in C++23</em></p><p>Why are there five different papers and what are they about? The reason behind this is that we are human beings and we cannot make perfect designs on the first run. <a href="https://www.sandordargo.com/blog/2023/07/05/trip-report-cpp-on-sea-2023#my-favourite-ideas">To be fair, not even ChatGPT can</a>.</p><p>If you check <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p0009r18.html">the first paper</a>, you’ll see 18 (!) revisions spanning over 7 years (pun intended)! That’s a lot of time and work introducing a new header! The other 4 papers contain minor fixes about <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2599r2.pdf">changing some types</a>, <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2604r0.html">renaming certain members</a>, <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2613r1.html">adding a missing <code class="language-plaintext highlighter-rouge">empty()</code> member function</a> and <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2023/p2763r1.html">modifying constructor behaviour</a>.</p><p>Despite all the work, not every originally proposed feature made it to C++23, for example, <code class="language-plaintext highlighter-rouge">submdspan</code> (a view of a subset of an existing <code class="language-plaintext highlighter-rouge">mdspan</code>) should follow in the next standard.</p><p>At the time of writing, only Clang 17 supports it which I don’t have access to and Compiler Explorer doesn’t support it yet either. But we might play with <a href="https://github.com/kokkos/mdspan">kokkos/mdspan reference implementation</a> even on <a href="https://godbolt.org/z/Mxa7cej1a">Compiler Explorer</a>.</p><h2 id="main-characteristics">Main characteristics</h2><p>First of all, <code class="language-plaintext highlighter-rouge">mdspan</code> is similar to span in the sense that it’s a non-owning array view. A multidimensional array can map a tuple of indexes to one single element of the underlying container. Each indice can go from zero to the indice’s extent - 1 where the product of extents is the size of the underlying array.</p><p><em>Please note that the <code class="language-plaintext highlighter-rouge">stdex</code> namespace is to refers to the reference implementation coming from <a href="https://github.com/kokkos/mdspan">kokkos/mdspan</a></em></p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="n">std</span><span class="o">::</span><span class="n">array</span> <span class="n">numbers</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">};</span>
<span class="n">stdex</span><span class="o">::</span><span class="n">mdspan</span> <span class="n">mdspanOfNumbers</span> <span class="p">{</span><span class="n">numbers</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">stdex</span><span class="o">::</span><span class="n">extents</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">}};</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">rowIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">rowIndex</span> <span class="o">&lt;</span> <span class="n">mdspanOfNumbers</span><span class="p">.</span><span class="n">extent</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="o">++</span><span class="n">rowIndex</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">columnIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">columnIndex</span> <span class="o">&lt;</span> <span class="n">mdspanOfNumbers</span><span class="p">.</span><span class="n">extent</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="o">++</span><span class="n">columnIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mdspanOfNumbers</span><span class="p">[</span><span class="n">rowIndex</span><span class="p">,</span> <span class="n">columnIndex</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">' '</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*
1 2 3 4 5 
6 7 8 9 10 
*/</span>
</pre></table></code></div></div><p>Multidimensional arrays have long been useful for representing large amounts of data, describing points in physical space, or expressing approximations of functions. They are a natural way to represent mathematical objects like matrices and tensors.</p><p>C++, so far, has not provided good enough support for multidimensional arrays. Although there are different options available for the developers (<a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p0009r18.html#why-are-existing-c-data-structures-not-enough">detailed here</a>), they either lack some runtime-aspects, or they don’t provide the desired attributes in terms of type homogeneity or memory allocations.</p><p>In terms of memory layout, <code class="language-plaintext highlighter-rouge">mdspan</code> is really flexible coming with three different layouts. In <code class="language-plaintext highlighter-rouge">layout_right</code>, the rightmost index gives access to the row, so it starts with the column on the left - that’s how we used to do things in C and C++. <code class="language-plaintext highlighter-rouge">layout_left</code> provides the opposite behaviour where the leftmost index is the row and the rightmost is the column - this emulates Fortran’s and Matlab’s behaviour.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="n">std</span><span class="o">::</span><span class="n">array</span> <span class="n">numbers</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">};</span>
<span class="n">stdex</span><span class="o">::</span><span class="n">mdspan</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">stdex</span><span class="o">::</span><span class="n">extents</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">stdex</span><span class="o">::</span><span class="n">layout_right</span><span class="o">&gt;</span> <span class="n">mdspanOfNumbers</span> <span class="p">{</span><span class="n">numbers</span><span class="p">.</span><span class="n">data</span><span class="p">()};</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">rowIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">rowIndex</span> <span class="o">&lt;</span> <span class="n">mdspanOfNumbers</span><span class="p">.</span><span class="n">extent</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="o">++</span><span class="n">rowIndex</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">columnIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">columnIndex</span> <span class="o">&lt;</span> <span class="n">mdspanOfNumbers</span><span class="p">.</span><span class="n">extent</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="o">++</span><span class="n">columnIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mdspanOfNumbers</span><span class="p">[</span><span class="n">rowIndex</span><span class="p">,</span> <span class="n">columnIndex</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">' '</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*
1 2 3 4 5 
6 7 8 9 10 
*/</span>

<span class="n">std</span><span class="o">::</span><span class="n">array</span> <span class="n">numbers</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">};</span>
<span class="n">stdex</span><span class="o">::</span><span class="n">mdspan</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">stdex</span><span class="o">::</span><span class="n">extents</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">stdex</span><span class="o">::</span><span class="n">layout_left</span><span class="o">&gt;</span> <span class="n">mdspanOfNumbers</span> <span class="p">{</span><span class="n">numbers</span><span class="p">.</span><span class="n">data</span><span class="p">()};</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">columnIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">columnIndex</span> <span class="o">&lt;</span> <span class="n">mdspanOfNumbers</span><span class="p">.</span><span class="n">extent</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="o">++</span><span class="n">columnIndex</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">rowIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">rowIndex</span> <span class="o">&lt;</span> <span class="n">mdspanOfNumbers</span><span class="p">.</span><span class="n">extent</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="o">++</span><span class="n">rowIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mdspanOfNumbers</span><span class="p">[</span><span class="n">columnIndex</span><span class="p">,</span> <span class="n">rowIndex</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">' '</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*
1 3 5 7 9 
2 4 6 8 10 
*/</span>
</pre></table></code></div></div><p>Note that in the above two examples, the outputs are the same, but we changed the layout and the order of columns and rows. You can also observe in the above example that while previously we passed the extents as part of the constructor call, we can also pass them as class template arguments.</p><p>There is also <code class="language-plaintext highlighter-rouge">layout_stride</code> available which provides a generalization of the other two which lets you specify a different stride for each extent.</p><p>As you might have guessed, the reason behind providing different layouts is language interoperability.</p><p>In <code class="language-plaintext highlighter-rouge">mdspan</code> not only the layout is customizable, but also the accessors. Different hardware can have different behaviour and different libraries or language extensions can have different concepts of memory accesses. In order to support the different needs, one can customize the data accessors. <a href="https://github.com/kokkos/mdspan/blob/stable/examples/restrict_accessor/restrict_accessor.cpp">You can find an elaborate example here</a>.</p><p>Now you might ask, why do we get a view (<code class="language-plaintext highlighter-rouge">mdspan</code>) before a multidimensional container?!</p><p>There is ongoing work also for creating a standalone container called <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/wg21.link/p1684"><code class="language-plaintext highlighter-rouge">mdarray</code></a>, but the span had the priority. The reason behind this is that we use span-like features more often than the full features containers. We more often pass around containers by reference just to access elements or call the <code class="language-plaintext highlighter-rouge">.size()</code> member function than actually performing memory allocations. This is even truer in the world of parallel programming, <em>“where multiple processing units access different elements of the same array in parallel […] memory allocation and deallocation are “synchronization points” for parallel processing units.</em></p><h2 id="conclusion">Conclusion</h2><p>In this post, we discovered another new feature of C++23, multidimensional array views, a.k.a. <code class="language-plaintext highlighter-rouge">mdspan</code>. We saw the motivations behind creating this new view and why it’s even more important than an owning container. We saw some of the main characteristics of <code class="language-plaintext highlighter-rouge">mdspan</code>, how we can create and use it. We also saw, how customizable it is to provide compatibility with different languages and hardware.</p><p>We also saw what an immense work it has been to create this new standardized view. You might look for more features that you might have heard about (such as <code class="language-plaintext highlighter-rouge">submdspan</code>), but despite all these papers and revisions, not all the parts made it to C++23.</p><p>Thanks for the work of the authors and thanks to you for reading this article!</p><h2 id="connect-deeper">Connect deeper</h2><p>If you liked this article, please</p><ul><li>hit on the like button,<li><a href="http://eepurl.com/gvcv1j">subscribe to my newsletter</a><li>and let’s connect on <a href="https://twitter.com/SandorDargo">Twitter</a>!</ul><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dev/'>dev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cpp/" class="post-tag no-text-decoration" >cpp</a> <a href="/tags/cpp23/" class="post-tag no-text-decoration" >cpp23</a> <a href="/tags/static/" class="post-tag no-text-decoration" >static</a> <a href="/tags/calloperator/" class="post-tag no-text-decoration" >calloperator</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a><div class="share-wrapper"> <a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=C++23: mdspan - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2023/08/15/cpp23-mdspan-mdsarray" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=C++23: mdspan - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2023/08/15/cpp23-mdspan-mdsarray" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=C++23: mdspan - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2023/08/15/cpp23-mdspan-mdsarray" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=C++23: mdspan - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2023/08/15/cpp23-mdspan-mdsarray" data-toggle="tooltip" data-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews"> <i class="fa-fw fab fa-hacker-news"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/2025/10/22/trip-report-budapest-cpp">Trip report: Budapest C++ - Breaking & Building C++</a><li><a href="/blog/2025/10/01/cpp26-optional-of-reference">C++26: std::optional&lt;T&amp;&gt;</a><li><a href="/blog/2025/09/24/trip-report-cppcon-2025">Trip report: CppCon 2025</a><li><a href="/blog/2025/07/23/format-your-own-type-part-1">Format your own type (Part 1)</a><li><a href="/blog/2025/07/02/cpponsea-trip-report">Trip report: C++ On Sea 2025</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self-improvement</a> <a class="post-tag" href="/tags/management/">management</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/2023/07/26/cpp23-static-call-and-subscript-operator"><div class="card-body"> <span class="timeago small" > Jul 26, 2023 <i class="unloaded">2023-07-26T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>C++23: static operator() and static operator[]</h3><div class="text-muted small"><p> In this article, we are going to review two new features of C++23. Now the language allows the call operator (operator()) and the subscription operator (operator[]) to be static. Let’s jump into th...</p></div></div></a></div><div class="card"> <a href="/blog/2023/08/09/cpp23-multidimensional-subscription-operator"><div class="card-body"> <span class="timeago small" > Aug 9, 2023 <i class="unloaded">2023-08-09T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>C++23: multidimensional operator[]</h3><div class="text-muted small"><p> Two weeks ago we talked about how C++23 allows for the call and subscription operators to be static. This time, we stay in the land of operators and we’ll continue discussing the subscript operator...</p></div></div></a></div><div class="card"> <a href="/blog/2022/11/23/cpp23-changes-to-lambdas"><div class="card-body"> <span class="timeago small" > Nov 23, 2022 <i class="unloaded">2022-11-23T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>C++23: How lambdas are going to change?</h3><div class="text-muted small"><p> C++23 is coming soon and it will change how lambdas work in 3 different ways. They will not only become simpler in certain circumstances but they will be also aligned more with other features of th...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/2023/08/09/cpp23-multidimensional-subscription-operator" class="btn btn-outline-primary" prompt="Older"><p>C++23: multidimensional operator[]</p></a> <a href="/blog/2023/08/23/cpp23-c-compatibility" class="btn btn-outline-primary" prompt="Newer"><p>C++23: compatibility with C</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//sandordargo-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'C++23: mdspan'; this.page.url = 'https://www.sandordargo.com/blog/2023/08/15/cpp23-mdspan-mdsarray'; this.page.identifier = '/blog/2023/08/15/cpp23-mdspan-mdsarray'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><div id="amzn-assoc-ad-be5a767b-3346-40aa-bc00-2eff0ce33d2b"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=be5a767b-3346-40aa-bc00-2eff0ce33d2b"></script> <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us16.list-manage.com","uuid":"b073dbd5c29322302f59a8cd8","lid":"d26240427e"}) })</script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/SandorDargo">Sandor Dargo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self improvement</a> <a class="post-tag" href="/tags/management/">management</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.sandordargo.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
