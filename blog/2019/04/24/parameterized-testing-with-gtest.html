<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Parameterized testing with GTest" /><meta property="og:locale" content="en_US" /><meta name="description" content="For one of the latest dojos in our department, we chose a relatively simple kata to help new people get on board. We were working on the leap year kata in Randori style meaning that we were using only one computer - there were 9 of us. We also applied some extra constraints, such as if after every three minutes our tests were not green (except for the red phase when we had to write a failing test), we had to wipe out our changes with git reset --hard." /><meta property="og:description" content="For one of the latest dojos in our department, we chose a relatively simple kata to help new people get on board. We were working on the leap year kata in Randori style meaning that we were using only one computer - there were 9 of us. We also applied some extra constraints, such as if after every three minutes our tests were not green (except for the red phase when we had to write a failing test), we had to wipe out our changes with git reset --hard." /><link rel="canonical" href="https://www.sandordargo.com/blog/2019/04/24/parameterized-testing-with-gtest" /><meta property="og:url" content="https://www.sandordargo.com/blog/2019/04/24/parameterized-testing-with-gtest" /><meta property="og:site_name" content="Sandor Dargo’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-04-24T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Parameterized testing with GTest" /><meta name="twitter:site" content="@SandorDargo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-11-21T23:03:19+01:00","datePublished":"2019-04-24T00:00:00+02:00","description":"For one of the latest dojos in our department, we chose a relatively simple kata to help new people get on board. We were working on the leap year kata in Randori style meaning that we were using only one computer - there were 9 of us. We also applied some extra constraints, such as if after every three minutes our tests were not green (except for the red phase when we had to write a failing test), we had to wipe out our changes with git reset --hard.","headline":"Parameterized testing with GTest","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sandordargo.com/blog/2019/04/24/parameterized-testing-with-gtest"},"url":"https://www.sandordargo.com/blog/2019/04/24/parameterized-testing-with-gtest"}</script><title>Parameterized testing with GTest | Sandor Dargo's Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-89625019-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-89625019-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/SANDOR_DARGO_ROUND.JPG" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sandor Dargo's Blog</a></div><div class="site-subtitle font-italic">On C++, software development and books</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/books/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BOOKS</span> </a><li class="nav-item"> <a href="/speaking/" class="nav-link"> <i class="fa-fw fas fa-microphone ml-xl-3 mr-xl-3 unloaded"></i> <span>SPEAKING</span> </a><li class="nav-item"> <a href="/dailycpp/" class="nav-link"> <i class="fa-fw fas fa-link ml-xl-3 mr-xl-3 unloaded"></i> <span>DAILY C++</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>HI...</span> </a></ul><ul class="w-100"><li class="nav-item"> <a href="https://www.patreon.com/sandordargo" class="nav-link"> <img src="https://c5.patreon.com/external/logo/become_a_patron_button.png"></a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/sandordargo" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/SandorDargo" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sandor.dargo','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog"> Blog </a> </span> <span> <a href="/2019"> 2019 </a> </span> <span> <a href="/04"> 04 </a> </span> <span> <a href="/24"> 24 </a> </span> <span>Parameterized testing with GTest</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Parameterized testing with GTest</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Sandor Dargo </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Apr 24, 2019, 12:00 AM +0200" prep="on" > Apr 24, 2019 <i class="unloaded">2019-04-24T00:00:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 21, 2022, 11:03 PM +0100" prefix="Updated " > Nov 21, 2022 <i class="unloaded">2022-11-21T23:03:19+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2222 words">12 min</span></div></div><div class="post-content"><p>For one of the latest dojos in our department, we chose a relatively simple kata to help new people get on board. We were working on the <a href="http://codingdojo.org/kata/LeapYears/">leap year kata</a> in Randori style meaning that we were using only one computer - there were 9 of us.</p><p>We also applied some extra constraints, such as if after every three minutes our tests were not green (except for the red phase when we had to write a failing test), we had to wipe out our changes with <code class="language-plaintext highlighter-rouge">git reset --hard</code>.</p><p>Even with - some non-mentioned - extra constraints this kata doesn’t take up one and half hours to implement, so we had extra time to try something new. As you could have already guessed based on the title, we were experimenting with <a href="https://github.com/sandordargo/parameterizedTestExamplesCpp">parameterized tests in GoogleTest</a>.</p><h2 id="how-to-make-our-tests-less-repetitive-without-parameterized-tests">How to make our tests less repetitive without parameterized tests?</h2><p>The first question to answer is what parameterized tests are, but before let’s see why we need them.</p><p><em>If you want to go directly to parameterized tests, <a href="#parameterizedtests">jump to the next section</a>.</em></p><p>Imagine that you have a couple of quite similar tests, like these:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;gtest/gtest.h&gt;</span><span class="cp">
</span>
<span class="cp">#include</span> <span class="cpf">&lt;LeapYearCalendar.h&gt;</span><span class="cp">
</span>
<span class="n">TEST</span><span class="p">(</span><span class="n">LeapYearTests</span><span class="p">,</span> <span class="mi">1</span><span class="n">IsOdd_IsNotLeapYear</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
  <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST</span><span class="p">(</span><span class="n">LeapYearTests</span><span class="p">,</span> <span class="mi">711</span><span class="n">IsOdd_IsNotLeapYear</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
  <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">711</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST</span><span class="p">(</span><span class="n">LeapYearTests</span><span class="p">,</span> <span class="mi">1989</span><span class="n">IsOdd_IsNotLeapYear</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
  <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1989</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST</span><span class="p">(</span><span class="n">LeapYearTests</span><span class="p">,</span> <span class="mi">2013</span><span class="n">IsOdd_IsNotLeapYear</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
  <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">2013</span><span class="p">));</span>
<span class="p">}</span>
</pre></table></code></div></div><p>As you can observe there are only two things changing:</p><ul><li>the inputs<li>and the expected results.</ul><p>Wouldn’t it be great to <a href="https://amzn.to/2EhV5s8">refactor a bit</a> and reduce the code repetition?</p><p>No doubt, it would be just awesome!</p><p>But how to do it?</p><p>You might start off in different directions.</p><h3 id="using-a-fixture">Using a fixture</h3><p>One possible way to make the code DRYer is to create a fixture and get rid of the initialization of <code class="language-plaintext highlighter-rouge">Foo</code>.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>
<span class="cp">#include</span> <span class="cpf">&lt;gtest/gtest.h&gt;</span><span class="cp">
</span>
<span class="cp">#include</span> <span class="cpf">&lt;LeapYearCalendar.h&gt;</span><span class="cp">
</span>
<span class="k">class</span> <span class="nc">LeapYearFixtureTests</span> <span class="o">:</span> <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Test</span> <span class="p">{</span>
<span class="nl">protected:</span>
    <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearFixtureTests</span><span class="p">,</span> <span class="mi">1</span><span class="n">IsOdd_IsNotLeapYear</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearFixtureTests</span><span class="p">,</span> <span class="mi">711</span><span class="n">IsOdd_IsNotLeapYear</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">711</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearFixtureTests</span><span class="p">,</span> <span class="mi">1989</span><span class="n">IsOdd_IsNotLeapYear</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1989</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearFixtureTests</span><span class="p">,</span> <span class="mi">2013</span><span class="n">IsOdd_IsNotLeapYear</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">2013</span><span class="p">));</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This is a step forward, we don’t need to instantiate <code class="language-plaintext highlighter-rouge">leapYearCalendar</code> anymore in each test, it’s performed by the fixture. We might decide to change no more, but still, the code seems quite repetitive.</p><h3 id="the-good-old-for-loop">The good old <code class="language-plaintext highlighter-rouge">for</code> loop</h3><p>Another option is to create a list of years within the test case and iterate over it.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;gtest/gtest.h&gt;</span><span class="cp">
</span>
<span class="cp">#include</span> <span class="cpf">&lt;LeapYearCalendar.h&gt;</span><span class="cp">
</span>
<span class="n">TEST</span><span class="p">(</span><span class="n">LeapYearIterationTest</span><span class="p">,</span> <span class="n">OddYearsAreNotLeapYears</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">oddYears</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">711</span><span class="p">,</span> <span class="mi">2013</span><span class="p">};</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">oddYear</span> <span class="o">:</span>  <span class="n">oddYears</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="n">oddYear</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><p>In terms of repetitiveness, in my opinion, this code is better, it’s denser, yet it is very readable. But it has a big flaw! A good unittest should have only one logical assertion - as always, some exceptions apply. On the other hand, in this case, we have multiple different assertions that should not be combined into one.</p><p>We might say this is a theoretical problem, but it has a practical issue too. Let’s say that for our 2nd iteration the test fails. What happens then? Our tests are stopped and all the other values will not be tested. We miss the feedback for the other 4 values.</p><p>You might say that we can overcome this problem by using the macro <code class="language-plaintext highlighter-rouge">EXPECT_FALSE</code>, but the error message you’ll get is not optiomal.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>[ RUN      ] LeapYearIterationTest.OddYearsAreNotLeapYears
/home/sdargo/personal/dev/LeapYear/tests/TestLeapyearIteration.cpp:8: Failure
Value of: leapYearCalendar.isLeap(oddYear)
  Actual: true
Expected: false
[  FAILED  ] LeapYearIterationTest.OddYearsAreNotLeapYears (0 ms)
</pre></table></code></div></div><p>We don’t even know which iteration failed!</p><h2 id="parameterized-tests-what-are-they-parameterizedtests">Parameterized tests, what are they? [parameterizedtests]</h2><p>Can we combine the advantages of a DRY for loop with the ones of independent tests without the drawbacks?</p><p>Not completely. But using parameterized tests from GoogleTest is definitely an option you should consider..</p><p>We have two different ways to use this feature. One way is to build our tests from scratch and the other is to build them on the foundations of a <a href="https://github.com/google/googletest/blob/master/googletest/samples/sample5_unittest.cc"><code class="language-plaintext highlighter-rouge">FIXTURE</code></a> like the one we already saw when we introduced a common <code class="language-plaintext highlighter-rouge">leapYear</code> variable. Let’s see the two options one by one.</p><h3 id="write-parameterized-tests-without-a-fixture">Write parameterized tests without a fixture</h3><p>In this case, we have no existing fixture and we don’t need one.</p><p>Let’s continue testing the <a href="http://codingdojo.org/kata/LeapYears/">leap year kata</a>.</p><p>First, we need to create our parameterized test class. Let’s call it <code class="language-plaintext highlighter-rouge">LeapYearParametrizedTests</code> and it has inherit to from <code class="language-plaintext highlighter-rouge">::testing::TestWithParam&lt;T&gt;</code>. <code class="language-plaintext highlighter-rouge">T</code> is a template parameter and it is going to be the type of the parameter or parameters we want to pass into each iteration. Let’s start with a simple example, where the parameters will be of the type integer.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">LeapYearParameterizedTestFixture</span> <span class="o">:</span><span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">TestWithParam</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="p">{</span>
<span class="nl">protected:</span>
    <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
<span class="p">};</span>
</pre></table></code></div></div><p>Next, we need a test case with an assertion in it.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">TEST_P</span><span class="p">(</span><span class="n">LeapYearParameterizedTestFixture</span><span class="p">,</span> <span class="n">OddYearsAreNotLeapYears</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">year</span> <span class="o">=</span> <span class="n">GetParam</span><span class="p">();</span>
    <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="n">year</span><span class="p">));</span>
<span class="p">}</span>
</pre></table></code></div></div><p>While for a normal unittest we use the <code class="language-plaintext highlighter-rouge">TEST()</code> macro and <code class="language-plaintext highlighter-rouge">TEST_F()</code> for a fixture, we have to use <code class="language-plaintext highlighter-rouge">TEST_P()</code> for parameterized tests. As the first parameter, we have to pass the name of the test class and as the second we just have to pick a good name for what our tests represent.</p><p>In order to retrieve the parameter from the list of values (that we are going to define in a few seconds), we have to use <code class="language-plaintext highlighter-rouge">GetParam()</code>.</p><p>So far, so good! Now we don’t need anything else, but to call our use-case with - preferably - multiple inputs.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">INSTANTIATE_TEST_CASE_P</span><span class="p">(</span>
        <span class="n">LeapYearTests</span><span class="p">,</span>
        <span class="n">LeapYearParameterizedTestFixture</span><span class="p">,</span>
        <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Values</span><span class="p">(</span>
                <span class="mi">1</span><span class="p">,</span> <span class="mi">711</span><span class="p">,</span> <span class="mi">1989</span><span class="p">,</span> <span class="mi">2013</span>
        <span class="p">));</span>
</pre></table></code></div></div><p>Here we call the <code class="language-plaintext highlighter-rouge">INSTANTIATE_TEST_CASE_P</code> macro with first with a unique name for the instantiation of the test suite. This name can distinguish between multiple instantiations. In test output, the instantiation name - in this case, <code class="language-plaintext highlighter-rouge">LeapYearTests</code> - is added as a prefix to the test suite name <code class="language-plaintext highlighter-rouge">LeapYearParameterizedTestFixture</code>.</p><p>Last but not least, we have to list the different inputs we want to test with.</p><p><em>Since, release 1.10 <code class="language-plaintext highlighter-rouge">INSTANTIATE_TEST_CASE_P</code> is replaced with <code class="language-plaintext highlighter-rouge">INSTANTIATE_TEST_SUITE_P</code>!</em></p><p>Et voila, it’s as easy as that! Here is the full example. I included a leap year implementation so you can run it easily if you have GTest available. You can also refer to <a href="https://github.com/sandordargo/parameterizedTestExamplesCpp">my GitHub repo</a> for the code and instructions for compiling and running it.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;gtest/gtest.h&gt;</span><span class="cp">
</span>
<span class="cp">#include</span> <span class="cpf">&lt;LeapYearCalendar.h&gt;</span><span class="cp">
</span>
<span class="k">class</span> <span class="nc">LeapYearParameterizedTestFixture</span> <span class="o">:</span><span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">TestWithParam</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="p">{</span>
<span class="nl">protected:</span>
    <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">TEST_P</span><span class="p">(</span><span class="n">LeapYearParameterizedTestFixture</span><span class="p">,</span> <span class="n">OddYearsAreNotLeapYears</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">year</span> <span class="o">=</span> <span class="n">GetParam</span><span class="p">();</span>
    <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="n">year</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">INSTANTIATE_TEST_CASE_P</span><span class="p">(</span>
        <span class="n">LeapYearTests</span><span class="p">,</span>
        <span class="n">LeapYearParameterizedTestFixture</span><span class="p">,</span>
        <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Values</span><span class="p">(</span>
                <span class="mi">1</span><span class="p">,</span> <span class="mi">711</span><span class="p">,</span> <span class="mi">1989</span><span class="p">,</span> <span class="mi">2013</span>
        <span class="p">));</span>

</pre></table></code></div></div><p>Let’s have a look at the output:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>[----------] 4 tests from LeapYearTests/LeapYearParameterizedTestFixture
[ RUN      ] LeapYearTests/LeapYearParameterizedTestFixture.OddYearsAreNotLeapYears/0
[       OK ] LeapYearTests/LeapYearParameterizedTestFixture.OddYearsAreNotLeapYears/0 (0 ms)
[ RUN      ] LeapYearTests/LeapYearParameterizedTestFixture.OddYearsAreNotLeapYears/1
[       OK ] LeapYearTests/LeapYearParameterizedTestFixture.OddYearsAreNotLeapYears/1 (0 ms)
[ RUN      ] LeapYearTests/LeapYearParameterizedTestFixture.OddYearsAreNotLeapYears/2
[       OK ] LeapYearTests/LeapYearParameterizedTestFixture.OddYearsAreNotLeapYears/2 (0 ms)
[ RUN      ] LeapYearTests/LeapYearParameterizedTestFixture.OddYearsAreNotLeapYears/3
[       OK ] LeapYearTests/LeapYearParameterizedTestFixture.OddYearsAreNotLeapYears/3 (0 ms)
[----------] 4 tests from LeapYearTests/LeapYearParameterizedTestFixture (0 ms total)
</pre></table></code></div></div><p>We can observe that each test name is composed of 3 parts:</p><ul><li>the suite name<li>the test name<li>number of each iteration starting from 0</ul><p>If you want multiple test scenarios, you have to create a suite for each scenario as with <code class="language-plaintext highlighter-rouge">INSTANTIATE_TEST_CASE_P</code> each test in a suite will be triggered. We can safely assume that different tests would produce different results with the same inputs.</p><h3 id="write-parameterized-tests-based-on-an-existing-fixture">Write parameterized tests based on an existing fixture</h3><p>It might happen that you have already a test fixture available, like this one:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">LeapYearTestFixtureToBeParameterized</span> <span class="o">:</span> <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Test</span>
<span class="p">{</span>
<span class="nl">protected:</span>
  <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
<span class="p">};</span>
</pre></table></code></div></div><p>In this case, it is very simple, the fixture itself just helps to avoid declaring a leap year object in each different test case. It wouldn’t be a big deal to lose it, but you might have a more complex setup.</p><p>As a reminder, here are the fixture tests that are really compact:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearTestFixtureToBeParameterized</span><span class="p">,</span> <span class="mi">1996</span><span class="n">_IsDivisibleBy4_ShouldBeALeapYear</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">ASSERT_TRUE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1996</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearTestFixtureToBeParameterized</span><span class="p">,</span> <span class="mi">1700</span><span class="n">_IsDivisibleBy100AndNotBy400_ShouldNotBeALeapYear</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1700</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearTestFixtureToBeParameterized</span><span class="p">,</span> <span class="mi">1600</span><span class="n">_IsDivisibleBy400_ShouldBeALeapYear</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">ASSERT_TRUE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1600</span><span class="p">));</span>
<span class="p">}</span>
</pre></table></code></div></div><p>So first we decided to have a fixture and we could name our test cases well enough to document why something is a leap year and some others are not leap years.</p><p>Then we thought that there are some use-cases which we’d like to test with many different values. Hm… What should we do?</p><p>We could create our parameterized tests here or in another file, it doesn’t matter. But we wouldn’t be able to access <code class="language-plaintext highlighter-rouge">leapYearCalendar</code>.</p><p>Put aside ugly global variables, what else can we do?</p><p>We can inherit from <code class="language-plaintext highlighter-rouge">::testing::WithParamInterface&lt;T&gt;</code> instead of <code class="language-plaintext highlighter-rouge">::testing::TestWithParam&lt;T&gt;</code>!</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">LeapYearTestFixtureToBeParameterized</span> <span class="o">:</span> <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Test</span>
<span class="p">{</span>
<span class="nl">protected:</span>
  <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">LeapYearParametrizedTestFixtureBasedOnFixture</span> <span class="o">:</span>
  <span class="k">public</span> <span class="n">LeapYearTestFixtureToBeParameterized</span><span class="p">,</span>
  <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">WithParamInterface</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="p">{</span>
<span class="p">};</span>

</pre></table></code></div></div><p>Of course, if you don’t need the separate fixture, you can combine the two classes into one:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">LeapYearParametrizedFixture</span> <span class="o">:</span>
        <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Test</span><span class="p">,</span>
        <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">WithParamInterface</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="p">{</span>
<span class="nl">protected:</span>
    <span class="n">LeapYear</span> <span class="n">leapYearCalendar</span><span class="p">;</span>            
<span class="p">};</span>
</pre></table></code></div></div><p>You might say that having a parameterized fixture does not make much sense. After all, we said that each test requires a different suite, so there is nothing to share, there will be no different tests.</p><p>Hence, inheriting from a fixture might make more sense. In the fixture, we removed some code duplication and in the parameterized suite we can benefit from the fixture’s code.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">LeapYearTestFixtureToBeParameterized</span> <span class="o">:</span> <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Test</span>
<span class="p">{</span>
<span class="nl">protected:</span>
    <span class="n">LeapYear</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearTestFixtureToBeParameterized</span><span class="p">,</span> <span class="mi">1996</span><span class="n">_IsDivisibleBy4_ShouldBeALeapYear</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ASSERT_TRUE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1996</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearTestFixtureToBeParameterized</span><span class="p">,</span> <span class="mi">1700</span><span class="n">_IsDivisibleBy100AndNotBy400_ShouldNotBeALeapYear</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1700</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">TEST_F</span><span class="p">(</span><span class="n">LeapYearTestFixtureToBeParameterized</span><span class="p">,</span> <span class="mi">1600</span><span class="n">_IsDivisibleBy400_ShouldBeALeapYear</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ASSERT_TRUE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="mi">1600</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">LeapYearParameterizedTestFixture</span> <span class="o">:</span>
        <span class="k">public</span> <span class="n">LeapYearTestFixtureToBeParameterized</span><span class="p">,</span>
        <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">WithParamInterface</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="p">{</span>         
<span class="p">};</span>

<span class="n">TEST_P</span><span class="p">(</span><span class="n">LeapYearParameterizedTestFixture</span><span class="p">,</span> <span class="n">OddYearsAreNotLeapYears</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">year</span> <span class="o">=</span> <span class="n">GetParam</span><span class="p">();</span>
    <span class="n">ASSERT_FALSE</span><span class="p">(</span><span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="n">year</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">INSTANTIATE_TEST_CASE_P</span><span class="p">(</span>
        <span class="n">LeapYearTests</span><span class="p">,</span>
        <span class="n">LeapYearParameterizedTestFixture</span><span class="p">,</span>
        <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Values</span><span class="p">(</span>
                <span class="mi">1</span><span class="p">,</span> <span class="mi">711</span><span class="p">,</span> <span class="mi">1989</span><span class="p">,</span> <span class="mi">2013</span>
        <span class="p">));</span>
</pre></table></code></div></div><p>If you are wondering why we use <code class="language-plaintext highlighter-rouge">WithParamInterface&lt;T&gt;</code> instead of <code class="language-plaintext highlighter-rouge">TestWithParam&lt;T&gt;</code>, here is the answer. <code class="language-plaintext highlighter-rouge">TestWithParam&lt;T&gt;</code> inherits both from <code class="language-plaintext highlighter-rouge">Test</code> and <code class="language-plaintext highlighter-rouge">WithParamInterface&lt;T&gt;</code>. The fixture that we inherited from in the previous example already inherited from <code class="language-plaintext highlighter-rouge">Test</code>. So we inherited from <code class="language-plaintext highlighter-rouge">Test</code> trough both parents and it became an ambiguous base.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/test-class-hierarchy.jpg" alt="Test Class Hierarchy" /></p><h3 id="how-to-pass-multiple-parameters-to-the-same-test-case">How to pass multiple parameters to the same test case?</h3><p>Let’s say you have two inputs that you want to parameterize, or you want to pass both the input and the output! What can you do?</p><p>You cannot pass more than one template argument to <code class="language-plaintext highlighter-rouge">TestWithParam&lt;T&gt;</code>, but you can always pass a <code class="language-plaintext highlighter-rouge">std::pair</code>, or even better a <code class="language-plaintext highlighter-rouge">std::tuple</code> with as many members as you want.</p><p>Here is an example:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">LeapYearMultipleParametersTests</span> <span class="o">:</span><span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">TestWithParam</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">tuple</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">bool</span><span class="o">&gt;&gt;</span> <span class="p">{</span>
<span class="nl">protected:</span>
    <span class="n">LeapYearCalendar</span> <span class="n">leapYearCalendar</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">TEST_P</span><span class="p">(</span><span class="n">LeapYearMultipleParametersTests</span><span class="p">,</span> <span class="n">ChecksIfLeapYear</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">bool</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">get</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="n">GetParam</span><span class="p">());</span>
    <span class="kt">int</span> <span class="n">year</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">get</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">(</span><span class="n">GetParam</span><span class="p">());</span>
    <span class="n">ASSERT_EQ</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">leapYearCalendar</span><span class="p">.</span><span class="n">isLeap</span><span class="p">(</span><span class="n">year</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">INSTANTIATE_TEST_CASE_P</span><span class="p">(</span>
        <span class="n">LeapYearTests</span><span class="p">,</span>
        <span class="n">LeapYearMultipleParametersTests</span><span class="p">,</span>
        <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Values</span><span class="p">(</span>
                <span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="nb">false</span><span class="p">),</span>
                <span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="nb">false</span><span class="p">),</span>
                <span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="mi">1996</span><span class="p">,</span> <span class="nb">true</span><span class="p">),</span>
                <span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="mi">1700</span><span class="p">,</span> <span class="nb">false</span><span class="p">),</span>
                <span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span> <span class="nb">true</span><span class="p">)));</span>
</pre></table></code></div></div><p>In this case, <code class="language-plaintext highlighter-rouge">GetParam()</code> retrieves tuples. In order to obtain an element of a tuple we can use <a href="https://en.cppreference.com/w/cpp/utility/tuple/get"><code class="language-plaintext highlighter-rouge">std::get&lt;T&gt;</code></a>. Or we could even use structured bidings starting from C++17:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">auto</span> <span class="p">[</span><span class="n">year</span><span class="p">,</span> <span class="n">expected</span><span class="p">]</span> <span class="o">=</span> <span class="n">GetParam</span><span class="p">();</span>
</pre></table></code></div></div><p>Unit tests have multiple goals. On the one hand, they give you confidence when you change code. The higher your coverage, the more confident you are that your change will not introduce a bug.</p><p>On the other hand, unit tests also document your code, it gives the best possible documentation on how it should be used and how it behaves. Unlike written documentation, it cannot be stale, because it would not compile anymore.</p><p>The larger the tuples you pass in, the less your parameterized tests will document your code. With each new parameter, it gets more difficult to understand what you test at the moment and in case of a failure, it’s more difficult to understand what went wrong.</p><p>I don’t say that parameterized tests are evil. I just say that it has its own compromises.</p><h2 id="takeaway">Takeaway</h2><p>In this article, we discovered how to write parameterized tests with the GoogleTest. Of course, GoogleTest is not the only library you can use to implement such tests in a simple way, <a href="https://www.boost.org/doc/libs/1_64_0/libs/test/doc/html/boost_test/tests_organization/test_cases/param_test.html">boost::unit_test</a> and <a href="https://github.com/catchorg/Catch2/tree/master/docs">Catch2</a> also have this nice feature. In later articles, I might show them.</p><p>Parameterized tests are a great tool to remove code duplication from your test suites. They come in handy when you want to test essentially the same behaviour for many different outputs.</p><p>As we saw, we can also parameterize the outputs, but then the main disadvantage of parameterized tests comes into play. The test suite has one name and for each set of parameters, it’s going to be the very same name. If one fails, you don’t have a hint from the test name.</p><p>Sometimes this is acceptable, sometimes you want to look for another solution.</p><p>You can download and experiment with the above examples from <a href="https://github.com/sandordargo/parameterizedTestExamplesCpp">this GitHub repository</a>.</p><h2 id="connect-deeper">Connect deeper</h2><p>If you liked this article, please</p><ul><li>hit on the like button,<li><a href="http://eepurl.com/gvcv1j">subscribe to my newsletter</a><li>and let’s connect on <a href="https://twitter.com/SandorDargo">Twitter</a>!</ul><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dev/'>dev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/unit-testing/" class="post-tag no-text-decoration" >unit testing</a> <a href="/tags/cpp/" class="post-tag no-text-decoration" >cpp</a> <a href="/tags/gtest/" class="post-tag no-text-decoration" >gtest</a> <a href="/tags/parameterized-tests/" class="post-tag no-text-decoration" >parameterized tests</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a><div class="share-wrapper"> <a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Parameterized testing with GTest - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2019/04/24/parameterized-testing-with-gtest" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Parameterized testing with GTest - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2019/04/24/parameterized-testing-with-gtest" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Parameterized testing with GTest - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2019/04/24/parameterized-testing-with-gtest" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=Parameterized testing with GTest - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2019/04/24/parameterized-testing-with-gtest" data-toggle="tooltip" data-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews"> <i class="fa-fw fab fa-hacker-news"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/2026/01/21/clocks-part-8-cpp20-timezones">Time in C++: C++20 Brought Us Time Zones</a><li><a href="/blog/2019/04/10/lesson-of-a-booking-dont-trust-the-system">Lesson of a booking: Don't trust the system!</a><li><a href="/blog/2020/07/22/always-catch-exceptions-by-reference">Why should we always catch exceptions by reference?</a><li><a href="/blog/2020/11/28/emergent-design">Emergent Design: The Evolutionary Nature of Professional Software Development by Scott Bain</a><li><a href="/blog/2021/10/06/airy-code-reviews">Bring some fresh AIR and write effective code review comments</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self-improvement</a> <a class="post-tag" href="/tags/management/">management</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/2024/07/10/cpponsea2024-trip-report"><div class="card-body"> <span class="timeago small" > Jul 10, 2024 <i class="unloaded">2024-07-10T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Trip report: C++ On Sea 2024</h3><div class="text-muted small"><p> Last week, between the 3rd and 5th of July, I had the privilege to attend and present at C++ on Sea 2024 for the 5th time in a row! I’m grateful that the organizers accepted me not simply as a spe...</p></div></div></a></div><div class="card"> <a href="/blog/2024/07/24/5-reasons-not-to-talk-about-politics-at-work"><div class="card-body"> <span class="timeago small" > Jul 24, 2024 <i class="unloaded">2024-07-24T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>5 reasons why politics will ruin your career hopes</h3><div class="text-muted small"><p> I’m not apolitical, I do have my opinion and quite a strong one. Yet, I don’t let it interfere with my job. I don’t think that one should talk about his or her political agenda at work or that one ...</p></div></div></a></div><div class="card"> <a href="/blog/2024/08/14/learn-cpp-by-frances-buontempo"><div class="card-body"> <span class="timeago small" > Aug 14, 2024 <i class="unloaded">2024-08-14T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Learn C++ by Example by Frances Buontempo</h3><div class="text-muted small"><p> I know Fran from C++ On Sea where she hosted lightning talk nights for the last two years. She recently asked me if I would be interested in reading her book, Learn C++ by Example. It was on my rad...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/2019/04/17/the-compound-effect" class="btn btn-outline-primary" prompt="Older"><p>The Compound Effect by Darren Hardy</p></a> <a href="/blog/2019/05/01/be-severe-only-with-yourself" class="btn btn-outline-primary" prompt="Newer"><p>Be severe only with yourself</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//sandordargo-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Parameterized testing with GTest'; this.page.url = 'https://www.sandordargo.com/blog/2019/04/24/parameterized-testing-with-gtest'; this.page.identifier = '/blog/2019/04/24/parameterized-testing-with-gtest'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><div id="amzn-assoc-ad-be5a767b-3346-40aa-bc00-2eff0ce33d2b"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=be5a767b-3346-40aa-bc00-2eff0ce33d2b"></script> <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us16.list-manage.com","uuid":"b073dbd5c29322302f59a8cd8","lid":"d26240427e"}) })</script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://twitter.com/SandorDargo">Sandor Dargo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self improvement</a> <a class="post-tag" href="/tags/management/">management</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.sandordargo.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
