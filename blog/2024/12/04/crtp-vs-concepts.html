<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Replace CRTP with concepts?" /><meta property="og:locale" content="en_US" /><meta name="description" content="In my Meeting C++ 2024 trip report, among my favourite ideas I mentioned Klaus Iglberger’s talk where he mentioned the possibility of replacing the curiously returning template pattern with the help of class tagging and concepts. Class tagging might mean different things in different contexts, or at least might be implemented in different ways. The end goal is to mark, in other words, tag classes or functions to be used in certain contexts, with certain algorithms. As you’ll see, in our case it’ll also be a tool to prevent duck typing. We are going to see an example implementation of a static interface with CRTP with a couple of different derived classes, then we’ll see the implementation without CRTP. The CRTP solution With the static interface, we are creating a static family of types. There is no need for dynamic polymorphism to share the same interface. It’s still granted through a base class, which is a template taking the deriving class as a parameter. Let’s use animals making sounds for a sample implementation. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 // CRTP version #include &lt;iostream&gt; template&lt;typename Derived&gt; class Animal { public: void make_sound() const { const Derived&amp; underlying = static_cast&lt;const Derived&amp;&gt;(*this); underlying.make_sound(); } }; class Cow: public Animal&lt;Cow&gt; { public: void make_sound() const { std::cout &lt;&lt; &quot;moo\n&quot;; } }; class Sheep: public Animal&lt;Sheep&gt; { public: void make_sound() const { std::cout &lt;&lt; &quot;baa\n&quot;; } }; class Dog: public Animal&lt;Dog&gt; { public: void make_sound() const { std::cout &lt;&lt; &quot;wouf\n&quot;; } }; template&lt;typename Derived&gt; void print(Animal&lt;Derived&gt; const&amp; animal) { animal.make_sound(); } int main() { Cow cow; print(cow); Sheep sheep; print(sheep); Dog dog; print(dog); } The non-CRTP solution In this case, we don’t use the CRTP pattern (the base class template) to add functionality but to ensure having a common interface without the costs of dynamic polymorphism. We can achieve that with a concept. 1 2 3 template&lt;typename T&gt; concept Animal = requires(T animal) { animal.make_sound();}; The problem with the above concept is that now every class that has a make_sound() method will be accepted as an animal. Even if the author of the Animal concept or the author of those fake animal classes didn’t want that. That’s why we are also going to require the AnimalTag. 1 2 3 4 5 6 class AnimalTag {}; template&lt;typename T&gt; concept Animal = requires(T animal) { animal.make_sound();} &amp;&amp; std::derived_from&lt;T, AnimalTag&gt;; We can be pretty sure that nobody will accidentally inherit from the AnimalTag Now let’s see the non-CRTP version. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 // non CRTP version #include &lt;concepts&gt; #include &lt;iostream&gt; class AnimalTag {}; template&lt;typename T&gt; concept Animal = requires(T animal) { animal.make_sound();} &amp;&amp; std::derived_from&lt;T, AnimalTag&gt;; void print(Animal auto const&amp; animal) { animal.make_sound(); } class Sheep: public AnimalTag { public: void make_sound() const { std::cout &lt;&lt; &quot;baa\n&quot;; } }; class Cow: public AnimalTag { public: void make_sound() const { std::cout &lt;&lt; &quot;moo\n&quot;; } }; class Dog: public AnimalTag { public: void make_sound() const { std::cout &lt;&lt; &quot;wouf\n&quot;; } }; int main() { Cow cow; print(cow); Sheep sheep; print(sheep); Dog dog; print(dog); } In comparison In my opinion, the non-CRTP solution is more readable and less error-prone. With the CRTP you might accidentally pass in a wrong template argument. It’s true that there is a solution to that. You can make the base class constructor private and make Derived a friend of Base. But you need to think about this. Also, for those who are not familiar with the pattern, seeing the CRTP inheritance plus the static_cast to the derived class is not necessarily easy to understand. The non-CRTP solution is more readable if you are familiar with concepts. While CRTP is a not-so-well-known design pattern, concepts are part of the main language, so you’ll have to get familiar with them sooner rather than later. If you want to learn more about concepts, you can find a series on this blog and I also have a book on concepts At the same time, you need to compile using C++20, which might not be available to you at the moment. I expected the non-CRTP solution to result in a significantly smaller binary, but I was proven wrong. With these small examples, I didn’t find a consistent difference. Depending on the optimization level even one was a bit smaller or the other. I still want to try it in a bigger example and I’ll report back the results, but it might take some time. Conclusion In this article, we covered how we can replace CRTP when we use it to have static interfaces for a family of classes. We saw that with C++20’s concepts, we could replace CRTP and have less error-prone and more readable code. The only question is whether you can already use C++20. Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter" /><meta property="og:description" content="In my Meeting C++ 2024 trip report, among my favourite ideas I mentioned Klaus Iglberger’s talk where he mentioned the possibility of replacing the curiously returning template pattern with the help of class tagging and concepts. Class tagging might mean different things in different contexts, or at least might be implemented in different ways. The end goal is to mark, in other words, tag classes or functions to be used in certain contexts, with certain algorithms. As you’ll see, in our case it’ll also be a tool to prevent duck typing. We are going to see an example implementation of a static interface with CRTP with a couple of different derived classes, then we’ll see the implementation without CRTP. The CRTP solution With the static interface, we are creating a static family of types. There is no need for dynamic polymorphism to share the same interface. It’s still granted through a base class, which is a template taking the deriving class as a parameter. Let’s use animals making sounds for a sample implementation. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 // CRTP version #include &lt;iostream&gt; template&lt;typename Derived&gt; class Animal { public: void make_sound() const { const Derived&amp; underlying = static_cast&lt;const Derived&amp;&gt;(*this); underlying.make_sound(); } }; class Cow: public Animal&lt;Cow&gt; { public: void make_sound() const { std::cout &lt;&lt; &quot;moo\n&quot;; } }; class Sheep: public Animal&lt;Sheep&gt; { public: void make_sound() const { std::cout &lt;&lt; &quot;baa\n&quot;; } }; class Dog: public Animal&lt;Dog&gt; { public: void make_sound() const { std::cout &lt;&lt; &quot;wouf\n&quot;; } }; template&lt;typename Derived&gt; void print(Animal&lt;Derived&gt; const&amp; animal) { animal.make_sound(); } int main() { Cow cow; print(cow); Sheep sheep; print(sheep); Dog dog; print(dog); } The non-CRTP solution In this case, we don’t use the CRTP pattern (the base class template) to add functionality but to ensure having a common interface without the costs of dynamic polymorphism. We can achieve that with a concept. 1 2 3 template&lt;typename T&gt; concept Animal = requires(T animal) { animal.make_sound();}; The problem with the above concept is that now every class that has a make_sound() method will be accepted as an animal. Even if the author of the Animal concept or the author of those fake animal classes didn’t want that. That’s why we are also going to require the AnimalTag. 1 2 3 4 5 6 class AnimalTag {}; template&lt;typename T&gt; concept Animal = requires(T animal) { animal.make_sound();} &amp;&amp; std::derived_from&lt;T, AnimalTag&gt;; We can be pretty sure that nobody will accidentally inherit from the AnimalTag Now let’s see the non-CRTP version. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 // non CRTP version #include &lt;concepts&gt; #include &lt;iostream&gt; class AnimalTag {}; template&lt;typename T&gt; concept Animal = requires(T animal) { animal.make_sound();} &amp;&amp; std::derived_from&lt;T, AnimalTag&gt;; void print(Animal auto const&amp; animal) { animal.make_sound(); } class Sheep: public AnimalTag { public: void make_sound() const { std::cout &lt;&lt; &quot;baa\n&quot;; } }; class Cow: public AnimalTag { public: void make_sound() const { std::cout &lt;&lt; &quot;moo\n&quot;; } }; class Dog: public AnimalTag { public: void make_sound() const { std::cout &lt;&lt; &quot;wouf\n&quot;; } }; int main() { Cow cow; print(cow); Sheep sheep; print(sheep); Dog dog; print(dog); } In comparison In my opinion, the non-CRTP solution is more readable and less error-prone. With the CRTP you might accidentally pass in a wrong template argument. It’s true that there is a solution to that. You can make the base class constructor private and make Derived a friend of Base. But you need to think about this. Also, for those who are not familiar with the pattern, seeing the CRTP inheritance plus the static_cast to the derived class is not necessarily easy to understand. The non-CRTP solution is more readable if you are familiar with concepts. While CRTP is a not-so-well-known design pattern, concepts are part of the main language, so you’ll have to get familiar with them sooner rather than later. If you want to learn more about concepts, you can find a series on this blog and I also have a book on concepts At the same time, you need to compile using C++20, which might not be available to you at the moment. I expected the non-CRTP solution to result in a significantly smaller binary, but I was proven wrong. With these small examples, I didn’t find a consistent difference. Depending on the optimization level even one was a bit smaller or the other. I still want to try it in a bigger example and I’ll report back the results, but it might take some time. Conclusion In this article, we covered how we can replace CRTP when we use it to have static interfaces for a family of classes. We saw that with C++20’s concepts, we could replace CRTP and have less error-prone and more readable code. The only question is whether you can already use C++20. Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter" /><link rel="canonical" href="https://www.sandordargo.com/blog/2024/12/04/crtp-vs-concepts" /><meta property="og:url" content="https://www.sandordargo.com/blog/2024/12/04/crtp-vs-concepts" /><meta property="og:site_name" content="Sandor Dargo’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-12-04T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Replace CRTP with concepts?" /><meta name="twitter:site" content="@SandorDargo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-12-04T00:00:00+01:00","datePublished":"2024-12-04T00:00:00+01:00","description":"In my Meeting C++ 2024 trip report, among my favourite ideas I mentioned Klaus Iglberger’s talk where he mentioned the possibility of replacing the curiously returning template pattern with the help of class tagging and concepts. Class tagging might mean different things in different contexts, or at least might be implemented in different ways. The end goal is to mark, in other words, tag classes or functions to be used in certain contexts, with certain algorithms. As you’ll see, in our case it’ll also be a tool to prevent duck typing. We are going to see an example implementation of a static interface with CRTP with a couple of different derived classes, then we’ll see the implementation without CRTP. The CRTP solution With the static interface, we are creating a static family of types. There is no need for dynamic polymorphism to share the same interface. It’s still granted through a base class, which is a template taking the deriving class as a parameter. Let’s use animals making sounds for a sample implementation. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 // CRTP version #include &lt;iostream&gt; template&lt;typename Derived&gt; class Animal { public: void make_sound() const { const Derived&amp; underlying = static_cast&lt;const Derived&amp;&gt;(*this); underlying.make_sound(); } }; class Cow: public Animal&lt;Cow&gt; { public: void make_sound() const { std::cout &lt;&lt; &quot;moo\\n&quot;; } }; class Sheep: public Animal&lt;Sheep&gt; { public: void make_sound() const { std::cout &lt;&lt; &quot;baa\\n&quot;; } }; class Dog: public Animal&lt;Dog&gt; { public: void make_sound() const { std::cout &lt;&lt; &quot;wouf\\n&quot;; } }; template&lt;typename Derived&gt; void print(Animal&lt;Derived&gt; const&amp; animal) { animal.make_sound(); } int main() { Cow cow; print(cow); Sheep sheep; print(sheep); Dog dog; print(dog); } The non-CRTP solution In this case, we don’t use the CRTP pattern (the base class template) to add functionality but to ensure having a common interface without the costs of dynamic polymorphism. We can achieve that with a concept. 1 2 3 template&lt;typename T&gt; concept Animal = requires(T animal) { animal.make_sound();}; The problem with the above concept is that now every class that has a make_sound() method will be accepted as an animal. Even if the author of the Animal concept or the author of those fake animal classes didn’t want that. That’s why we are also going to require the AnimalTag. 1 2 3 4 5 6 class AnimalTag {}; template&lt;typename T&gt; concept Animal = requires(T animal) { animal.make_sound();} &amp;&amp; std::derived_from&lt;T, AnimalTag&gt;; We can be pretty sure that nobody will accidentally inherit from the AnimalTag Now let’s see the non-CRTP version. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 // non CRTP version #include &lt;concepts&gt; #include &lt;iostream&gt; class AnimalTag {}; template&lt;typename T&gt; concept Animal = requires(T animal) { animal.make_sound();} &amp;&amp; std::derived_from&lt;T, AnimalTag&gt;; void print(Animal auto const&amp; animal) { animal.make_sound(); } class Sheep: public AnimalTag { public: void make_sound() const { std::cout &lt;&lt; &quot;baa\\n&quot;; } }; class Cow: public AnimalTag { public: void make_sound() const { std::cout &lt;&lt; &quot;moo\\n&quot;; } }; class Dog: public AnimalTag { public: void make_sound() const { std::cout &lt;&lt; &quot;wouf\\n&quot;; } }; int main() { Cow cow; print(cow); Sheep sheep; print(sheep); Dog dog; print(dog); } In comparison In my opinion, the non-CRTP solution is more readable and less error-prone. With the CRTP you might accidentally pass in a wrong template argument. It’s true that there is a solution to that. You can make the base class constructor private and make Derived a friend of Base. But you need to think about this. Also, for those who are not familiar with the pattern, seeing the CRTP inheritance plus the static_cast to the derived class is not necessarily easy to understand. The non-CRTP solution is more readable if you are familiar with concepts. While CRTP is a not-so-well-known design pattern, concepts are part of the main language, so you’ll have to get familiar with them sooner rather than later. If you want to learn more about concepts, you can find a series on this blog and I also have a book on concepts At the same time, you need to compile using C++20, which might not be available to you at the moment. I expected the non-CRTP solution to result in a significantly smaller binary, but I was proven wrong. With these small examples, I didn’t find a consistent difference. Depending on the optimization level even one was a bit smaller or the other. I still want to try it in a bigger example and I’ll report back the results, but it might take some time. Conclusion In this article, we covered how we can replace CRTP when we use it to have static interfaces for a family of classes. We saw that with C++20’s concepts, we could replace CRTP and have less error-prone and more readable code. The only question is whether you can already use C++20. Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter","headline":"Replace CRTP with concepts?","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sandordargo.com/blog/2024/12/04/crtp-vs-concepts"},"url":"https://www.sandordargo.com/blog/2024/12/04/crtp-vs-concepts"}</script><title>Replace CRTP with concepts? | Sandor Dargo's Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-89625019-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-89625019-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/SANDOR_DARGO_ROUND.JPG" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sandor Dargo's Blog</a></div><div class="site-subtitle font-italic">On C++, software development and books</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/books/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BOOKS</span> </a><li class="nav-item"> <a href="/speaking/" class="nav-link"> <i class="fa-fw fas fa-microphone ml-xl-3 mr-xl-3 unloaded"></i> <span>SPEAKING</span> </a><li class="nav-item"> <a href="/dailycpp/" class="nav-link"> <i class="fa-fw fas fa-link ml-xl-3 mr-xl-3 unloaded"></i> <span>DAILY C++</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>HI...</span> </a></ul><ul class="w-100"><li class="nav-item"> <a href="https://www.patreon.com/sandordargo" class="nav-link"> <img src="https://c5.patreon.com/external/logo/become_a_patron_button.png"></a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/sandordargo" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/SandorDargo" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sandor.dargo','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog"> Blog </a> </span> <span> <a href="/2024"> 2024 </a> </span> <span> <a href="/12"> 12 </a> </span> <span> <a href="/04"> 04 </a> </span> <span>Replace CRTP with concepts?</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Replace CRTP with concepts?</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Sandor Dargo </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Dec 4, 2024, 12:00 AM +0100" prep="on" > Dec 4, 2024 <i class="unloaded">2024-12-04T00:00:00+01:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="873 words">4 min</span></div></div><div class="post-content"><p>In my Meeting C++ 2024 trip report, among my favourite ideas I mentioned <a href="https://meetingcpp.com/2024/Talks/items/Design_Patterns___The_Most_Common_Misconceptions__2_of_N_.html">Klaus Iglberger’s talk</a> where he mentioned the possibility of replacing the curiously returning template pattern with the help of class tagging and concepts.</p><blockquote><p>Class tagging might mean different things in different contexts, or at least might be implemented in different ways. The end goal is to mark, in other words, tag classes or <a href="https://www.fluentcpp.com/2018/04/27/tag-dispatching/">functions to be used in certain contexts, with certain algorithms</a>. As you’ll see, in our case it’ll also be a tool to prevent duck typing.</p></blockquote><p>We are going to see an example implementation of a static interface with CRTP with a couple of different derived classes, then we’ll see the implementation without CRTP.</p><h2 id="the-crtp-solution">The CRTP solution</h2><p>With the static interface, we are creating a static family of types. There is no need for dynamic polymorphism to share the same interface. It’s still granted through a base class, which is a template taking the deriving class as a parameter.</p><p>Let’s use animals making sounds for a sample implementation.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="c1">// CRTP version</span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Derived</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Animal</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">make_sound</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">const</span> <span class="n">Derived</span><span class="o">&amp;</span> <span class="n">underlying</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">Derived</span><span class="o">&amp;&gt;</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span>
        <span class="n">underlying</span><span class="p">.</span><span class="n">make_sound</span><span class="p">();</span>
     <span class="p">}</span>

<span class="p">};</span>

<span class="k">class</span> <span class="nc">Cow</span><span class="o">:</span> <span class="k">public</span> <span class="n">Animal</span><span class="o">&lt;</span><span class="n">Cow</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">make_sound</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"moo</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Sheep</span><span class="o">:</span> <span class="k">public</span> <span class="n">Animal</span><span class="o">&lt;</span><span class="n">Sheep</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">make_sound</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"baa</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Dog</span><span class="o">:</span> <span class="k">public</span> <span class="n">Animal</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">make_sound</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"wouf</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Derived</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="n">Animal</span><span class="o">&lt;</span><span class="n">Derived</span><span class="o">&gt;</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">animal</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">animal</span><span class="p">.</span><span class="n">make_sound</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Cow</span> <span class="n">cow</span><span class="p">;</span>
    <span class="n">print</span><span class="p">(</span><span class="n">cow</span><span class="p">);</span>
    <span class="n">Sheep</span> <span class="n">sheep</span><span class="p">;</span>
    <span class="n">print</span><span class="p">(</span><span class="n">sheep</span><span class="p">);</span>
    <span class="n">Dog</span> <span class="n">dog</span><span class="p">;</span>
    <span class="n">print</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="the-non-crtp-solution">The non-CRTP solution</h2><p>In this case, we don’t use the CRTP pattern (the base class template) to add functionality but to ensure having a common interface without the costs of dynamic polymorphism.</p><p>We can achieve that with a concept.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">Animal</span> <span class="o">=</span> 
    <span class="k">requires</span><span class="p">(</span><span class="n">T</span> <span class="n">animal</span><span class="p">)</span> <span class="p">{</span> <span class="n">animal</span><span class="p">.</span><span class="n">make_sound</span><span class="p">();};</span>
</pre></table></code></div></div><p>The problem with the above concept is that now every class that has a <code class="language-plaintext highlighter-rouge">make_sound()</code> method will be accepted as an animal. Even if the author of the <code class="language-plaintext highlighter-rouge">Animal</code> concept or the author of those <em>fake</em> animal classes didn’t want that. That’s why we are also going to require the <code class="language-plaintext highlighter-rouge">AnimalTag</code>.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">AnimalTag</span> <span class="p">{};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">Animal</span> <span class="o">=</span> 
    <span class="k">requires</span><span class="p">(</span><span class="n">T</span> <span class="n">animal</span><span class="p">)</span> <span class="p">{</span> <span class="n">animal</span><span class="p">.</span><span class="n">make_sound</span><span class="p">();}</span> <span class="o">&amp;&amp;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">derived_from</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">AnimalTag</span><span class="o">&gt;</span><span class="p">;</span>
</pre></table></code></div></div><p>We can be pretty sure that nobody will accidentally inherit from the <code class="language-plaintext highlighter-rouge">AnimalTag</code></p><p>Now let’s see the non-CRTP version.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="c1">// non CRTP version</span>

<span class="cp">#include</span> <span class="cpf">&lt;concepts&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="k">class</span> <span class="nc">AnimalTag</span> <span class="p">{};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">Animal</span> <span class="o">=</span> 
    <span class="k">requires</span><span class="p">(</span><span class="n">T</span> <span class="n">animal</span><span class="p">)</span> <span class="p">{</span> <span class="n">animal</span><span class="p">.</span><span class="n">make_sound</span><span class="p">();}</span> <span class="o">&amp;&amp;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">derived_from</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">AnimalTag</span><span class="o">&gt;</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="n">Animal</span> <span class="k">auto</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">animal</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">animal</span><span class="p">.</span><span class="n">make_sound</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Sheep</span><span class="o">:</span> <span class="k">public</span> <span class="n">AnimalTag</span> <span class="p">{</span>
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">make_sound</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"baa</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Cow</span><span class="o">:</span> <span class="k">public</span> <span class="n">AnimalTag</span> <span class="p">{</span>
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">make_sound</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"moo</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Dog</span><span class="o">:</span> <span class="k">public</span> <span class="n">AnimalTag</span> <span class="p">{</span>
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">make_sound</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"wouf</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Cow</span> <span class="n">cow</span><span class="p">;</span>
    <span class="n">print</span><span class="p">(</span><span class="n">cow</span><span class="p">);</span>
    <span class="n">Sheep</span> <span class="n">sheep</span><span class="p">;</span>
    <span class="n">print</span><span class="p">(</span><span class="n">sheep</span><span class="p">);</span>
    <span class="n">Dog</span> <span class="n">dog</span><span class="p">;</span>
    <span class="n">print</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="in-comparison">In comparison</h2><p>In my opinion, the non-CRTP solution is more readable and less error-prone. With the CRTP you might accidentally pass in a wrong template argument. It’s true that there is a solution to that. You can make the base class constructor private and make <code class="language-plaintext highlighter-rouge">Derived</code> a friend of <code class="language-plaintext highlighter-rouge">Base</code>. But you need to think about this.</p><p>Also, for those who are not familiar with the pattern, seeing the CRTP inheritance plus the <code class="language-plaintext highlighter-rouge">static_cast</code> to the derived class is not necessarily easy to understand.</p><p>The non-CRTP solution is more readable if you are familiar with concepts. While CRTP is a not-so-well-known design pattern, concepts are part of the main language, so you’ll have to get familiar with them sooner rather than later.</p><blockquote><p><em>If you want to learn more about concepts, you can find <a href="https://www.sandordargo.com/tags/concepts/">a series on this blog</a> and I also have <a href="https://leanpub.com/cppconcepts">a book on concepts</a></em></p></blockquote><p>At the same time, you need to compile using C++20, which might not be available to you at the moment.</p><p>I expected the non-CRTP solution to result in a significantly smaller binary, but I was proven wrong. With these small examples, I didn’t find a consistent difference. Depending on the optimization level even one was a bit smaller or the other.</p><p>I still want to try it in a bigger example and I’ll report back the results, but it might take some time.</p><h2 id="conclusion">Conclusion</h2><p>In this article, we covered how we can replace CRTP when we use it to have static interfaces for a family of classes. We saw that with C++20’s concepts, we could replace CRTP and have less error-prone and more readable code. The only question is whether you can already use C++20.</p><h2 id="connect-deeper">Connect deeper</h2><p>If you liked this article, please</p><ul><li>hit on the like button,<li><a href="http://eepurl.com/gvcv1j">subscribe to my newsletter</a></ul><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dev/'>dev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cpp/" class="post-tag no-text-decoration" >cpp</a> <a href="/tags/crtp/" class="post-tag no-text-decoration" >crtp</a> <a href="/tags/concepts/" class="post-tag no-text-decoration" >concepts</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a><div class="share-wrapper"> <a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Replace CRTP with concepts? - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2024/12/04/crtp-vs-concepts" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Replace CRTP with concepts? - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2024/12/04/crtp-vs-concepts" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Replace CRTP with concepts? - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2024/12/04/crtp-vs-concepts" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=Replace CRTP with concepts? - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2024/12/04/crtp-vs-concepts" data-toggle="tooltip" data-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews"> <i class="fa-fw fab fa-hacker-news"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/2025/10/22/trip-report-budapest-cpp">Trip report: Budapest C++ - Breaking & Building C++</a><li><a href="/blog/2025/10/01/cpp26-optional-of-reference">C++26: std::optional&lt;T&amp;&gt;</a><li><a href="/blog/2025/09/24/trip-report-cppcon-2025">Trip report: CppCon 2025</a><li><a href="/blog/2025/07/23/format-your-own-type-part-1">Format your own type (Part 1)</a><li><a href="/blog/2025/07/02/cpponsea-trip-report">Trip report: C++ On Sea 2025</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self-improvement</a> <a class="post-tag" href="/tags/management/">management</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/2022/04/13/first-company-project-experience-with-cpp20"><div class="card-body"> <span class="timeago small" > Apr 13, 2022 <i class="unloaded">2022-04-13T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>My first work experience with C++20</h3><div class="text-muted small"><p> I joined a new team recently. We have our own internal microservices as well as libraries. While for microservices we support one main branch, for libraries we do have to support at least three, in...</p></div></div></a></div><div class="card"> <a href="/blog/2019/03/13/the-curiously-recurring-templatep-pattern-CRTP"><div class="card-body"> <span class="timeago small" > Mar 13, 2019 <i class="unloaded">2019-03-13T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The Curiously Recurring Template Pattern (CRTP)</h3><div class="text-muted small"><p> In this article, we are going to discover the pattern that is called the Curiously Recurring Template Pattern. Are you curious? Read on! Introduction Have you ever wondered about a derived class...</p></div></div></a></div><div class="card"> <a href="/blog/2021/02/10/cpp-concepts-motivations"><div class="card-body"> <span class="timeago small" > Feb 10, 2021 <i class="unloaded">2021-02-10T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The concept behind C++ concepts</h3><div class="text-muted small"><p> The idea of concepts is one of the major new features added to C++20. Concepts are an extension for templates. They can be used to perform compile-time validation of template arguments through bool...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/2024/11/27/non-movable-classes" class="btn btn-outline-primary" prompt="Older"><p>How to ensure a class is not copyable or movable</p></a> <a href="/blog/2024/12/11/start-exploring-cpp26" class="btn btn-outline-primary" prompt="Newer"><p>Let's start exploring C++26</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//sandordargo-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Replace CRTP with concepts?'; this.page.url = 'https://www.sandordargo.com/blog/2024/12/04/crtp-vs-concepts'; this.page.identifier = '/blog/2024/12/04/crtp-vs-concepts'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><div id="amzn-assoc-ad-be5a767b-3346-40aa-bc00-2eff0ce33d2b"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=be5a767b-3346-40aa-bc00-2eff0ce33d2b"></script> <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us16.list-manage.com","uuid":"b073dbd5c29322302f59a8cd8","lid":"d26240427e"}) })</script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/SandorDargo">Sandor Dargo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self improvement</a> <a class="post-tag" href="/tags/management/">management</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.sandordargo.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
