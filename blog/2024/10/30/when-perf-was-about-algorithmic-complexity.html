<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="(When) performance is not about algorithmic complexity" /><meta property="og:locale" content="en_US" /><meta name="description" content="I’ve been taking part in coding dojos either as a participant or a facilitator for the last more or less 10 years with some smaller gaps around reorganizations. Coding dojos helped me turn around my career completely. But that’s not what I’m going to write about today. As a facilitator, I sometimes drive a session very closely, but sometimes I just sit and listen and let the others go in the direction they want until I join back again more actively to ask some questions about the decisions they made. We recently solved the string calculator kata. At the dojos I facilitate, we follow TDD, we do the red-green-refactor cycle. First, we write a test that doesn’t pass, then we implement it with the least amount of logic and then we ask ourselves the question if we want to refactor the code anyhow. Sometimes there is nothing to do, sometimes people want to do some more refactoring. This time, we had already solved about half of the exercises, and when the support for custom delimiters was added, people really wanted to refactor. I also wanted to refactor. I had done this kata way too many times, and I didn’t want to push my ideas; I was listening to what others did. We had one big add function taking care of identifying the delimiter, splitting the string and summing the different numebrs in it, sometimes with a bit of entangled logic. And the others started discussing refactoring in which they wanted to eliminate string allocations. Let’s ignore the fact that with small string optimization, the vast majority of numbers will not need a heap allocation, everything will be on the stack. It’ll be relatively fast. It’s still some memory allocation that we might consider unnecessary. But why would we want to perform micro-optimizations at that point? Why would we want to improve performance? What is performance? As I wrote last week in the different aspects of performance, “Performance is a non-functional characteristic of software. It’s almost always a non-functional requirement as well. Even if it’s not specifically mentioned, software that is too slow - in a given context - is unusable and useless. In that sense, performance is a non-functional requirement that ensures that the software can achieve its functional requirements in a reasonable timespan.” Considering that, why would we want to improve the performance of the string calculator when it has reasonable performance, we know nothing about the non-functional requirements, but we have a growing and more and more complex logic. People said, well, because that’s what C and C++ developers want to always do. We improve performance just for the sake of improvement. While I don’t think we can generalize in such a way, I also think that’s a wrong attitude and won’t help your career unless you’re in a niche where you must squeeze out even the last bit of performance. In my experience, such an attitude is often not the answer to performance problems. I remember my very first project as a developer. Oh boy, it was so mismanaged. I was left alone I think for months to work on it and then people were surprised during the code review that it was subpar, to say the least. Nevertheless, it fulfilled its functional requirements. But it was slow as a snail and suffered from a vast memory leak. There was another developer there who recently started out but he was clearly more gifted as a developer than me. He was freaked out and very quickly claimed to find a culprit. It was 2 functions with the complexity of O(n^4). Yes, it was that bad. Probably it could have been replaced with a standard function, probably with a complexity around O(n * log n). I think I was also ridiculed a bit, but that’s not the point. When he faced me with this bad algo, I clearly realized that yes, it was bad. I also knew that it could not be the problem, but I didn’t know how to prove it. What did I do? I opened a notepad and started to jot down timestamps from our server logs to find out how long serving a request took and how much time of it was about these two horrible functions. Not surprisingly, they represent a tiny fraction of the time. Our problems laid somewhere else. As it turned out weeks later, it was that we (most probably I) misused a third-party library handling XMLs documents. A startup and a cleanup function should have been called when the service was started/finished, but they get called at the beginning and the end of each request. Recognizing that solved all our immediate problems. Years later as a bit more experienced engineer, I had to develop a tool that helped migrate data from one database to another. It was not meant to be used for a long time but as it turned out they had quite some performance requirements. Around those times I got familiarized with Clean Code practices and I decided that that piece of software would serve as a showcase (for me) of what happens if I follow all those rules in the book. (Since then my definition of clean code changed a lot). Well, the software was slow. At least slow compared to what was expected. By an order of magnitude. I made this a bit faster here and there by optimizing the code on a low level, by changing some data structures, but it was very far from being enough. In the end, I achieved the expected levels of performance and everyone was happy. I succeeded by employing two techniques. Instead of reading rows from the database to be migrated one by one, I read several rows at the same time and kept the data in memory until I had to use it In order to insert the data into the new database, I couldn’t access the database directly, but I had to use the CRUD services of a server. It turned out that the server offered some batch services where I could insert several rows at the same time. These “tricks” made the magic. By reading and writing several rows at the same time, in other words, by limiting the number of DB and network calls I had to make, I could speed up the code by about an order of magnitude. The last example I bring up is about when at my previous employer, we had to support a growth in traffic of about 15 times. We did some low-level changes, but it was not about optimization per se. We removed undefined behaviour, we removed bugs that led to crashes. Otherwise, we improved network settings, introduced in-memory caches instead of going to the database so many times, introduced more read-only views at the database and in general reduced the number of DB connections we opened. These together were enough. You can read more about it here. Conclusion What did I want to say with all these little engineering stories? What I tried to say is that in many real-life engineering problems, low-level code optimization is not the answer. Real-life engineering problems are rarely like leet code issues. If you have to interact over the network, or you have a database to deal with, you have to ensure those are handled efficiently. Everything else only comes after. Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter and let’s connect on Twitter!" /><meta property="og:description" content="I’ve been taking part in coding dojos either as a participant or a facilitator for the last more or less 10 years with some smaller gaps around reorganizations. Coding dojos helped me turn around my career completely. But that’s not what I’m going to write about today. As a facilitator, I sometimes drive a session very closely, but sometimes I just sit and listen and let the others go in the direction they want until I join back again more actively to ask some questions about the decisions they made. We recently solved the string calculator kata. At the dojos I facilitate, we follow TDD, we do the red-green-refactor cycle. First, we write a test that doesn’t pass, then we implement it with the least amount of logic and then we ask ourselves the question if we want to refactor the code anyhow. Sometimes there is nothing to do, sometimes people want to do some more refactoring. This time, we had already solved about half of the exercises, and when the support for custom delimiters was added, people really wanted to refactor. I also wanted to refactor. I had done this kata way too many times, and I didn’t want to push my ideas; I was listening to what others did. We had one big add function taking care of identifying the delimiter, splitting the string and summing the different numebrs in it, sometimes with a bit of entangled logic. And the others started discussing refactoring in which they wanted to eliminate string allocations. Let’s ignore the fact that with small string optimization, the vast majority of numbers will not need a heap allocation, everything will be on the stack. It’ll be relatively fast. It’s still some memory allocation that we might consider unnecessary. But why would we want to perform micro-optimizations at that point? Why would we want to improve performance? What is performance? As I wrote last week in the different aspects of performance, “Performance is a non-functional characteristic of software. It’s almost always a non-functional requirement as well. Even if it’s not specifically mentioned, software that is too slow - in a given context - is unusable and useless. In that sense, performance is a non-functional requirement that ensures that the software can achieve its functional requirements in a reasonable timespan.” Considering that, why would we want to improve the performance of the string calculator when it has reasonable performance, we know nothing about the non-functional requirements, but we have a growing and more and more complex logic. People said, well, because that’s what C and C++ developers want to always do. We improve performance just for the sake of improvement. While I don’t think we can generalize in such a way, I also think that’s a wrong attitude and won’t help your career unless you’re in a niche where you must squeeze out even the last bit of performance. In my experience, such an attitude is often not the answer to performance problems. I remember my very first project as a developer. Oh boy, it was so mismanaged. I was left alone I think for months to work on it and then people were surprised during the code review that it was subpar, to say the least. Nevertheless, it fulfilled its functional requirements. But it was slow as a snail and suffered from a vast memory leak. There was another developer there who recently started out but he was clearly more gifted as a developer than me. He was freaked out and very quickly claimed to find a culprit. It was 2 functions with the complexity of O(n^4). Yes, it was that bad. Probably it could have been replaced with a standard function, probably with a complexity around O(n * log n). I think I was also ridiculed a bit, but that’s not the point. When he faced me with this bad algo, I clearly realized that yes, it was bad. I also knew that it could not be the problem, but I didn’t know how to prove it. What did I do? I opened a notepad and started to jot down timestamps from our server logs to find out how long serving a request took and how much time of it was about these two horrible functions. Not surprisingly, they represent a tiny fraction of the time. Our problems laid somewhere else. As it turned out weeks later, it was that we (most probably I) misused a third-party library handling XMLs documents. A startup and a cleanup function should have been called when the service was started/finished, but they get called at the beginning and the end of each request. Recognizing that solved all our immediate problems. Years later as a bit more experienced engineer, I had to develop a tool that helped migrate data from one database to another. It was not meant to be used for a long time but as it turned out they had quite some performance requirements. Around those times I got familiarized with Clean Code practices and I decided that that piece of software would serve as a showcase (for me) of what happens if I follow all those rules in the book. (Since then my definition of clean code changed a lot). Well, the software was slow. At least slow compared to what was expected. By an order of magnitude. I made this a bit faster here and there by optimizing the code on a low level, by changing some data structures, but it was very far from being enough. In the end, I achieved the expected levels of performance and everyone was happy. I succeeded by employing two techniques. Instead of reading rows from the database to be migrated one by one, I read several rows at the same time and kept the data in memory until I had to use it In order to insert the data into the new database, I couldn’t access the database directly, but I had to use the CRUD services of a server. It turned out that the server offered some batch services where I could insert several rows at the same time. These “tricks” made the magic. By reading and writing several rows at the same time, in other words, by limiting the number of DB and network calls I had to make, I could speed up the code by about an order of magnitude. The last example I bring up is about when at my previous employer, we had to support a growth in traffic of about 15 times. We did some low-level changes, but it was not about optimization per se. We removed undefined behaviour, we removed bugs that led to crashes. Otherwise, we improved network settings, introduced in-memory caches instead of going to the database so many times, introduced more read-only views at the database and in general reduced the number of DB connections we opened. These together were enough. You can read more about it here. Conclusion What did I want to say with all these little engineering stories? What I tried to say is that in many real-life engineering problems, low-level code optimization is not the answer. Real-life engineering problems are rarely like leet code issues. If you have to interact over the network, or you have a database to deal with, you have to ensure those are handled efficiently. Everything else only comes after. Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter and let’s connect on Twitter!" /><link rel="canonical" href="https://www.sandordargo.com/blog/2024/10/30/when-perf-was-about-algorithmic-complexity" /><meta property="og:url" content="https://www.sandordargo.com/blog/2024/10/30/when-perf-was-about-algorithmic-complexity" /><meta property="og:site_name" content="Sandor Dargo’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-10-30T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(When) performance is not about algorithmic complexity" /><meta name="twitter:site" content="@SandorDargo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-10-30T00:00:00+01:00","datePublished":"2024-10-30T00:00:00+01:00","description":"I’ve been taking part in coding dojos either as a participant or a facilitator for the last more or less 10 years with some smaller gaps around reorganizations. Coding dojos helped me turn around my career completely. But that’s not what I’m going to write about today. As a facilitator, I sometimes drive a session very closely, but sometimes I just sit and listen and let the others go in the direction they want until I join back again more actively to ask some questions about the decisions they made. We recently solved the string calculator kata. At the dojos I facilitate, we follow TDD, we do the red-green-refactor cycle. First, we write a test that doesn’t pass, then we implement it with the least amount of logic and then we ask ourselves the question if we want to refactor the code anyhow. Sometimes there is nothing to do, sometimes people want to do some more refactoring. This time, we had already solved about half of the exercises, and when the support for custom delimiters was added, people really wanted to refactor. I also wanted to refactor. I had done this kata way too many times, and I didn’t want to push my ideas; I was listening to what others did. We had one big add function taking care of identifying the delimiter, splitting the string and summing the different numebrs in it, sometimes with a bit of entangled logic. And the others started discussing refactoring in which they wanted to eliminate string allocations. Let’s ignore the fact that with small string optimization, the vast majority of numbers will not need a heap allocation, everything will be on the stack. It’ll be relatively fast. It’s still some memory allocation that we might consider unnecessary. But why would we want to perform micro-optimizations at that point? Why would we want to improve performance? What is performance? As I wrote last week in the different aspects of performance, “Performance is a non-functional characteristic of software. It’s almost always a non-functional requirement as well. Even if it’s not specifically mentioned, software that is too slow - in a given context - is unusable and useless. In that sense, performance is a non-functional requirement that ensures that the software can achieve its functional requirements in a reasonable timespan.” Considering that, why would we want to improve the performance of the string calculator when it has reasonable performance, we know nothing about the non-functional requirements, but we have a growing and more and more complex logic. People said, well, because that’s what C and C++ developers want to always do. We improve performance just for the sake of improvement. While I don’t think we can generalize in such a way, I also think that’s a wrong attitude and won’t help your career unless you’re in a niche where you must squeeze out even the last bit of performance. In my experience, such an attitude is often not the answer to performance problems. I remember my very first project as a developer. Oh boy, it was so mismanaged. I was left alone I think for months to work on it and then people were surprised during the code review that it was subpar, to say the least. Nevertheless, it fulfilled its functional requirements. But it was slow as a snail and suffered from a vast memory leak. There was another developer there who recently started out but he was clearly more gifted as a developer than me. He was freaked out and very quickly claimed to find a culprit. It was 2 functions with the complexity of O(n^4). Yes, it was that bad. Probably it could have been replaced with a standard function, probably with a complexity around O(n * log n). I think I was also ridiculed a bit, but that’s not the point. When he faced me with this bad algo, I clearly realized that yes, it was bad. I also knew that it could not be the problem, but I didn’t know how to prove it. What did I do? I opened a notepad and started to jot down timestamps from our server logs to find out how long serving a request took and how much time of it was about these two horrible functions. Not surprisingly, they represent a tiny fraction of the time. Our problems laid somewhere else. As it turned out weeks later, it was that we (most probably I) misused a third-party library handling XMLs documents. A startup and a cleanup function should have been called when the service was started/finished, but they get called at the beginning and the end of each request. Recognizing that solved all our immediate problems. Years later as a bit more experienced engineer, I had to develop a tool that helped migrate data from one database to another. It was not meant to be used for a long time but as it turned out they had quite some performance requirements. Around those times I got familiarized with Clean Code practices and I decided that that piece of software would serve as a showcase (for me) of what happens if I follow all those rules in the book. (Since then my definition of clean code changed a lot). Well, the software was slow. At least slow compared to what was expected. By an order of magnitude. I made this a bit faster here and there by optimizing the code on a low level, by changing some data structures, but it was very far from being enough. In the end, I achieved the expected levels of performance and everyone was happy. I succeeded by employing two techniques. Instead of reading rows from the database to be migrated one by one, I read several rows at the same time and kept the data in memory until I had to use it In order to insert the data into the new database, I couldn’t access the database directly, but I had to use the CRUD services of a server. It turned out that the server offered some batch services where I could insert several rows at the same time. These “tricks” made the magic. By reading and writing several rows at the same time, in other words, by limiting the number of DB and network calls I had to make, I could speed up the code by about an order of magnitude. The last example I bring up is about when at my previous employer, we had to support a growth in traffic of about 15 times. We did some low-level changes, but it was not about optimization per se. We removed undefined behaviour, we removed bugs that led to crashes. Otherwise, we improved network settings, introduced in-memory caches instead of going to the database so many times, introduced more read-only views at the database and in general reduced the number of DB connections we opened. These together were enough. You can read more about it here. Conclusion What did I want to say with all these little engineering stories? What I tried to say is that in many real-life engineering problems, low-level code optimization is not the answer. Real-life engineering problems are rarely like leet code issues. If you have to interact over the network, or you have a database to deal with, you have to ensure those are handled efficiently. Everything else only comes after. Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter and let’s connect on Twitter!","headline":"(When) performance is not about algorithmic complexity","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sandordargo.com/blog/2024/10/30/when-perf-was-about-algorithmic-complexity"},"url":"https://www.sandordargo.com/blog/2024/10/30/when-perf-was-about-algorithmic-complexity"}</script><title>(When) performance is not about algorithmic complexity | Sandor Dargo's Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-89625019-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-89625019-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/SANDOR_DARGO_ROUND.JPG" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sandor Dargo's Blog</a></div><div class="site-subtitle font-italic">On C++, software development and books</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/books/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BOOKS</span> </a><li class="nav-item"> <a href="/speaking/" class="nav-link"> <i class="fa-fw fas fa-microphone ml-xl-3 mr-xl-3 unloaded"></i> <span>SPEAKING</span> </a><li class="nav-item"> <a href="/dailycpp/" class="nav-link"> <i class="fa-fw fas fa-link ml-xl-3 mr-xl-3 unloaded"></i> <span>DAILY C++</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>HI...</span> </a></ul><ul class="w-100"><li class="nav-item"> <a href="https://www.patreon.com/sandordargo" class="nav-link"> <img src="https://c5.patreon.com/external/logo/become_a_patron_button.png"></a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/sandordargo" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/SandorDargo" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sandor.dargo','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog"> Blog </a> </span> <span> <a href="/2024"> 2024 </a> </span> <span> <a href="/10"> 10 </a> </span> <span> <a href="/30"> 30 </a> </span> <span>(When) performance is not about algorithmic complexity</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(When) performance is not about algorithmic complexity</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Sandor Dargo </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Oct 30, 2024, 12:00 AM +0100" prep="on" > Oct 30, 2024 <i class="unloaded">2024-10-30T00:00:00+01:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1252 words">6 min</span></div></div><div class="post-content"><p>I’ve been taking part in coding dojos either as a participant or a facilitator for the last more or less 10 years with some smaller gaps around reorganizations. Coding dojos helped me turn around my career completely. But that’s not what I’m going to write about today.</p><p>As a facilitator, I sometimes drive a session very closely, but sometimes I just sit and listen and let the others go in the direction they want until I join back again more actively to ask some questions about the decisions they made.</p><p>We recently solved <a href="https://osherove.com/tdd-kata-1">the string calculator kata</a>. At the dojos I facilitate, we follow TDD, we do the red-green-refactor cycle. First, we write a test that doesn’t pass, then we implement it with the least amount of logic and then we ask ourselves the question if we want to refactor the code anyhow. Sometimes there is nothing to do, sometimes people want to do some more refactoring.</p><p>This time, we had already solved about half of the exercises, and when the support for custom delimiters was added, people really wanted to refactor. I also wanted to refactor. I had done this kata way too many times, and I didn’t want to push my ideas; I was listening to what others did.</p><p>We had one big <code class="language-plaintext highlighter-rouge">add</code> function taking care of identifying the delimiter, splitting the string and summing the different numebrs in it, sometimes with a bit of entangled logic.</p><p>And the others started discussing refactoring in which they wanted to eliminate string allocations. Let’s ignore the fact that with small string optimization, the vast majority of numbers will not need a heap allocation, everything will be on the stack. It’ll be relatively fast. It’s still some memory allocation that we might consider unnecessary.</p><p>But why would we want to perform micro-optimizations at that point? Why would we want to improve performance? What is performance?</p><p>As I wrote last week in <a href="https://www.sandordargo.com/blog/2024/10/23/different-aspects-of-software-performance">the different aspects of performance</a>, <em>“Performance is a non-functional characteristic of software. It’s almost always a non-functional requirement as well. Even if it’s not specifically mentioned, software that is too slow - in a given context - is unusable and useless. In that sense, performance is a non-functional requirement that ensures that the software can achieve its functional requirements in a reasonable timespan.”</em></p><p>Considering that, why would we want to improve the performance of the string calculator when it has reasonable performance, we know nothing about the non-functional requirements, but we have a growing and more and more complex logic.</p><p>People said, well, because that’s what C and C++ developers want to always do. We improve performance just for the sake of improvement.</p><p>While I don’t think we can generalize in such a way, I also think that’s a wrong attitude and won’t help your career unless you’re in a niche where you must squeeze out even the last bit of performance.</p><p>In my experience, such an attitude is often not the answer to performance problems.</p><p>I remember my very first project as a developer. Oh boy, it was so mismanaged. I was left alone I think for months to work on it and then people were surprised during the code review that it was subpar, to say the least. Nevertheless, it fulfilled its functional requirements. But it was slow as a snail and suffered from a vast memory leak.</p><p>There was another developer there who recently started out but he was clearly more gifted as a developer than me. He was freaked out and very quickly claimed to find a culprit. It was 2 functions with the complexity of O(n^4). Yes, it was that bad. Probably it could have been replaced with a standard function, probably with a complexity around O(n * log n). I think I was also ridiculed a bit, but that’s not the point. When he faced me with this bad algo, I clearly realized that yes, it was bad. I also knew that it could not be the problem, but I didn’t know how to prove it.</p><p>What did I do? I opened a notepad and started to jot down timestamps from our server logs to find out how long serving a request took and how much time of it was about these two horrible functions. Not surprisingly, they represent a tiny fraction of the time.</p><p>Our problems laid somewhere else.</p><p>As it turned out weeks later, it was that we (most probably I) misused a third-party library handling XMLs documents. A startup and a cleanup function should have been called when the service was started/finished, but they get called at the beginning and the end of each request. Recognizing that solved all our immediate problems.</p><p>Years later as a bit more experienced engineer, I had to develop a tool that helped migrate data from one database to another. It was not meant to be used for a long time but as it turned out they had quite some performance requirements.</p><p>Around those times I got familiarized with Clean Code practices and I decided that that piece of software would serve as a showcase (for me) of what happens if I follow all those rules in the book. (Since then my definition of clean code changed a lot). Well, the software was slow. At least slow compared to what was expected. By an order of magnitude.</p><p>I made this a bit faster here and there by optimizing the code on a low level, by changing some data structures, but it was very far from being enough.</p><p>In the end, I achieved the expected levels of performance and everyone was happy. I succeeded by employing two techniques. Instead of reading rows from the database to be migrated one by one, I read several rows at the same time and kept the data in memory until I had to use it</p><p>In order to insert the data into the new database, I couldn’t access the database directly, but I had to use the CRUD services of a server. It turned out that the server offered some batch services where I could insert several rows at the same time.</p><p>These “tricks” made the magic. By reading and writing several rows at the same time, in other words, by limiting the number of DB and network calls I had to make, I could speed up the code by about an order of magnitude.</p><p>The last example I bring up is about when at my previous employer, we had to support a growth in traffic of about 15 times. We did some low-level changes, but it was not about optimization per se. We removed undefined behaviour, we removed bugs that led to crashes. Otherwise, we improved network settings, introduced in-memory caches instead of going to the database so many times, introduced more read-only views at the database and in general reduced the number of DB connections we opened.</p><p>These together were enough. You can read more about it <a href="https://developers.amadeus.com/blog/multi-layer-caching-cars-application-performance">here</a>.</p><h2 id="conclusion">Conclusion</h2><p>What did I want to say with all these little engineering stories? What I tried to say is that in many real-life engineering problems, low-level code optimization is not the answer. Real-life engineering problems are rarely like leet code issues. If you have to interact over the network, or you have a database to deal with, you have to ensure those are handled efficiently.</p><p>Everything else only comes after.</p><h2 id="connect-deeper">Connect deeper</h2><p>If you liked this article, please</p><ul><li>hit on the like button,<li><a href="http://eepurl.com/gvcv1j">subscribe to my newsletter</a><li>and let’s connect on <a href="https://twitter.com/SandorDargo">Twitter</a>!</ul><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dev/'>dev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/architecture/" class="post-tag no-text-decoration" >architecture</a> <a href="/tags/performance/" class="post-tag no-text-decoration" >performance</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a><div class="share-wrapper"> <a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(When) performance is not about algorithmic complexity - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2024/10/30/when-perf-was-about-algorithmic-complexity" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(When) performance is not about algorithmic complexity - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2024/10/30/when-perf-was-about-algorithmic-complexity" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(When) performance is not about algorithmic complexity - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2024/10/30/when-perf-was-about-algorithmic-complexity" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=(When) performance is not about algorithmic complexity - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2024/10/30/when-perf-was-about-algorithmic-complexity" data-toggle="tooltip" data-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews"> <i class="fa-fw fab fa-hacker-news"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/2025/10/22/trip-report-budapest-cpp">Trip report: Budapest C++ - Breaking & Building C++</a><li><a href="/blog/2025/10/01/cpp26-optional-of-reference">C++26: std::optional&lt;T&amp;&gt;</a><li><a href="/blog/2025/09/24/trip-report-cppcon-2025">Trip report: CppCon 2025</a><li><a href="/blog/2025/07/23/format-your-own-type-part-1">Format your own type (Part 1)</a><li><a href="/blog/2025/07/02/cpponsea-trip-report">Trip report: C++ On Sea 2025</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self-improvement</a> <a class="post-tag" href="/tags/management/">management</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/2024/03/16/tidy-first-by-kent-beck"><div class="card-body"> <span class="timeago small" > Mar 16, 2024 <i class="unloaded">2024-03-16T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tidy First? by Kent Beck</h3><div class="text-muted small"><p> Let’s start by explaining what tidying means when it comes to software development. Maybe a decade ago, this book would have been called “Refactoring first?”, but the term “refactoring” got inflate...</p></div></div></a></div><div class="card"> <a href="/blog/2018/03/14/most-important-books-to-start-with"><div class="card-body"> <span class="timeago small" > Mar 14, 2018 <i class="unloaded">2018-03-14T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>8 books every junior developer should read</h3><div class="text-muted small"><p> When I started to earn a stable revenue I started to buy books every month. Soon I was in the highest tier of the fidelity program of the biggest Hungarian bookselling chain, so I bought even more....</p></div></div></a></div><div class="card"> <a href="/blog/2018/04/18/uncle-bob-clean-architecture"><div class="card-body"> <span class="timeago small" > Apr 18, 2018 <i class="unloaded">2018-04-18T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Clean Architecture: A Craftsman's Guide to Software Structure and Design</h3><div class="text-muted small"><p> I’ve read quite a few books about clean coding principles or about good coding practices. What I missed a bit is more about software architecture. Hence I enqueued some books about that topic and I...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/2024/10/23/different-aspects-of-software-performance" class="btn btn-outline-primary" prompt="Older"><p>Different aspects of software performance</p></a> <a href="/blog/2024/11/06/std-span" class="btn btn-outline-primary" prompt="Newer"><p>Use std::span instead of C-style arrays</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//sandordargo-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = '(When) performance is not about algorithmic complexity'; this.page.url = 'https://www.sandordargo.com/blog/2024/10/30/when-perf-was-about-algorithmic-complexity'; this.page.identifier = '/blog/2024/10/30/when-perf-was-about-algorithmic-complexity'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><div id="amzn-assoc-ad-be5a767b-3346-40aa-bc00-2eff0ce33d2b"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=be5a767b-3346-40aa-bc00-2eff0ce33d2b"></script> <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us16.list-manage.com","uuid":"b073dbd5c29322302f59a8cd8","lid":"d26240427e"}) })</script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/SandorDargo">Sandor Dargo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self improvement</a> <a class="post-tag" href="/tags/management/">management</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.sandordargo.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
