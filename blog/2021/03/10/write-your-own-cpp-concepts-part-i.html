<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="How to write your own C++ concepts? Part I." /><meta property="og:locale" content="en_US" /><meta name="description" content="During the previous weeks, we discussed the motivations behind C++ concepts and how to use them with functions and with classes. But we have hardly written any. We defined a functionally incomplete concept called Number for the sake of example, but that’s it. Now are going into details on what kind of constraints we can express in a concept." /><meta property="og:description" content="During the previous weeks, we discussed the motivations behind C++ concepts and how to use them with functions and with classes. But we have hardly written any. We defined a functionally incomplete concept called Number for the sake of example, but that’s it. Now are going into details on what kind of constraints we can express in a concept." /><link rel="canonical" href="https://www.sandordargo.com/blog/2021/03/10/write-your-own-cpp-concepts-part-i" /><meta property="og:url" content="https://www.sandordargo.com/blog/2021/03/10/write-your-own-cpp-concepts-part-i" /><meta property="og:site_name" content="Sandor Dargo’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-10T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="How to write your own C++ concepts? Part I." /><meta name="twitter:site" content="@SandorDargo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-06-01T20:06:31+02:00","datePublished":"2021-03-10T00:00:00+01:00","description":"During the previous weeks, we discussed the motivations behind C++ concepts and how to use them with functions and with classes. But we have hardly written any. We defined a functionally incomplete concept called Number for the sake of example, but that’s it. Now are going into details on what kind of constraints we can express in a concept.","headline":"How to write your own C++ concepts? Part I.","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sandordargo.com/blog/2021/03/10/write-your-own-cpp-concepts-part-i"},"url":"https://www.sandordargo.com/blog/2021/03/10/write-your-own-cpp-concepts-part-i"}</script><title>How to write your own C++ concepts? Part I. | Sandor Dargo's Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-89625019-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-89625019-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/SANDOR_DARGO_ROUND.JPG" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sandor Dargo's Blog</a></div><div class="site-subtitle font-italic">On C++, software development and books</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/books/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BOOKS</span> </a><li class="nav-item"> <a href="/speaking/" class="nav-link"> <i class="fa-fw fas fa-microphone ml-xl-3 mr-xl-3 unloaded"></i> <span>SPEAKING</span> </a><li class="nav-item"> <a href="/dailycpp/" class="nav-link"> <i class="fa-fw fas fa-link ml-xl-3 mr-xl-3 unloaded"></i> <span>DAILY C++</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>HI...</span> </a></ul><ul class="w-100"><li class="nav-item"> <a href="https://www.patreon.com/sandordargo" class="nav-link"> <img src="https://c5.patreon.com/external/logo/become_a_patron_button.png"></a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/sandordargo" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/SandorDargo" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sandor.dargo','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog"> Blog </a> </span> <span> <a href="/2021"> 2021 </a> </span> <span> <a href="/03"> 03 </a> </span> <span> <a href="/10"> 10 </a> </span> <span>How to write your own C++ concepts? Part I.</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>How to write your own C++ concepts? Part I.</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Sandor Dargo </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Mar 10, 2021, 12:00 AM +0100" prep="on" > Mar 10, 2021 <i class="unloaded">2021-03-10T00:00:00+01:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Jun 1, 2021, 8:06 PM +0200" prefix="Updated " > Jun 1, 2021 <i class="unloaded">2021-06-01T20:06:31+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2109 words">11 min</span></div></div><div class="post-content"><p>During the previous weeks, we discussed <a href="https://www.sandordargo.com/blog/2021/02/10/cpp-concepts-motivations">the motivations behind C++ concepts</a> and <a href="https://www.sandordargo.com/blog/2021/02/17/cpp-concepts-4-ways-to-use-them">how to use them with functions</a> and <a href="https://www.sandordargo.com/blog/2021/02/24/cpp-concepts-with-classes">with classes</a>. But we have hardly written any. We defined a functionally incomplete concept called <code class="language-plaintext highlighter-rouge">Number</code> for the sake of example, but that’s it. Now are going into details on what kind of constraints we can express in a concept.</p><p>This article would be too long if I included the different kinds of constraints all at once. In this one, we are going start from the simples concepts combining existing ones then we are going to finish with required operations and in general requirements on a class’ API.</p><p>Next week, I’ll show you how to write requirements on return types, how to express type requirements and how to nest constraints.</p><p>It’s high time to finally get started.</p><h2 id="the-simplest-concept">The simplest <code class="language-plaintext highlighter-rouge">concept</code></h2><p>Let’s define the simplest concept we can imagine first, just to see the syntax.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span> 
<span class="k">concept</span> <span class="n">Any</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</pre></table></code></div></div><p>First, we list the template parameters, in this case, we have only one, <code class="language-plaintext highlighter-rouge">T</code>, but we could have multiple ones separated by commas. Then after the keyword <code class="language-plaintext highlighter-rouge">concept,</code> we declare the name of the concept and then after the <code class="language-plaintext highlighter-rouge">=</code> we define the concept.</p><p>In this example, we simply say <code class="language-plaintext highlighter-rouge">true</code>, meaning that for any type <code class="language-plaintext highlighter-rouge">T</code> the concept will be evaluated to <code class="language-plaintext highlighter-rouge">true</code>; any type is accepted. Should we wrote <code class="language-plaintext highlighter-rouge">false</code>, nothing would be accepted.</p><p>Now that we saw the simplest concept, let’s check what building blocks are at our disposal to construct a more detailed concept.</p><h2 id="use-already-defined-concepts">Use already defined concepts</h2><p>Arguably the easiest way to define new concepts is by combining existing ones.</p><p>For instance, in the next example, we are going to create - once again - a concept called <code class="language-plaintext highlighter-rouge">Number</code> by accepting both integers and floating-point numbers.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;concepts&gt;</span><span class="cp">
</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span> 
<span class="k">concept</span> <span class="n">Number</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">integral</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">||</span> <span class="n">std</span><span class="o">::</span><span class="n">floating_point</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>
</pre></table></code></div></div><p>As you can see in the above example, we could easily combine with the <code class="language-plaintext highlighter-rouge">||</code> operator two concepts. Of course, we can use any logical operator.</p><p>Probably it’s self-evident, but we can use user-defined concepts as well.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;concepts&gt;</span><span class="cp">
</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span> 
<span class="k">concept</span> <span class="n">Integer</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">integral</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span> 
<span class="k">concept</span> <span class="n">Float</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">floating_point</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span> 
<span class="k">concept</span> <span class="n">Number</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">||</span> <span class="n">Float</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>
</pre></table></code></div></div><p>In this example, we basically just aliased (and added a layer of indirection to) <code class="language-plaintext highlighter-rouge">std::integral</code> and <code class="language-plaintext highlighter-rouge">std::floating_point</code> to show that user-defined concepts can also be used in a combination of concepts.</p><p><a href="https://www.sandordargo.com/blog/2021/03/03/cpp-concepts-in-standard-library">As we saw earlier</a>, there are plenty of concepts defined in the different headers of the standard library so there is an endless way to combine them.</p><p>But how to define truly unique concepts?</p><h2 id="write-your-own-constraints">Write your own constraints</h2><p>In the coming sections, we are going to delve into how to express our own unique requirements without using any of the predefined concepts.</p><h3 id="requirements-on-operations">Requirements on operations</h3><p>We can simply express that we require that a template parameter support a certain operation or operator by <em>wishful writing</em>.</p><p>If you require that template parameters are addable you can create a concept for that:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;concepts&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">Addable</span> <span class="o">=</span> <span class="k">requires</span> <span class="p">(</span><span class="n">T</span> <span class="n">a</span><span class="p">,</span> <span class="n">T</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span> 
<span class="p">};</span>

<span class="k">auto</span> <span class="nf">add</span><span class="p">(</span><span class="n">Addable</span> <span class="k">auto</span> <span class="n">x</span><span class="p">,</span> <span class="n">Addable</span> <span class="k">auto</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="nc">WrappedInt</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">m_int</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span> <span class="p">()</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">add</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">add</span><span class="p">(</span><span class="nb">true</span><span class="p">,</span> <span class="nb">true</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
  <span class="c1">// std::cout &lt;&lt; add(WrappedInt{4}, WrappedInt{5}) &lt;&lt; '\n'; // error: use of function 'auto add(auto:11, auto:12) [with auto:11 = WrappedInt; auto:12 = WrappedInt]' with unsatisfied constraints</span>
<span class="p">}</span>
<span class="cm">/*
9
2 
*/</span>
</pre></table></code></div></div><p>We can observe that when <code class="language-plaintext highlighter-rouge">add()</code> is called with parameters of type <code class="language-plaintext highlighter-rouge">WrappedInt</code> - as they do not support <code class="language-plaintext highlighter-rouge">operator+</code> - the compilation fails with a rather descriptive error message (not the whole error message is copied over into the above example).</p><p>Writing the <code class="language-plaintext highlighter-rouge">Addable</code> concept seems rather easy, right? After the <code class="language-plaintext highlighter-rouge">requires</code> keyword we basically wrote down what kind of syntax we expect to compile and run.</p><h3 id="simple-requirements-on-the-interface">Simple requirements on the interface</h3><p>Let’s think about operations for a little longer. What does it mean after all to require the support of a <code class="language-plaintext highlighter-rouge">+</code> operation?</p><p>It means that we constrain the accepted types to those having a function <code class="language-plaintext highlighter-rouge">T T::operator+(const T&amp; other) const</code> function. Or it can even be <code class="language-plaintext highlighter-rouge">T T::operator+(const U&amp; other) const</code>, as maybe we want to add to an instance of another type, but that’s not the point here. My point is that we made a requirement on having a specific function.</p><p>So we should be able to define a requirement on any function call, shouldn’t we?</p><p>Right, let’s see how to do it.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;concepts&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="c1">// 2</span>
<span class="k">concept</span> <span class="n">HasSquare</span> <span class="o">=</span> <span class="k">requires</span> <span class="p">(</span><span class="n">T</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">t</span><span class="p">.</span><span class="n">square</span><span class="p">();</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">IntWithoutSquare</span> <span class="p">{</span>
<span class="nl">public:</span>
  <span class="n">IntWithoutSquare</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="o">:</span> <span class="n">m_num</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="p">{}</span>
<span class="k">private</span><span class="o">:</span>
  <span class="kt">int</span> <span class="n">m_num</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">IntWithSquare</span> <span class="p">{</span>
<span class="nl">public:</span>
  <span class="n">IntWithSquare</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="o">:</span> <span class="n">m_num</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="p">{}</span>
  <span class="kt">int</span> <span class="nf">square</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">m_num</span> <span class="o">*</span> <span class="n">m_num</span><span class="p">;</span>
  <span class="p">}</span>
<span class="k">private</span><span class="o">:</span>
  <span class="kt">int</span> <span class="n">m_num</span><span class="p">;</span>
<span class="p">};</span>


<span class="kt">void</span> <span class="nf">printSquare</span><span class="p">(</span><span class="n">HasSquare</span> <span class="k">auto</span> <span class="n">number</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 1</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">number</span><span class="p">.</span><span class="n">square</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">printSquare</span><span class="p">(</span><span class="n">IntWithoutSquare</span><span class="p">{</span><span class="mi">4</span><span class="p">});</span> <span class="c1">// error: use of function 'void printSquare(auto:11) [with auto:11 = IntWithoutSquare]' with unsatisfied constraints, </span>
                                    <span class="c1">// the required expression 't.square()' is invalid</span>
  <span class="n">printSquare</span><span class="p">(</span><span class="n">IntWithSquare</span><span class="p">{</span><span class="mi">5</span><span class="p">});</span>
<span class="p">}</span>
</pre></table></code></div></div><p>In this example, we have a function <code class="language-plaintext highlighter-rouge">printSquare</code> (1) that requires a parameter satisfying the concept <code class="language-plaintext highlighter-rouge">HasSquare</code> (2). In that concept, we can see that it’s really easy to define what interface we expect. After the <code class="language-plaintext highlighter-rouge">requires</code> keyword, we have to write down how what calls should be supported by the interface of the accepted types.</p><p>Our expectations are written after the <code class="language-plaintext highlighter-rouge">requires</code> keyword. First, there is a parameter list between parentheses - like for a function - where we have to list all the template parameters that would be constrained and any other parameters that might appear in the constraints. More on that later.</p><p>If we expect that any passed in type have a function called <code class="language-plaintext highlighter-rouge">square</code>, we simply have to write <code class="language-plaintext highlighter-rouge">(T t) {t.square();}</code>. <code class="language-plaintext highlighter-rouge">(T t)</code> because we want to define a constraint on an instance of <code class="language-plaintext highlighter-rouge">T</code> template type and <code class="language-plaintext highlighter-rouge">t.square()</code> because we expect that <code class="language-plaintext highlighter-rouge">t</code> instance of type <code class="language-plaintext highlighter-rouge">T</code> must have a public function <code class="language-plaintext highlighter-rouge">square()</code>.</p><p>If we have requirements on the validity of multiple function calls, we just have to list all of them separated by a semicolon like if we called them one after the other:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">HasSquare</span> <span class="o">=</span> <span class="k">requires</span> <span class="p">(</span><span class="n">T</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">t</span><span class="p">.</span><span class="n">square</span><span class="p">();</span>
  <span class="n">t</span><span class="p">.</span><span class="n">sqrt</span><span class="p">();</span>
<span class="p">};</span>
</pre></table></code></div></div><p>What about parameters? Let’s define a <code class="language-plaintext highlighter-rouge">power</code> function that takes an <code class="language-plaintext highlighter-rouge">int</code> parameter for the exponent:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">HasPower</span> <span class="o">=</span> <span class="k">requires</span> <span class="p">(</span><span class="n">T</span> <span class="n">t</span><span class="p">,</span> <span class="kt">int</span> <span class="n">exponent</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">t</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="n">exponent</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// ...</span>

<span class="kt">void</span> <span class="nf">printPower</span><span class="p">(</span><span class="n">HasPower</span> <span class="k">auto</span> <span class="n">number</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">number</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">exponent</code> variable that we pass to the <code class="language-plaintext highlighter-rouge">T::power</code> function has to be listed after the <code class="language-plaintext highlighter-rouge">requires</code> keyword with its type, along with the template type(s) we constrain. As such, we fix that the parameter will be something that is (convertible to) an <code class="language-plaintext highlighter-rouge">int</code>.</p><p>But what if we wanted to accept just any integral number as an exponent. Where is a will, there is a way! Well, it’s not always true when it comes to syntactical questions, but we got lucky in this case.</p><p>First, our concept <code class="language-plaintext highlighter-rouge">HasPower</code> should take two parameters. One for the base type and one for the exponent type.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Base</span><span class="p">,</span> <span class="k">typename</span> <span class="nc">Exponent</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">HasPower</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">integral</span><span class="o">&lt;</span><span class="n">Exponent</span><span class="o">&gt;</span> <span class="o">&amp;&amp;</span> <span class="k">requires</span> <span class="p">(</span><span class="n">Base</span> <span class="n">base</span><span class="p">,</span> <span class="n">Exponent</span> <span class="n">exponent</span><span class="p">)</span> <span class="p">{</span> 
    <span class="n">base</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="n">exponent</span><span class="p">);</span>
<span class="p">};</span>
</pre></table></code></div></div><p>We make sure that template type <code class="language-plaintext highlighter-rouge">Exponent</code> is an integral and that it can be passed to <code class="language-plaintext highlighter-rouge">Base::power()</code> as a parameter.</p><p>The next step is to update our <code class="language-plaintext highlighter-rouge">printPower</code> function. The concept <code class="language-plaintext highlighter-rouge">HasPower</code> has changed, now it takes two types, we have to make some changes accordingly:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Exponent</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">printPower</span><span class="p">(</span><span class="n">HasPower</span><span class="o">&lt;</span><span class="n">Exponent</span><span class="o">&gt;</span> <span class="k">auto</span> <span class="n">number</span><span class="p">,</span> <span class="n">Exponent</span> <span class="n">exponent</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">number</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="n">exponent</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>As <code class="language-plaintext highlighter-rouge">Exponent</code> is explicitly listed as a template type parameter, there is no need for the <code class="language-plaintext highlighter-rouge">auto</code> keyword after it. On the other hand, <code class="language-plaintext highlighter-rouge">auto</code> is needed after <code class="language-plaintext highlighter-rouge">HasPower</code>, otherwise, how would we know that it’s a concept and not a specific type?! As <code class="language-plaintext highlighter-rouge">Exponent</code> is passed as a template type parameter to <code class="language-plaintext highlighter-rouge">HasPower</code> constraints are applied to it too.</p><p>Now <code class="language-plaintext highlighter-rouge">printPower</code> can be called the following way - given that we renamed <code class="language-plaintext highlighter-rouge">IntWithSquare</code> to <code class="language-plaintext highlighter-rouge">IntWithPower</code> following our API changes:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">printPower</span><span class="p">(</span><span class="n">IntWithPower</span><span class="p">{</span><span class="mi">5</span><span class="p">},</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">printPower</span><span class="p">(</span><span class="n">IntWithPower</span><span class="p">{</span><span class="mi">5</span><span class="p">},</span> <span class="mi">4L</span><span class="p">);</span>
</pre></table></code></div></div><p>At the same time, the call <code class="language-plaintext highlighter-rouge">printPower(IntWithPower{5}, 3.0);</code> will fail because the type <code class="language-plaintext highlighter-rouge">float</code> does not satisfy the constraint on integrality.</p><p>Do we miss something? Yes! We can’t use <code class="language-plaintext highlighter-rouge">IntWithPower</code> as an exponent. We want to be able to call <code class="language-plaintext highlighter-rouge">Base::power(Exponent exp)</code> with a custom type, like <code class="language-plaintext highlighter-rouge">IntWithPower</code> and for that, we need two things:</p><ul><li><code class="language-plaintext highlighter-rouge">IntWithPower</code> should be considered an <code class="language-plaintext highlighter-rouge">integral</code> type<li><code class="language-plaintext highlighter-rouge">IntWithPower</code> should be convertible to something accepted by <code class="language-plaintext highlighter-rouge">pow</code> from the <code class="language-plaintext highlighter-rouge">cmath</code> header.</ul><p>Let’s go one by one.</p><p>By explicitly specifying the <code class="language-plaintext highlighter-rouge">type_trait</code> <code class="language-plaintext highlighter-rouge">std::is_integral</code> for <code class="language-plaintext highlighter-rouge">IntWithPower</code>, we can make <code class="language-plaintext highlighter-rouge">IntWithPower</code> an integral type. Of course, if we plan to do so in real life, it’s better to make sure that our type has all the characteristics of an integral type, but that’s beyond our scope here. (<em>Update: specializing most of the type traits results in Undefined Behaviour, so don’t do this in production code</em>)</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">std</span><span class="o">::</span><span class="n">is_integral</span><span class="o">&lt;</span><span class="n">IntWithPower</span><span class="o">&gt;</span> <span class="o">:</span> <span class="k">public</span> <span class="n">std</span><span class="o">::</span><span class="n">integral_constant</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">,</span> <span class="nb">true</span><span class="o">&gt;</span> <span class="p">{};</span>
</pre></table></code></div></div><p>Now we have to make sure that <code class="language-plaintext highlighter-rouge">IntWithPower</code> is convertible into a type that is accepted by <a href="http://www.cplusplus.com/reference/cmath/pow/"><code class="language-plaintext highlighter-rouge">pow</code></a>. It accepts floating-point types, but when it comes to <code class="language-plaintext highlighter-rouge">IntWithPower</code>, in my opinion, it’s more meaningful to convert it to an <code class="language-plaintext highlighter-rouge">int</code> and let the compiler perform the implicit conversion to <code class="language-plaintext highlighter-rouge">float</code> - even though it’s better to avoid implicit conversions in general. But after all, <code class="language-plaintext highlighter-rouge">IntWithPower</code> might be used in other contexts as well - as an integer.</p><p>For that we have to define <code class="language-plaintext highlighter-rouge">operator int</code>:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">IntWithPower</span> <span class="p">{</span>
<span class="nl">public:</span>
  <span class="n">IntWithPower</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="o">:</span> <span class="n">m_num</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="p">{}</span>
  <span class="kt">int</span> <span class="nf">power</span><span class="p">(</span><span class="n">IntWithPower</span> <span class="n">exp</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">pow</span><span class="p">(</span><span class="n">m_num</span><span class="p">,</span> <span class="n">exp</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">operator</span> <span class="kt">int</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">m_num</span><span class="p">;}</span>
<span class="k">private</span><span class="o">:</span>
  <span class="kt">int</span> <span class="n">m_num</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>If we check our example now, we’ll see that both <code class="language-plaintext highlighter-rouge">printPower(IntWithPower{5}, IntWithPower{4});</code> and <code class="language-plaintext highlighter-rouge">printPower(IntWithPower{5}, 4L);</code> will compile, but <code class="language-plaintext highlighter-rouge">printPower(IntWithPower{5}, 3.0);</code> will fail because <code class="language-plaintext highlighter-rouge">3.0</code> is not integral.</p><p>Right, as we just stated, <a href="http://www.cplusplus.com/reference/cmath/pow/"><code class="language-plaintext highlighter-rouge">pow</code></a> operates on floating-point numbers but we only accept integrals. Let’s update our concept accordingly!</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Base</span><span class="p">,</span> <span class="k">typename</span> <span class="nc">Exponent</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">HasPower</span> <span class="o">=</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">integral</span><span class="o">&lt;</span><span class="n">Exponent</span><span class="o">&gt;</span> <span class="o">||</span> <span class="n">std</span><span class="o">::</span><span class="n">floating_point</span><span class="o">&lt;</span><span class="n">Exponent</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">requires</span> <span class="p">(</span><span class="n">Base</span> <span class="n">base</span><span class="p">,</span> <span class="n">Exponent</span> <span class="n">exponent</span><span class="p">)</span> <span class="p">{</span> 
    <span class="n">base</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="n">exponent</span><span class="p">);</span>
<span class="p">};</span>
</pre></table></code></div></div><p>Now we can call <code class="language-plaintext highlighter-rouge">printPower</code> with any type for <code class="language-plaintext highlighter-rouge">base</code> that satisfies the <code class="language-plaintext highlighter-rouge">HasPower</code> concept and both with integral and floating-point numbers as an exponent.</p><p>Let’s have a look at the full example now:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;concepts&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;type_traits&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Base</span><span class="p">,</span> <span class="k">typename</span> <span class="nc">Exponent</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">HasPower</span> <span class="o">=</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">integral</span><span class="o">&lt;</span><span class="n">Exponent</span><span class="o">&gt;</span> <span class="o">||</span> <span class="n">std</span><span class="o">::</span><span class="n">floating_point</span><span class="o">&lt;</span><span class="n">Exponent</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">requires</span> <span class="p">(</span><span class="n">Base</span> <span class="n">base</span><span class="p">,</span> <span class="n">Exponent</span> <span class="n">exponent</span><span class="p">)</span> <span class="p">{</span> 
    <span class="n">base</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="n">exponent</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">IntWithPower</span> <span class="p">{</span>
<span class="nl">public:</span>
  <span class="n">IntWithPower</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="o">:</span> <span class="n">m_num</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="p">{}</span>
  <span class="kt">int</span> <span class="nf">power</span><span class="p">(</span><span class="n">IntWithPower</span> <span class="n">exp</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">pow</span><span class="p">(</span><span class="n">m_num</span><span class="p">,</span> <span class="n">exp</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">operator</span> <span class="kt">int</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">m_num</span><span class="p">;}</span>
<span class="k">private</span><span class="o">:</span>
  <span class="kt">int</span> <span class="n">m_num</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">std</span><span class="o">::</span><span class="n">is_integral</span><span class="o">&lt;</span><span class="n">IntWithPower</span><span class="o">&gt;</span> <span class="o">:</span> <span class="k">public</span> <span class="n">std</span><span class="o">::</span><span class="n">integral_constant</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">,</span> <span class="nb">true</span><span class="o">&gt;</span> <span class="p">{};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Exponent</span><span class="p">&gt;</span> 
<span class="kt">void</span> <span class="nf">printPower</span><span class="p">(</span><span class="n">HasPower</span><span class="o">&lt;</span><span class="n">Exponent</span><span class="o">&gt;</span> <span class="k">auto</span> <span class="n">number</span><span class="p">,</span> <span class="n">Exponent</span> <span class="n">exponent</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">number</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="n">exponent</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">printPower</span><span class="p">(</span><span class="n">IntWithPower</span><span class="p">{</span><span class="mi">5</span><span class="p">},</span> <span class="n">IntWithPower</span><span class="p">{</span><span class="mi">4</span><span class="p">});</span>
  <span class="n">printPower</span><span class="p">(</span><span class="n">IntWithPower</span><span class="p">{</span><span class="mi">5</span><span class="p">},</span> <span class="mi">4L</span><span class="p">);</span>
  <span class="n">printPower</span><span class="p">(</span><span class="n">IntWithPower</span><span class="p">{</span><span class="mi">5</span><span class="p">},</span> <span class="mf">3.0</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>In this example, we can observe how to write a concept that expects the presence of a certain function that can accept a parameter of different constrained types. We can also see how to make a type satisfying built-in type traits, such as <code class="language-plaintext highlighter-rouge">std::is_integral</code>.</p><h2 id="conclusion">Conclusion</h2><p>Today we started to discover how to write our own concepts. First, we combined already existing concepts into more complex ones, then we continued with making requirements on the validity of operations on the constrained types then we finished by writing requirements for any function call with or without a parameter list.</p><p><a href="https://www.sandordargo.com/blog/2021/03/17/write-your-own-cpp-concepts-part-ii">Next time we’ll continue with constraining the return types, making type and then nested requirements.</a></p><p>Stay tuned!</p><p><strong>If you want to learn more details about <em>C++ concepts</em>, <a href="https://leanpub.com/cppconcepts">check out my book on Leanpub</a>!</strong></p><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dev/'>dev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cpp/" class="post-tag no-text-decoration" >cpp</a> <a href="/tags/concepts/" class="post-tag no-text-decoration" >concepts</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a><div class="share-wrapper"> <a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=How to write your own C++ concepts? Part I. - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2021/03/10/write-your-own-cpp-concepts-part-i" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=How to write your own C++ concepts? Part I. - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2021/03/10/write-your-own-cpp-concepts-part-i" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=How to write your own C++ concepts? Part I. - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2021/03/10/write-your-own-cpp-concepts-part-i" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=How to write your own C++ concepts? Part I. - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2021/03/10/write-your-own-cpp-concepts-part-i" data-toggle="tooltip" data-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews"> <i class="fa-fw fab fa-hacker-news"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/2025/10/22/trip-report-budapest-cpp">Trip report: Budapest C++ - Breaking & Building C++</a><li><a href="/blog/2025/10/01/cpp26-optional-of-reference">C++26: std::optional&lt;T&amp;&gt;</a><li><a href="/blog/2025/09/24/trip-report-cppcon-2025">Trip report: CppCon 2025</a><li><a href="/blog/2025/07/23/format-your-own-type-part-1">Format your own type (Part 1)</a><li><a href="/blog/2025/07/02/cpponsea-trip-report">Trip report: C++ On Sea 2025</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self-improvement</a> <a class="post-tag" href="/tags/management/">management</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/2022/04/13/first-company-project-experience-with-cpp20"><div class="card-body"> <span class="timeago small" > Apr 13, 2022 <i class="unloaded">2022-04-13T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>My first work experience with C++20</h3><div class="text-muted small"><p> I joined a new team recently. We have our own internal microservices as well as libraries. While for microservices we support one main branch, for libraries we do have to support at least three, in...</p></div></div></a></div><div class="card"> <a href="/blog/2024/12/04/crtp-vs-concepts"><div class="card-body"> <span class="timeago small" > Dec 4, 2024 <i class="unloaded">2024-12-04T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Replace CRTP with concepts?</h3><div class="text-muted small"><p> In my Meeting C++ 2024 trip report, among my favourite ideas I mentioned Klaus Iglberger’s talk where he mentioned the possibility of replacing the curiously returning template pattern with the hel...</p></div></div></a></div><div class="card"> <a href="/blog/2021/02/10/cpp-concepts-motivations"><div class="card-body"> <span class="timeago small" > Feb 10, 2021 <i class="unloaded">2021-02-10T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The concept behind C++ concepts</h3><div class="text-muted small"><p> The idea of concepts is one of the major new features added to C++20. Concepts are an extension for templates. They can be used to perform compile-time validation of template arguments through bool...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/2021/03/03/cpp-concepts-in-standard-library" class="btn btn-outline-primary" prompt="Older"><p>Concepts shipped with the C++ standard library</p></a> <a href="/blog/2021/03/13/the-seniority-trap-you-have-to-ask-for-it" class="btn btn-outline-primary" prompt="Newer"><p>You have to ask for it!</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//sandordargo-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'How to write your own C++ concepts? Part I.'; this.page.url = 'https://www.sandordargo.com/blog/2021/03/10/write-your-own-cpp-concepts-part-i'; this.page.identifier = '/blog/2021/03/10/write-your-own-cpp-concepts-part-i'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><div id="amzn-assoc-ad-be5a767b-3346-40aa-bc00-2eff0ce33d2b"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=be5a767b-3346-40aa-bc00-2eff0ce33d2b"></script> <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us16.list-manage.com","uuid":"b073dbd5c29322302f59a8cd8","lid":"d26240427e"}) })</script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/SandorDargo">Sandor Dargo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self improvement</a> <a class="post-tag" href="/tags/management/">management</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.sandordargo.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
