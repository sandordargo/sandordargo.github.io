<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Discovering observers - part 3" /><meta property="og:locale" content="en_US" /><meta name="description" content="Over the last two weeks, we explored different implementations of the observer pattern in C++. We began with a very simple example, then evolved toward a more flexible, template- and inheritance-based design. This week, let’s move further — shifting away from inheritance and embracing composition. You might say (and you’d be right) that publishers and subscribers can just as well be used as members instead of base classes. In fact, with our previous implementation, handling changes inside subscribers felt more complicated than necessary. What we’d really like is this: subscribers that observe changes and trigger updates in their enclosing class in a coherent way. As one of the readers of Part 1 pointed out, this can be elegantly achieved if subscribers take callables. Step 1: Subscribers with callables We start by letting Subscriber accept a std::function, which gets called whenever the subscriber is updated: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 // https://godbolt.org/z/5x4GP9dac #include &lt;functional&gt; #include &lt;iostream&gt; #include &lt;string_view&gt; #include &lt;vector&gt; template &lt;typename Callable&gt; class Subscriber { public: virtual ~Subscriber() = default; virtual void update(Callable updater) = 0; }; template &lt;typename Message&gt; class Publisher { public: virtual ~Publisher() = default; void subscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Got a new subscriber\n&quot;; _subscribers.push_back(subscriber); } void unsubscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Someone unsubscribed\n&quot;; std::erase(_subscribers, subscriber); } void notify(Message message) const { std::cout &lt;&lt; &quot;Sending an update to &quot; &lt;&lt; _subscribers.size() &lt;&lt; &quot; subscriber(s)\n&quot;; for (auto* const subscriber : _subscribers) { notifyOne(subscriber, message); } } virtual void notifyOne(Subscriber&lt;Message&gt;* const, Message message) const = 0; private: std::vector&lt;Subscriber&lt;Message&gt;*&gt; _subscribers; }; using Setting1Message = std::pair&lt;std::string, int&gt;; using Setting2Message = std::pair&lt;std::string, bool&gt;; using Update1Message = std::function&lt;void(Setting1Message)&gt;; using Update2Message = std::function&lt;void(Setting2Message)&gt;; class Settings1Subscriber : public Subscriber&lt;Setting1Message&gt; { public: Settings1Subscriber(Update1Message func) : _func(func) {} void update(Setting1Message message) override { _func(message); } Update1Message _func; }; class Settings2Subscriber : public Subscriber&lt;Setting2Message&gt; { public: Settings2Subscriber(Update2Message func) : _func(func) {} void update(Setting2Message message) override { _func(message); } Update2Message _func; }; class SettingsPublisher : public Publisher&lt;Setting1Message&gt;, public Publisher&lt;Setting2Message&gt; { public: void notifyOne(Subscriber&lt;Setting1Message&gt;* const subscriber, Setting1Message message) const override { subscriber-&gt;update(message); } void notifyOne(Subscriber&lt;Setting2Message&gt;* const subscriber, Setting2Message message) const override { subscriber-&gt;update(message); } void setSetting1(int value) { _setting1 = value; Publisher&lt;Setting1Message&gt;::notify({&quot;setting1&quot;, _setting1}); } void setSetting2(bool value) { _setting2 = value; Publisher&lt;Setting2Message&gt;::notify({&quot;setting2&quot;, _setting2}); } void subscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::subscribe(subscriber); } void unsubscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::unsubscribe(subscriber); } void subscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::subscribe(subscriber); } void unsubscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::unsubscribe(subscriber); } private: int _setting1{0}; bool _setting2{0}; }; class SettingsUser { public: SettingsUser(SettingsPublisher&amp; pub) : _pub(pub), _s1([this](Setting1Message m) { printSetting1(m.second); }), _s2([this](Setting2Message m) { printSetting2(m.second); }) { _pub.subscribeSetting1(&amp;_s1); _pub.subscribeSetting2(&amp;_s2); } ~SettingsUser() { _pub.unsubscribeSetting1(&amp;_s1); _pub.unsubscribeSetting2(&amp;_s2); } void printSetting1(int setting1) { std::cout &lt;&lt; &quot;setting1 is &quot; &lt;&lt; setting1 &lt;&lt; &#39;\n&#39;; } void printSetting2(bool setting2) { std::cout &lt;&lt; &quot;setting2 is &quot; &lt;&lt; std::boolalpha &lt;&lt; setting2 &lt;&lt; &#39;\n&#39;; } private: SettingsPublisher&amp; _pub; Settings1Subscriber _s1; Settings2Subscriber _s2; }; int main() { SettingsPublisher pub; SettingsUser su(pub); pub.setSetting1(42); pub.setSetting2(true); } /* Got a new subscriber Got a new subscriber Sending an update to 1 subscriber(s) setting1 is 42 Sending an update to 1 subscriber(s) setting2 is true Someone unsubscribed Someone unsubscribed */ In this solution: SettingsUser owns subscribers as members. The user class subscribes/unsubscribes automatically in its constructor/destructor. Each subscriber takes a callable, so it can directly update the enclosing class. Pretty neat, right? Step 2: Removing inheritance from subscribers After looking closely, I realized we don’t need inheritance at all on the subscriber side. Subscribers can simply be template classes wrapping a callable: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 // https://godbolt.org/z/hrWK5bsfP #include &lt;functional&gt; #include &lt;iostream&gt; #include &lt;string_view&gt; #include &lt;vector&gt; template &lt;typename Message&gt; class Subscriber { using Callable = std::function&lt;void(Message)&gt;; public: Subscriber(Callable func) : _func(func) {} void update(Message message) { _func(message); } Callable _func; }; template &lt;typename Message&gt; class Publisher { public: using Callable = std::function&lt;void(Message)&gt;; virtual ~Publisher() = default; void subscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Got a new subscriber\n&quot;; _subscribers.push_back(subscriber); } void unsubscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Someone unsubscribed\n&quot;; std::erase(_subscribers, subscriber); } void notify(Message message) const { std::cout &lt;&lt; &quot;Sending an update to &quot; &lt;&lt; _subscribers.size() &lt;&lt; &quot; subscriber(s)\n&quot;; for (auto* const subscriber : _subscribers) { notifyOne(subscriber, message); } } virtual void notifyOne(Subscriber&lt;Message&gt;* const, Message message) const = 0; private: std::vector&lt;Subscriber&lt;Message&gt;*&gt; _subscribers; }; using Setting1Message = std::pair&lt;std::string, int&gt;; using Setting2Message = std::pair&lt;std::string, bool&gt;; class SettingsPublisher : public Publisher&lt;Setting1Message&gt;, public Publisher&lt;Setting2Message&gt; { public: void notifyOne(Subscriber&lt;Setting1Message&gt;* const subscriber, Setting1Message message) const override { subscriber-&gt;update(message); } void notifyOne(Subscriber&lt;Setting2Message&gt;* const subscriber, Setting2Message message) const override { subscriber-&gt;update(message); } void setSetting1(int value) { _setting1 = value; Publisher&lt;Setting1Message&gt;::notify({&quot;setting1&quot;, _setting1}); } void setSetting2(bool value) { _setting2 = value; Publisher&lt;Setting2Message&gt;::notify({&quot;setting2&quot;, _setting2}); } void subscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::subscribe(subscriber); } void unsubscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::unsubscribe(subscriber); } void subscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::subscribe(subscriber); } void unsubscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::unsubscribe(subscriber); } private: int _setting1{0}; bool _setting2{0}; }; class SettingsUser { public: SettingsUser(SettingsPublisher&amp; pub) : _pub(pub), _s1([this](Setting1Message m) { printSetting1(m.second); }), _s2([this](Setting2Message m) { printSetting2(m.second); }) { _pub.subscribeSetting1(&amp;_s1); _pub.subscribeSetting2(&amp;_s2); } ~SettingsUser() { _pub.unsubscribeSetting1(&amp;_s1); _pub.unsubscribeSetting2(&amp;_s2); } void printSetting1(int setting1) { std::cout &lt;&lt; &quot;setting1 is &quot; &lt;&lt; setting1 &lt;&lt; &#39;\n&#39;; } void printSetting2(bool setting2) { std::cout &lt;&lt; &quot;setting2 is &quot; &lt;&lt; std::boolalpha &lt;&lt; setting2 &lt;&lt; &#39;\n&#39;; } private: SettingsPublisher&amp; _pub; Subscriber&lt;Setting1Message&gt; _s1; Subscriber&lt;Setting2Message&gt; _s2; }; int main() { SettingsPublisher pub; SettingsUser su(pub); pub.setSetting1(42); pub.setSetting2(true); } Notice: No inheritance is required for Subscriber. We didn’t introduce extra template parameters. The alias for update functions is no longer needed—std::function is enough. At this point, subscribers are simplified and self-contained. Step 3: Simplifying publishers too Can we apply the same idea to publishers? Looking at our code: every notifyOne call was just forwarding to subscriber-&gt;update(message). That’s boilerplate we don’t need. By moving to composition, we can remove unnecessary overrides and forwarders. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 // https://godbolt.org/z/hGcvq9Pc6 #include &lt;functional&gt; #include &lt;iostream&gt; #include &lt;string_view&gt; #include &lt;vector&gt; template &lt;typename Message&gt; class Subscriber { using Callable = std::function&lt;void(Message)&gt;; public: Subscriber(Callable func) : _func(func) {} void update(Message message) { _func(message); } Callable _func; }; template &lt;typename Message&gt; class Publisher { public: void subscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Got a new subscriber\n&quot;; _subscribers.push_back(subscriber); } void unsubscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Someone unsubscribed\n&quot;; std::erase(_subscribers, subscriber); } void notify(Message message) const { std::cout &lt;&lt; &quot;Sending an update to &quot; &lt;&lt; _subscribers.size() &lt;&lt; &quot; subscriber(s)\n&quot;; for (auto* const subscriber : _subscribers) { subscriber-&gt;update(message); } } private: std::vector&lt;Subscriber&lt;Message&gt;*&gt; _subscribers; }; using Setting1Message = std::pair&lt;std::string, int&gt;; using Setting2Message = std::pair&lt;std::string, bool&gt;; class SettingsPublisher { public: void setSetting1(int value) { _setting1 = value; setting1_publisher.notify({&quot;setting1&quot;, _setting1}); } void setSetting2(bool value) { _setting2 = value; setting2_publisher.notify({&quot;setting2&quot;, _setting2}); } void subscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { setting1_publisher.subscribe(subscriber); } void unsubscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { setting1_publisher.unsubscribe(subscriber); } void subscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { setting2_publisher.subscribe(subscriber); } void unsubscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { setting2_publisher.unsubscribe(subscriber); } private: Publisher&lt;Setting1Message&gt; setting1_publisher; Publisher&lt;Setting2Message&gt; setting2_publisher; int _setting1{0}; bool _setting2{0}; }; class SettingsUser { public: SettingsUser(SettingsPublisher&amp; pub) : _pub(pub), _s1([this](Setting1Message m) { printSetting1(m.second); }), _s2([this](Setting2Message m) { printSetting2(m.second); }) { _pub.subscribeSetting1(&amp;_s1); _pub.subscribeSetting2(&amp;_s2); } ~SettingsUser() { _pub.unsubscribeSetting1(&amp;_s1); _pub.unsubscribeSetting2(&amp;_s2); } void printSetting1(int setting1) { std::cout &lt;&lt; &quot;setting1 is &quot; &lt;&lt; setting1 &lt;&lt; &#39;\n&#39;; } void printSetting2(bool setting2) { std::cout &lt;&lt; &quot;setting2 is &quot; &lt;&lt; std::boolalpha &lt;&lt; setting2 &lt;&lt; &#39;\n&#39;; } private: SettingsPublisher&amp; _pub; Subscriber&lt;Setting1Message&gt; _s1; Subscriber&lt;Setting2Message&gt; _s2; }; int main() { SettingsPublisher pub; SettingsUser su(pub); pub.setSetting1(42); pub.setSetting2(true); } Now: Publishers are lightweight containers that just manage subscriber lists and notify them. SettingsPublisher composes two Publisher instances, one per setting. Subscribers handle the logic of what to do when they’re updated. We’ve ended up with a clean, minimal, and flexible design. Conclusion Over three parts, we’ve gone on a journey with the observer pattern in C++: Part 1: A simple starting point, then generalized with inheritance and templates. Part 2: Struggled with multiple message types and discovered the trade-offs of inheritance-heavy designs. Part 3: Moved toward composition and callables, simplifying both publishers and subscribers, and removing boilerplate. The final design is: Type-safe: different message types are still supported. Composable: publishers and subscribers can be members rather than base classes. Minimal: no unnecessary inheritance or virtual forwarding. This design makes it easy to plug in new subscribers, keep publishers lean, and update enclosing classes coherently. The observer pattern is a classic, but as we’ve seen, the implementation choices matter. By gradually refining, we moved from a rigid inheritance-based approach to a clean, modern C++ solution leveraging composition and lambdas. Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter and let’s connect on Twitter!" /><meta property="og:description" content="Over the last two weeks, we explored different implementations of the observer pattern in C++. We began with a very simple example, then evolved toward a more flexible, template- and inheritance-based design. This week, let’s move further — shifting away from inheritance and embracing composition. You might say (and you’d be right) that publishers and subscribers can just as well be used as members instead of base classes. In fact, with our previous implementation, handling changes inside subscribers felt more complicated than necessary. What we’d really like is this: subscribers that observe changes and trigger updates in their enclosing class in a coherent way. As one of the readers of Part 1 pointed out, this can be elegantly achieved if subscribers take callables. Step 1: Subscribers with callables We start by letting Subscriber accept a std::function, which gets called whenever the subscriber is updated: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 // https://godbolt.org/z/5x4GP9dac #include &lt;functional&gt; #include &lt;iostream&gt; #include &lt;string_view&gt; #include &lt;vector&gt; template &lt;typename Callable&gt; class Subscriber { public: virtual ~Subscriber() = default; virtual void update(Callable updater) = 0; }; template &lt;typename Message&gt; class Publisher { public: virtual ~Publisher() = default; void subscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Got a new subscriber\n&quot;; _subscribers.push_back(subscriber); } void unsubscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Someone unsubscribed\n&quot;; std::erase(_subscribers, subscriber); } void notify(Message message) const { std::cout &lt;&lt; &quot;Sending an update to &quot; &lt;&lt; _subscribers.size() &lt;&lt; &quot; subscriber(s)\n&quot;; for (auto* const subscriber : _subscribers) { notifyOne(subscriber, message); } } virtual void notifyOne(Subscriber&lt;Message&gt;* const, Message message) const = 0; private: std::vector&lt;Subscriber&lt;Message&gt;*&gt; _subscribers; }; using Setting1Message = std::pair&lt;std::string, int&gt;; using Setting2Message = std::pair&lt;std::string, bool&gt;; using Update1Message = std::function&lt;void(Setting1Message)&gt;; using Update2Message = std::function&lt;void(Setting2Message)&gt;; class Settings1Subscriber : public Subscriber&lt;Setting1Message&gt; { public: Settings1Subscriber(Update1Message func) : _func(func) {} void update(Setting1Message message) override { _func(message); } Update1Message _func; }; class Settings2Subscriber : public Subscriber&lt;Setting2Message&gt; { public: Settings2Subscriber(Update2Message func) : _func(func) {} void update(Setting2Message message) override { _func(message); } Update2Message _func; }; class SettingsPublisher : public Publisher&lt;Setting1Message&gt;, public Publisher&lt;Setting2Message&gt; { public: void notifyOne(Subscriber&lt;Setting1Message&gt;* const subscriber, Setting1Message message) const override { subscriber-&gt;update(message); } void notifyOne(Subscriber&lt;Setting2Message&gt;* const subscriber, Setting2Message message) const override { subscriber-&gt;update(message); } void setSetting1(int value) { _setting1 = value; Publisher&lt;Setting1Message&gt;::notify({&quot;setting1&quot;, _setting1}); } void setSetting2(bool value) { _setting2 = value; Publisher&lt;Setting2Message&gt;::notify({&quot;setting2&quot;, _setting2}); } void subscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::subscribe(subscriber); } void unsubscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::unsubscribe(subscriber); } void subscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::subscribe(subscriber); } void unsubscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::unsubscribe(subscriber); } private: int _setting1{0}; bool _setting2{0}; }; class SettingsUser { public: SettingsUser(SettingsPublisher&amp; pub) : _pub(pub), _s1([this](Setting1Message m) { printSetting1(m.second); }), _s2([this](Setting2Message m) { printSetting2(m.second); }) { _pub.subscribeSetting1(&amp;_s1); _pub.subscribeSetting2(&amp;_s2); } ~SettingsUser() { _pub.unsubscribeSetting1(&amp;_s1); _pub.unsubscribeSetting2(&amp;_s2); } void printSetting1(int setting1) { std::cout &lt;&lt; &quot;setting1 is &quot; &lt;&lt; setting1 &lt;&lt; &#39;\n&#39;; } void printSetting2(bool setting2) { std::cout &lt;&lt; &quot;setting2 is &quot; &lt;&lt; std::boolalpha &lt;&lt; setting2 &lt;&lt; &#39;\n&#39;; } private: SettingsPublisher&amp; _pub; Settings1Subscriber _s1; Settings2Subscriber _s2; }; int main() { SettingsPublisher pub; SettingsUser su(pub); pub.setSetting1(42); pub.setSetting2(true); } /* Got a new subscriber Got a new subscriber Sending an update to 1 subscriber(s) setting1 is 42 Sending an update to 1 subscriber(s) setting2 is true Someone unsubscribed Someone unsubscribed */ In this solution: SettingsUser owns subscribers as members. The user class subscribes/unsubscribes automatically in its constructor/destructor. Each subscriber takes a callable, so it can directly update the enclosing class. Pretty neat, right? Step 2: Removing inheritance from subscribers After looking closely, I realized we don’t need inheritance at all on the subscriber side. Subscribers can simply be template classes wrapping a callable: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 // https://godbolt.org/z/hrWK5bsfP #include &lt;functional&gt; #include &lt;iostream&gt; #include &lt;string_view&gt; #include &lt;vector&gt; template &lt;typename Message&gt; class Subscriber { using Callable = std::function&lt;void(Message)&gt;; public: Subscriber(Callable func) : _func(func) {} void update(Message message) { _func(message); } Callable _func; }; template &lt;typename Message&gt; class Publisher { public: using Callable = std::function&lt;void(Message)&gt;; virtual ~Publisher() = default; void subscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Got a new subscriber\n&quot;; _subscribers.push_back(subscriber); } void unsubscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Someone unsubscribed\n&quot;; std::erase(_subscribers, subscriber); } void notify(Message message) const { std::cout &lt;&lt; &quot;Sending an update to &quot; &lt;&lt; _subscribers.size() &lt;&lt; &quot; subscriber(s)\n&quot;; for (auto* const subscriber : _subscribers) { notifyOne(subscriber, message); } } virtual void notifyOne(Subscriber&lt;Message&gt;* const, Message message) const = 0; private: std::vector&lt;Subscriber&lt;Message&gt;*&gt; _subscribers; }; using Setting1Message = std::pair&lt;std::string, int&gt;; using Setting2Message = std::pair&lt;std::string, bool&gt;; class SettingsPublisher : public Publisher&lt;Setting1Message&gt;, public Publisher&lt;Setting2Message&gt; { public: void notifyOne(Subscriber&lt;Setting1Message&gt;* const subscriber, Setting1Message message) const override { subscriber-&gt;update(message); } void notifyOne(Subscriber&lt;Setting2Message&gt;* const subscriber, Setting2Message message) const override { subscriber-&gt;update(message); } void setSetting1(int value) { _setting1 = value; Publisher&lt;Setting1Message&gt;::notify({&quot;setting1&quot;, _setting1}); } void setSetting2(bool value) { _setting2 = value; Publisher&lt;Setting2Message&gt;::notify({&quot;setting2&quot;, _setting2}); } void subscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::subscribe(subscriber); } void unsubscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::unsubscribe(subscriber); } void subscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::subscribe(subscriber); } void unsubscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::unsubscribe(subscriber); } private: int _setting1{0}; bool _setting2{0}; }; class SettingsUser { public: SettingsUser(SettingsPublisher&amp; pub) : _pub(pub), _s1([this](Setting1Message m) { printSetting1(m.second); }), _s2([this](Setting2Message m) { printSetting2(m.second); }) { _pub.subscribeSetting1(&amp;_s1); _pub.subscribeSetting2(&amp;_s2); } ~SettingsUser() { _pub.unsubscribeSetting1(&amp;_s1); _pub.unsubscribeSetting2(&amp;_s2); } void printSetting1(int setting1) { std::cout &lt;&lt; &quot;setting1 is &quot; &lt;&lt; setting1 &lt;&lt; &#39;\n&#39;; } void printSetting2(bool setting2) { std::cout &lt;&lt; &quot;setting2 is &quot; &lt;&lt; std::boolalpha &lt;&lt; setting2 &lt;&lt; &#39;\n&#39;; } private: SettingsPublisher&amp; _pub; Subscriber&lt;Setting1Message&gt; _s1; Subscriber&lt;Setting2Message&gt; _s2; }; int main() { SettingsPublisher pub; SettingsUser su(pub); pub.setSetting1(42); pub.setSetting2(true); } Notice: No inheritance is required for Subscriber. We didn’t introduce extra template parameters. The alias for update functions is no longer needed—std::function is enough. At this point, subscribers are simplified and self-contained. Step 3: Simplifying publishers too Can we apply the same idea to publishers? Looking at our code: every notifyOne call was just forwarding to subscriber-&gt;update(message). That’s boilerplate we don’t need. By moving to composition, we can remove unnecessary overrides and forwarders. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 // https://godbolt.org/z/hGcvq9Pc6 #include &lt;functional&gt; #include &lt;iostream&gt; #include &lt;string_view&gt; #include &lt;vector&gt; template &lt;typename Message&gt; class Subscriber { using Callable = std::function&lt;void(Message)&gt;; public: Subscriber(Callable func) : _func(func) {} void update(Message message) { _func(message); } Callable _func; }; template &lt;typename Message&gt; class Publisher { public: void subscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Got a new subscriber\n&quot;; _subscribers.push_back(subscriber); } void unsubscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Someone unsubscribed\n&quot;; std::erase(_subscribers, subscriber); } void notify(Message message) const { std::cout &lt;&lt; &quot;Sending an update to &quot; &lt;&lt; _subscribers.size() &lt;&lt; &quot; subscriber(s)\n&quot;; for (auto* const subscriber : _subscribers) { subscriber-&gt;update(message); } } private: std::vector&lt;Subscriber&lt;Message&gt;*&gt; _subscribers; }; using Setting1Message = std::pair&lt;std::string, int&gt;; using Setting2Message = std::pair&lt;std::string, bool&gt;; class SettingsPublisher { public: void setSetting1(int value) { _setting1 = value; setting1_publisher.notify({&quot;setting1&quot;, _setting1}); } void setSetting2(bool value) { _setting2 = value; setting2_publisher.notify({&quot;setting2&quot;, _setting2}); } void subscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { setting1_publisher.subscribe(subscriber); } void unsubscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { setting1_publisher.unsubscribe(subscriber); } void subscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { setting2_publisher.subscribe(subscriber); } void unsubscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { setting2_publisher.unsubscribe(subscriber); } private: Publisher&lt;Setting1Message&gt; setting1_publisher; Publisher&lt;Setting2Message&gt; setting2_publisher; int _setting1{0}; bool _setting2{0}; }; class SettingsUser { public: SettingsUser(SettingsPublisher&amp; pub) : _pub(pub), _s1([this](Setting1Message m) { printSetting1(m.second); }), _s2([this](Setting2Message m) { printSetting2(m.second); }) { _pub.subscribeSetting1(&amp;_s1); _pub.subscribeSetting2(&amp;_s2); } ~SettingsUser() { _pub.unsubscribeSetting1(&amp;_s1); _pub.unsubscribeSetting2(&amp;_s2); } void printSetting1(int setting1) { std::cout &lt;&lt; &quot;setting1 is &quot; &lt;&lt; setting1 &lt;&lt; &#39;\n&#39;; } void printSetting2(bool setting2) { std::cout &lt;&lt; &quot;setting2 is &quot; &lt;&lt; std::boolalpha &lt;&lt; setting2 &lt;&lt; &#39;\n&#39;; } private: SettingsPublisher&amp; _pub; Subscriber&lt;Setting1Message&gt; _s1; Subscriber&lt;Setting2Message&gt; _s2; }; int main() { SettingsPublisher pub; SettingsUser su(pub); pub.setSetting1(42); pub.setSetting2(true); } Now: Publishers are lightweight containers that just manage subscriber lists and notify them. SettingsPublisher composes two Publisher instances, one per setting. Subscribers handle the logic of what to do when they’re updated. We’ve ended up with a clean, minimal, and flexible design. Conclusion Over three parts, we’ve gone on a journey with the observer pattern in C++: Part 1: A simple starting point, then generalized with inheritance and templates. Part 2: Struggled with multiple message types and discovered the trade-offs of inheritance-heavy designs. Part 3: Moved toward composition and callables, simplifying both publishers and subscribers, and removing boilerplate. The final design is: Type-safe: different message types are still supported. Composable: publishers and subscribers can be members rather than base classes. Minimal: no unnecessary inheritance or virtual forwarding. This design makes it easy to plug in new subscribers, keep publishers lean, and update enclosing classes coherently. The observer pattern is a classic, but as we’ve seen, the implementation choices matter. By gradually refining, we moved from a rigid inheritance-based approach to a clean, modern C++ solution leveraging composition and lambdas. Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter and let’s connect on Twitter!" /><link rel="canonical" href="https://www.sandordargo.com/blog/2025/09/17/observers-part3" /><meta property="og:url" content="https://www.sandordargo.com/blog/2025/09/17/observers-part3" /><meta property="og:site_name" content="Sandor Dargo’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-09-17T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Discovering observers - part 3" /><meta name="twitter:site" content="@SandorDargo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-09-17T00:00:00+02:00","datePublished":"2025-09-17T00:00:00+02:00","description":"Over the last two weeks, we explored different implementations of the observer pattern in C++. We began with a very simple example, then evolved toward a more flexible, template- and inheritance-based design. This week, let’s move further — shifting away from inheritance and embracing composition. You might say (and you’d be right) that publishers and subscribers can just as well be used as members instead of base classes. In fact, with our previous implementation, handling changes inside subscribers felt more complicated than necessary. What we’d really like is this: subscribers that observe changes and trigger updates in their enclosing class in a coherent way. As one of the readers of Part 1 pointed out, this can be elegantly achieved if subscribers take callables. Step 1: Subscribers with callables We start by letting Subscriber accept a std::function, which gets called whenever the subscriber is updated: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 // https://godbolt.org/z/5x4GP9dac #include &lt;functional&gt; #include &lt;iostream&gt; #include &lt;string_view&gt; #include &lt;vector&gt; template &lt;typename Callable&gt; class Subscriber { public: virtual ~Subscriber() = default; virtual void update(Callable updater) = 0; }; template &lt;typename Message&gt; class Publisher { public: virtual ~Publisher() = default; void subscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Got a new subscriber\\n&quot;; _subscribers.push_back(subscriber); } void unsubscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Someone unsubscribed\\n&quot;; std::erase(_subscribers, subscriber); } void notify(Message message) const { std::cout &lt;&lt; &quot;Sending an update to &quot; &lt;&lt; _subscribers.size() &lt;&lt; &quot; subscriber(s)\\n&quot;; for (auto* const subscriber : _subscribers) { notifyOne(subscriber, message); } } virtual void notifyOne(Subscriber&lt;Message&gt;* const, Message message) const = 0; private: std::vector&lt;Subscriber&lt;Message&gt;*&gt; _subscribers; }; using Setting1Message = std::pair&lt;std::string, int&gt;; using Setting2Message = std::pair&lt;std::string, bool&gt;; using Update1Message = std::function&lt;void(Setting1Message)&gt;; using Update2Message = std::function&lt;void(Setting2Message)&gt;; class Settings1Subscriber : public Subscriber&lt;Setting1Message&gt; { public: Settings1Subscriber(Update1Message func) : _func(func) {} void update(Setting1Message message) override { _func(message); } Update1Message _func; }; class Settings2Subscriber : public Subscriber&lt;Setting2Message&gt; { public: Settings2Subscriber(Update2Message func) : _func(func) {} void update(Setting2Message message) override { _func(message); } Update2Message _func; }; class SettingsPublisher : public Publisher&lt;Setting1Message&gt;, public Publisher&lt;Setting2Message&gt; { public: void notifyOne(Subscriber&lt;Setting1Message&gt;* const subscriber, Setting1Message message) const override { subscriber-&gt;update(message); } void notifyOne(Subscriber&lt;Setting2Message&gt;* const subscriber, Setting2Message message) const override { subscriber-&gt;update(message); } void setSetting1(int value) { _setting1 = value; Publisher&lt;Setting1Message&gt;::notify({&quot;setting1&quot;, _setting1}); } void setSetting2(bool value) { _setting2 = value; Publisher&lt;Setting2Message&gt;::notify({&quot;setting2&quot;, _setting2}); } void subscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::subscribe(subscriber); } void unsubscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::unsubscribe(subscriber); } void subscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::subscribe(subscriber); } void unsubscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::unsubscribe(subscriber); } private: int _setting1{0}; bool _setting2{0}; }; class SettingsUser { public: SettingsUser(SettingsPublisher&amp; pub) : _pub(pub), _s1([this](Setting1Message m) { printSetting1(m.second); }), _s2([this](Setting2Message m) { printSetting2(m.second); }) { _pub.subscribeSetting1(&amp;_s1); _pub.subscribeSetting2(&amp;_s2); } ~SettingsUser() { _pub.unsubscribeSetting1(&amp;_s1); _pub.unsubscribeSetting2(&amp;_s2); } void printSetting1(int setting1) { std::cout &lt;&lt; &quot;setting1 is &quot; &lt;&lt; setting1 &lt;&lt; &#39;\\n&#39;; } void printSetting2(bool setting2) { std::cout &lt;&lt; &quot;setting2 is &quot; &lt;&lt; std::boolalpha &lt;&lt; setting2 &lt;&lt; &#39;\\n&#39;; } private: SettingsPublisher&amp; _pub; Settings1Subscriber _s1; Settings2Subscriber _s2; }; int main() { SettingsPublisher pub; SettingsUser su(pub); pub.setSetting1(42); pub.setSetting2(true); } /* Got a new subscriber Got a new subscriber Sending an update to 1 subscriber(s) setting1 is 42 Sending an update to 1 subscriber(s) setting2 is true Someone unsubscribed Someone unsubscribed */ In this solution: SettingsUser owns subscribers as members. The user class subscribes/unsubscribes automatically in its constructor/destructor. Each subscriber takes a callable, so it can directly update the enclosing class. Pretty neat, right? Step 2: Removing inheritance from subscribers After looking closely, I realized we don’t need inheritance at all on the subscriber side. Subscribers can simply be template classes wrapping a callable: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 // https://godbolt.org/z/hrWK5bsfP #include &lt;functional&gt; #include &lt;iostream&gt; #include &lt;string_view&gt; #include &lt;vector&gt; template &lt;typename Message&gt; class Subscriber { using Callable = std::function&lt;void(Message)&gt;; public: Subscriber(Callable func) : _func(func) {} void update(Message message) { _func(message); } Callable _func; }; template &lt;typename Message&gt; class Publisher { public: using Callable = std::function&lt;void(Message)&gt;; virtual ~Publisher() = default; void subscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Got a new subscriber\\n&quot;; _subscribers.push_back(subscriber); } void unsubscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Someone unsubscribed\\n&quot;; std::erase(_subscribers, subscriber); } void notify(Message message) const { std::cout &lt;&lt; &quot;Sending an update to &quot; &lt;&lt; _subscribers.size() &lt;&lt; &quot; subscriber(s)\\n&quot;; for (auto* const subscriber : _subscribers) { notifyOne(subscriber, message); } } virtual void notifyOne(Subscriber&lt;Message&gt;* const, Message message) const = 0; private: std::vector&lt;Subscriber&lt;Message&gt;*&gt; _subscribers; }; using Setting1Message = std::pair&lt;std::string, int&gt;; using Setting2Message = std::pair&lt;std::string, bool&gt;; class SettingsPublisher : public Publisher&lt;Setting1Message&gt;, public Publisher&lt;Setting2Message&gt; { public: void notifyOne(Subscriber&lt;Setting1Message&gt;* const subscriber, Setting1Message message) const override { subscriber-&gt;update(message); } void notifyOne(Subscriber&lt;Setting2Message&gt;* const subscriber, Setting2Message message) const override { subscriber-&gt;update(message); } void setSetting1(int value) { _setting1 = value; Publisher&lt;Setting1Message&gt;::notify({&quot;setting1&quot;, _setting1}); } void setSetting2(bool value) { _setting2 = value; Publisher&lt;Setting2Message&gt;::notify({&quot;setting2&quot;, _setting2}); } void subscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::subscribe(subscriber); } void unsubscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { Publisher&lt;Setting1Message&gt;::unsubscribe(subscriber); } void subscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::subscribe(subscriber); } void unsubscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { Publisher&lt;Setting2Message&gt;::unsubscribe(subscriber); } private: int _setting1{0}; bool _setting2{0}; }; class SettingsUser { public: SettingsUser(SettingsPublisher&amp; pub) : _pub(pub), _s1([this](Setting1Message m) { printSetting1(m.second); }), _s2([this](Setting2Message m) { printSetting2(m.second); }) { _pub.subscribeSetting1(&amp;_s1); _pub.subscribeSetting2(&amp;_s2); } ~SettingsUser() { _pub.unsubscribeSetting1(&amp;_s1); _pub.unsubscribeSetting2(&amp;_s2); } void printSetting1(int setting1) { std::cout &lt;&lt; &quot;setting1 is &quot; &lt;&lt; setting1 &lt;&lt; &#39;\\n&#39;; } void printSetting2(bool setting2) { std::cout &lt;&lt; &quot;setting2 is &quot; &lt;&lt; std::boolalpha &lt;&lt; setting2 &lt;&lt; &#39;\\n&#39;; } private: SettingsPublisher&amp; _pub; Subscriber&lt;Setting1Message&gt; _s1; Subscriber&lt;Setting2Message&gt; _s2; }; int main() { SettingsPublisher pub; SettingsUser su(pub); pub.setSetting1(42); pub.setSetting2(true); } Notice: No inheritance is required for Subscriber. We didn’t introduce extra template parameters. The alias for update functions is no longer needed—std::function is enough. At this point, subscribers are simplified and self-contained. Step 3: Simplifying publishers too Can we apply the same idea to publishers? Looking at our code: every notifyOne call was just forwarding to subscriber-&gt;update(message). That’s boilerplate we don’t need. By moving to composition, we can remove unnecessary overrides and forwarders. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 // https://godbolt.org/z/hGcvq9Pc6 #include &lt;functional&gt; #include &lt;iostream&gt; #include &lt;string_view&gt; #include &lt;vector&gt; template &lt;typename Message&gt; class Subscriber { using Callable = std::function&lt;void(Message)&gt;; public: Subscriber(Callable func) : _func(func) {} void update(Message message) { _func(message); } Callable _func; }; template &lt;typename Message&gt; class Publisher { public: void subscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Got a new subscriber\\n&quot;; _subscribers.push_back(subscriber); } void unsubscribe(Subscriber&lt;Message&gt;* subscriber) { std::cout &lt;&lt; &quot;Someone unsubscribed\\n&quot;; std::erase(_subscribers, subscriber); } void notify(Message message) const { std::cout &lt;&lt; &quot;Sending an update to &quot; &lt;&lt; _subscribers.size() &lt;&lt; &quot; subscriber(s)\\n&quot;; for (auto* const subscriber : _subscribers) { subscriber-&gt;update(message); } } private: std::vector&lt;Subscriber&lt;Message&gt;*&gt; _subscribers; }; using Setting1Message = std::pair&lt;std::string, int&gt;; using Setting2Message = std::pair&lt;std::string, bool&gt;; class SettingsPublisher { public: void setSetting1(int value) { _setting1 = value; setting1_publisher.notify({&quot;setting1&quot;, _setting1}); } void setSetting2(bool value) { _setting2 = value; setting2_publisher.notify({&quot;setting2&quot;, _setting2}); } void subscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { setting1_publisher.subscribe(subscriber); } void unsubscribeSetting1(Subscriber&lt;Setting1Message&gt;* subscriber) { setting1_publisher.unsubscribe(subscriber); } void subscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { setting2_publisher.subscribe(subscriber); } void unsubscribeSetting2(Subscriber&lt;Setting2Message&gt;* subscriber) { setting2_publisher.unsubscribe(subscriber); } private: Publisher&lt;Setting1Message&gt; setting1_publisher; Publisher&lt;Setting2Message&gt; setting2_publisher; int _setting1{0}; bool _setting2{0}; }; class SettingsUser { public: SettingsUser(SettingsPublisher&amp; pub) : _pub(pub), _s1([this](Setting1Message m) { printSetting1(m.second); }), _s2([this](Setting2Message m) { printSetting2(m.second); }) { _pub.subscribeSetting1(&amp;_s1); _pub.subscribeSetting2(&amp;_s2); } ~SettingsUser() { _pub.unsubscribeSetting1(&amp;_s1); _pub.unsubscribeSetting2(&amp;_s2); } void printSetting1(int setting1) { std::cout &lt;&lt; &quot;setting1 is &quot; &lt;&lt; setting1 &lt;&lt; &#39;\\n&#39;; } void printSetting2(bool setting2) { std::cout &lt;&lt; &quot;setting2 is &quot; &lt;&lt; std::boolalpha &lt;&lt; setting2 &lt;&lt; &#39;\\n&#39;; } private: SettingsPublisher&amp; _pub; Subscriber&lt;Setting1Message&gt; _s1; Subscriber&lt;Setting2Message&gt; _s2; }; int main() { SettingsPublisher pub; SettingsUser su(pub); pub.setSetting1(42); pub.setSetting2(true); } Now: Publishers are lightweight containers that just manage subscriber lists and notify them. SettingsPublisher composes two Publisher instances, one per setting. Subscribers handle the logic of what to do when they’re updated. We’ve ended up with a clean, minimal, and flexible design. Conclusion Over three parts, we’ve gone on a journey with the observer pattern in C++: Part 1: A simple starting point, then generalized with inheritance and templates. Part 2: Struggled with multiple message types and discovered the trade-offs of inheritance-heavy designs. Part 3: Moved toward composition and callables, simplifying both publishers and subscribers, and removing boilerplate. The final design is: Type-safe: different message types are still supported. Composable: publishers and subscribers can be members rather than base classes. Minimal: no unnecessary inheritance or virtual forwarding. This design makes it easy to plug in new subscribers, keep publishers lean, and update enclosing classes coherently. The observer pattern is a classic, but as we’ve seen, the implementation choices matter. By gradually refining, we moved from a rigid inheritance-based approach to a clean, modern C++ solution leveraging composition and lambdas. Connect deeper If you liked this article, please hit on the like button, subscribe to my newsletter and let’s connect on Twitter!","headline":"Discovering observers - part 3","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sandordargo.com/blog/2025/09/17/observers-part3"},"url":"https://www.sandordargo.com/blog/2025/09/17/observers-part3"}</script><title>Discovering observers - part 3 | Sandor Dargo's Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-89625019-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-89625019-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/SANDOR_DARGO_ROUND.JPG" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sandor Dargo's Blog</a></div><div class="site-subtitle font-italic">On C++, software development and books</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/books/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BOOKS</span> </a><li class="nav-item"> <a href="/speaking/" class="nav-link"> <i class="fa-fw fas fa-microphone ml-xl-3 mr-xl-3 unloaded"></i> <span>SPEAKING</span> </a><li class="nav-item"> <a href="/dailycpp/" class="nav-link"> <i class="fa-fw fas fa-link ml-xl-3 mr-xl-3 unloaded"></i> <span>DAILY C++</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>HI...</span> </a></ul><ul class="w-100"><li class="nav-item"> <a href="https://www.patreon.com/sandordargo" class="nav-link"> <img src="https://c5.patreon.com/external/logo/become_a_patron_button.png"></a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/sandordargo" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/SandorDargo" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sandor.dargo','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog"> Blog </a> </span> <span> <a href="/2025"> 2025 </a> </span> <span> <a href="/09"> 09 </a> </span> <span> <a href="/17"> 17 </a> </span> <span>Discovering observers - part 3</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Discovering observers - part 3</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Sandor Dargo </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Sep 17, 2025, 12:00 AM +0200" prep="on" > Sep 17 <i class="unloaded">2025-09-17T00:00:00+02:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1747 words">9 min</span></div></div><div class="post-content"><p>Over the last two weeks, we explored different implementations of the <strong>observer pattern</strong> in C++. <a href="https://www.sandordargo.com/blog/2025/09/03/observers-part1">We began with a very simple example</a>, then <a href="https://www.sandordargo.com/blog/2025/09/10/observers-part2">evolved toward a more flexible, template- and inheritance-based design</a>.</p><p>This week, let’s move further — shifting away from inheritance and embracing <strong>composition</strong>.</p><p>You might say (and you’d be right) that publishers and subscribers can just as well be used as members instead of base classes. In fact, with our previous implementation, handling changes inside subscribers felt more complicated than necessary.</p><p>What we’d really like is this: subscribers that observe changes and trigger updates in their enclosing class <em>in a coherent way</em>. As one of the readers of Part 1 pointed out, this can be elegantly achieved if <strong>subscribers take callables</strong>.</p><h2 id="step-1-subscribers-with-callables">Step 1: Subscribers with callables</h2><p>We start by letting <code class="language-plaintext highlighter-rouge">Subscriber</code> accept a <code class="language-plaintext highlighter-rouge">std::function</code>, which gets called whenever the subscriber is updated:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
</pre><td class="rouge-code"><pre><span class="c1">// https://godbolt.org/z/5x4GP9dac</span>

<span class="cp">#include</span> <span class="cpf">&lt;functional&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string_view&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Callable</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Subscriber</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Subscriber</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Callable</span> <span class="n">updater</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Publisher</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Publisher</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">subscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Got a new subscriber</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">_subscribers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">unsubscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Someone unsubscribed</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">erase</span><span class="p">(</span><span class="n">_subscribers</span><span class="p">,</span> <span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">notify</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Sending an update to "</span> <span class="o">&lt;&lt;</span> <span class="n">_subscribers</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
                  <span class="o">&lt;&lt;</span> <span class="s">" subscriber(s)</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">*</span> <span class="k">const</span> <span class="n">subscriber</span> <span class="o">:</span> <span class="n">_subscribers</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">notifyOne</span><span class="p">(</span><span class="n">subscriber</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="k">const</span><span class="p">,</span>
                           <span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*&gt;</span> <span class="n">_subscribers</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">Setting1Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Setting2Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">bool</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">using</span> <span class="n">Update1Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="n">Setting1Message</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Update2Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="n">Setting2Message</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Settings1Subscriber</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="n">Settings1Subscriber</span><span class="p">(</span><span class="n">Update1Message</span> <span class="n">func</span><span class="p">)</span> <span class="o">:</span> <span class="n">_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="p">{}</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">Setting1Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span> <span class="n">_func</span><span class="p">(</span><span class="n">message</span><span class="p">);</span> <span class="p">}</span>

    <span class="n">Update1Message</span> <span class="n">_func</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Settings2Subscriber</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="n">Settings2Subscriber</span><span class="p">(</span><span class="n">Update2Message</span> <span class="n">func</span><span class="p">)</span> <span class="o">:</span> <span class="n">_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="p">{}</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">Setting2Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span> <span class="n">_func</span><span class="p">(</span><span class="n">message</span><span class="p">);</span> <span class="p">}</span>

    <span class="n">Update2Message</span> <span class="n">_func</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">SettingsPublisher</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span><span class="p">,</span>
                          <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">Setting1Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">Setting2Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting1</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting1</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting1"</span><span class="p">,</span> <span class="n">_setting1</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting2</span><span class="p">(</span><span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting2</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting2"</span><span class="p">,</span> <span class="n">_setting2</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="kt">int</span> <span class="n">_setting1</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">bool</span> <span class="n">_setting2</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">SettingsUser</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="n">SettingsUser</span><span class="p">(</span><span class="n">SettingsPublisher</span><span class="o">&amp;</span> <span class="n">pub</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">_pub</span><span class="p">(</span><span class="n">pub</span><span class="p">),</span>
          <span class="n">_s1</span><span class="p">([</span><span class="k">this</span><span class="p">](</span><span class="n">Setting1Message</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span> <span class="n">printSetting1</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">second</span><span class="p">);</span> <span class="p">}),</span>
          <span class="n">_s2</span><span class="p">([</span><span class="k">this</span><span class="p">](</span><span class="n">Setting2Message</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span> <span class="n">printSetting2</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">second</span><span class="p">);</span> <span class="p">})</span> <span class="p">{</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s1</span><span class="p">);</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">subscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s2</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="o">~</span><span class="n">SettingsUser</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">unsubscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s1</span><span class="p">);</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">unsubscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s2</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">printSetting1</span><span class="p">(</span><span class="kt">int</span> <span class="n">setting1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"setting1 is "</span> <span class="o">&lt;&lt;</span> <span class="n">setting1</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">printSetting2</span><span class="p">(</span><span class="kt">bool</span> <span class="n">setting2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"setting2 is "</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span> <span class="o">&lt;&lt;</span> <span class="n">setting2</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="n">SettingsPublisher</span><span class="o">&amp;</span> <span class="n">_pub</span><span class="p">;</span>
    <span class="n">Settings1Subscriber</span> <span class="n">_s1</span><span class="p">;</span>
    <span class="n">Settings2Subscriber</span> <span class="n">_s2</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">SettingsPublisher</span> <span class="n">pub</span><span class="p">;</span>
    <span class="n">SettingsUser</span> <span class="n">su</span><span class="p">(</span><span class="n">pub</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting1</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting2</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/*
Got a new subscriber
Got a new subscriber
Sending an update to 1 subscriber(s)
setting1 is 42
Sending an update to 1 subscriber(s)
setting2 is true
Someone unsubscribed
Someone unsubscribed
*/</span>
</pre></table></code></div></div><p>In this solution:</p><ul><li><code class="language-plaintext highlighter-rouge">SettingsUser</code> owns subscribers as members.<li>The user class subscribes/unsubscribes automatically in its constructor/destructor.<li>Each subscriber takes a callable, so it can directly update the enclosing class.</ul><p>Pretty neat, right?</p><h2 id="step-2-removing-inheritance-from-subscribers">Step 2: Removing inheritance from subscribers</h2><p>After looking closely, I realized we don’t need inheritance at all on the subscriber side. Subscribers can simply be template classes wrapping a callable:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
</pre><td class="rouge-code"><pre><span class="c1">// https://godbolt.org/z/hrWK5bsfP</span>
<span class="cp">#include</span> <span class="cpf">&lt;functional&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string_view&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Subscriber</span> <span class="p">{</span>
   <span class="k">using</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="n">Message</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="nl">public:</span>
    <span class="n">Subscriber</span><span class="p">(</span><span class="n">Callable</span> <span class="n">func</span><span class="p">)</span> <span class="o">:</span> <span class="n">_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="p">{}</span>

    <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_func</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">Callable</span> <span class="n">_func</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Publisher</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">using</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="n">Message</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Publisher</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">subscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Got a new subscriber</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">_subscribers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">unsubscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Someone unsubscribed</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">erase</span><span class="p">(</span><span class="n">_subscribers</span><span class="p">,</span> <span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">notify</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Sending an update to "</span> <span class="o">&lt;&lt;</span> <span class="n">_subscribers</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
                  <span class="o">&lt;&lt;</span> <span class="s">" subscriber(s)</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">*</span> <span class="k">const</span> <span class="n">subscriber</span> <span class="o">:</span> <span class="n">_subscribers</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">notifyOne</span><span class="p">(</span><span class="n">subscriber</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="k">const</span><span class="p">,</span>
                           <span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*&gt;</span> <span class="n">_subscribers</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">Setting1Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Setting2Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">bool</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">SettingsPublisher</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span><span class="p">,</span>
                          <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">Setting1Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">Setting2Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting1</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting1</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting1"</span><span class="p">,</span> <span class="n">_setting1</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting2</span><span class="p">(</span><span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting2</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting2"</span><span class="p">,</span> <span class="n">_setting2</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="kt">int</span> <span class="n">_setting1</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">bool</span> <span class="n">_setting2</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">SettingsUser</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="n">SettingsUser</span><span class="p">(</span><span class="n">SettingsPublisher</span><span class="o">&amp;</span> <span class="n">pub</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">_pub</span><span class="p">(</span><span class="n">pub</span><span class="p">),</span>
          <span class="n">_s1</span><span class="p">([</span><span class="k">this</span><span class="p">](</span><span class="n">Setting1Message</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span> <span class="n">printSetting1</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">second</span><span class="p">);</span> <span class="p">}),</span>
          <span class="n">_s2</span><span class="p">([</span><span class="k">this</span><span class="p">](</span><span class="n">Setting2Message</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span> <span class="n">printSetting2</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">second</span><span class="p">);</span> <span class="p">})</span> <span class="p">{</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s1</span><span class="p">);</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">subscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s2</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="o">~</span><span class="n">SettingsUser</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">unsubscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s1</span><span class="p">);</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">unsubscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s2</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">printSetting1</span><span class="p">(</span><span class="kt">int</span> <span class="n">setting1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"setting1 is "</span> <span class="o">&lt;&lt;</span> <span class="n">setting1</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">printSetting2</span><span class="p">(</span><span class="kt">bool</span> <span class="n">setting2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"setting2 is "</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span> <span class="o">&lt;&lt;</span> <span class="n">setting2</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="n">SettingsPublisher</span><span class="o">&amp;</span> <span class="n">_pub</span><span class="p">;</span>
    <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span> <span class="n">_s1</span><span class="p">;</span>
    <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="n">_s2</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">SettingsPublisher</span> <span class="n">pub</span><span class="p">;</span>
    <span class="n">SettingsUser</span> <span class="n">su</span><span class="p">(</span><span class="n">pub</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting1</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting2</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Notice:</p><ul><li>No inheritance is required for Subscriber.<li>We didn’t introduce extra template parameters.<li>The alias for update functions is no longer needed—std::function is enough.</ul><p>At this point, subscribers are simplified and self-contained.</p><h2 id="step-3-simplifying-publishers-too">Step 3: Simplifying publishers too</h2><p>Can we apply the same idea to publishers?</p><p>Looking at our code: every <code class="language-plaintext highlighter-rouge">notifyOne</code> call was just forwarding to <code class="language-plaintext highlighter-rouge">subscriber-&gt;update(message)</code>. That’s boilerplate we don’t need. By moving to composition, we can remove unnecessary overrides and forwarders.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
</pre><td class="rouge-code"><pre><span class="c1">// https://godbolt.org/z/hGcvq9Pc6</span>
<span class="cp">#include</span> <span class="cpf">&lt;functional&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string_view&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Subscriber</span> <span class="p">{</span>
    <span class="k">using</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="n">Message</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>

   <span class="nl">public:</span>
    <span class="n">Subscriber</span><span class="p">(</span><span class="n">Callable</span> <span class="n">func</span><span class="p">)</span> <span class="o">:</span> <span class="n">_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="p">{}</span>

    <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="p">{</span> <span class="n">_func</span><span class="p">(</span><span class="n">message</span><span class="p">);</span> <span class="p">}</span>

    <span class="n">Callable</span> <span class="n">_func</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Publisher</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">subscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Got a new subscriber</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">_subscribers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">unsubscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Someone unsubscribed</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">erase</span><span class="p">(</span><span class="n">_subscribers</span><span class="p">,</span> <span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">notify</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Sending an update to "</span> <span class="o">&lt;&lt;</span> <span class="n">_subscribers</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
                  <span class="o">&lt;&lt;</span> <span class="s">" subscriber(s)</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">*</span> <span class="k">const</span> <span class="n">subscriber</span> <span class="o">:</span> <span class="n">_subscribers</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*&gt;</span> <span class="n">_subscribers</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">Setting1Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Setting2Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">bool</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">SettingsPublisher</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">setSetting1</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting1</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">setting1_publisher</span><span class="p">.</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting1"</span><span class="p">,</span> <span class="n">_setting1</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting2</span><span class="p">(</span><span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting2</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">setting2_publisher</span><span class="p">.</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting2"</span><span class="p">,</span> <span class="n">_setting2</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">setting1_publisher</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">setting1_publisher</span><span class="p">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">setting2_publisher</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">setting2_publisher</span><span class="p">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span> <span class="n">setting1_publisher</span><span class="p">;</span>
    <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="n">setting2_publisher</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">_setting1</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">bool</span> <span class="n">_setting2</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">SettingsUser</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="n">SettingsUser</span><span class="p">(</span><span class="n">SettingsPublisher</span><span class="o">&amp;</span> <span class="n">pub</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">_pub</span><span class="p">(</span><span class="n">pub</span><span class="p">),</span>
          <span class="n">_s1</span><span class="p">([</span><span class="k">this</span><span class="p">](</span><span class="n">Setting1Message</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span> <span class="n">printSetting1</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">second</span><span class="p">);</span> <span class="p">}),</span>
          <span class="n">_s2</span><span class="p">([</span><span class="k">this</span><span class="p">](</span><span class="n">Setting2Message</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span> <span class="n">printSetting2</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">second</span><span class="p">);</span> <span class="p">})</span> <span class="p">{</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s1</span><span class="p">);</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">subscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s2</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="o">~</span><span class="n">SettingsUser</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">unsubscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s1</span><span class="p">);</span>
        <span class="n">_pub</span><span class="p">.</span><span class="n">unsubscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_s2</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">printSetting1</span><span class="p">(</span><span class="kt">int</span> <span class="n">setting1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"setting1 is "</span> <span class="o">&lt;&lt;</span> <span class="n">setting1</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">printSetting2</span><span class="p">(</span><span class="kt">bool</span> <span class="n">setting2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"setting2 is "</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span> <span class="o">&lt;&lt;</span> <span class="n">setting2</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="n">SettingsPublisher</span><span class="o">&amp;</span> <span class="n">_pub</span><span class="p">;</span>
    <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span> <span class="n">_s1</span><span class="p">;</span>
    <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="n">_s2</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">SettingsPublisher</span> <span class="n">pub</span><span class="p">;</span>
    <span class="n">SettingsUser</span> <span class="n">su</span><span class="p">(</span><span class="n">pub</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting1</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting2</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now:</p><ul><li><code class="language-plaintext highlighter-rouge">Publisher</code>s are lightweight containers that just manage subscriber lists and notify them.<li><code class="language-plaintext highlighter-rouge">SettingsPublisher</code> composes two <code class="language-plaintext highlighter-rouge">Publisher</code> instances, one per setting.<li><code class="language-plaintext highlighter-rouge">Subscriber</code>s handle the logic of what to do when they’re updated.</ul><p>We’ve ended up with a clean, minimal, and flexible design.</p><h2 id="conclusion">Conclusion</h2><p>Over three parts, we’ve gone on a journey with the observer pattern in C++:</p><ul><li><a href="https://www.sandordargo.com/blog/2025/09/03/observers-part1">Part 1</a>: A simple starting point, then generalized with inheritance and templates.<li><a href="https://www.sandordargo.com/blog/2025/09/10/observers-part2">Part 2</a>: Struggled with multiple message types and discovered the trade-offs of inheritance-heavy designs.<li><a href="https://www.sandordargo.com/blog/2025/09/17/observers-part3">Part 3</a>: Moved toward composition and callables, simplifying both publishers and subscribers, and removing boilerplate.</ul><p>The final design is:</p><ul><li><strong>Type-safe</strong>: different message types are still supported.<li><strong>Composable</strong>: publishers and subscribers can be members rather than base classes.<li><strong>Minimal</strong>: no unnecessary inheritance or virtual forwarding.</ul><p>This design makes it easy to plug in new subscribers, keep publishers lean, and update enclosing classes coherently.</p><p>The observer pattern is a classic, but as we’ve seen, the implementation choices matter. By gradually refining, we moved from a rigid inheritance-based approach to a clean, modern C++ solution leveraging composition and lambdas.</p><h2 id="connect-deeper">Connect deeper</h2><p>If you liked this article, please</p><ul><li>hit on the like button,<li><a href="http://eepurl.com/gvcv1j">subscribe to my newsletter</a><li>and let’s connect on <a href="https://twitter.com/SandorDargo">Twitter</a>!</ul><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dev/'>dev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cpp/" class="post-tag no-text-decoration" >cpp</a> <a href="/tags/designpatterns/" class="post-tag no-text-decoration" >designpatterns</a> <a href="/tags/observer/" class="post-tag no-text-decoration" >observer</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a><div class="share-wrapper"> <a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Discovering observers - part 3 - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2025/09/17/observers-part3" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Discovering observers - part 3 - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2025/09/17/observers-part3" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Discovering observers - part 3 - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2025/09/17/observers-part3" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=Discovering observers - part 3 - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2025/09/17/observers-part3" data-toggle="tooltip" data-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews"> <i class="fa-fw fab fa-hacker-news"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/2025/10/22/trip-report-budapest-cpp">Trip report: Budapest C++ - Breaking & Building C++</a><li><a href="/blog/2025/10/01/cpp26-optional-of-reference">C++26: std::optional&lt;T&amp;&gt;</a><li><a href="/blog/2025/09/24/trip-report-cppcon-2025">Trip report: CppCon 2025</a><li><a href="/blog/2025/07/23/format-your-own-type-part-1">Format your own type (Part 1)</a><li><a href="/blog/2025/07/02/cpponsea-trip-report">Trip report: C++ On Sea 2025</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self-improvement</a> <a class="post-tag" href="/tags/management/">management</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/2025/09/03/observers-part1"><div class="card-body"> <span class="timeago small" > Sep 3 <i class="unloaded">2025-09-03T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Discovering observers - part 1</h3><div class="text-muted small"><p> The goal of this mini-series is to explore the Observer Design Pattern in C++, walking through different implementations and weighing their pros and cons. First, let’s briefly recap what the obser...</p></div></div></a></div><div class="card"> <a href="/blog/2025/09/10/observers-part2"><div class="card-body"> <span class="timeago small" > Sep 10 <i class="unloaded">2025-09-10T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Discovering observers - part 2</h3><div class="text-muted small"><p> Last week, we took the observer pattern from a very simple example and evolved it into a more flexible, template-based implementation in C++. We ended up with abstracted publishers and subscribers,...</p></div></div></a></div><div class="card"> <a href="/blog/2023/03/15/binary-sizes-and-observer-pattern"><div class="card-body"> <span class="timeago small" > Mar 15, 2023 <i class="unloaded">2023-03-15T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The observer pattern and binary sizes</h3><div class="text-muted small"><p> In the previous article on binary sizes, we discussed how the decorator pattern’s classic and modern implementation fares in terms of binary size. We saw that the modern implementation had a smalle...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/2025/09/10/observers-part2" class="btn btn-outline-primary" prompt="Older"><p>Discovering observers - part 2</p></a> <a href="/blog/2025/09/24/trip-report-cppcon-2025" class="btn btn-outline-primary" prompt="Newer"><p>Trip report: CppCon 2025</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//sandordargo-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Discovering observers - part 3'; this.page.url = 'https://www.sandordargo.com/blog/2025/09/17/observers-part3'; this.page.identifier = '/blog/2025/09/17/observers-part3'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><div id="amzn-assoc-ad-be5a767b-3346-40aa-bc00-2eff0ce33d2b"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=be5a767b-3346-40aa-bc00-2eff0ce33d2b"></script> <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us16.list-manage.com","uuid":"b073dbd5c29322302f59a8cd8","lid":"d26240427e"}) })</script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/SandorDargo">Sandor Dargo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self improvement</a> <a class="post-tag" href="/tags/management/">management</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.sandordargo.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
