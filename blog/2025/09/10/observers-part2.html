<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Discovering observers - part 2" /><meta property="og:locale" content="en_US" /><meta name="description" content="Last week, we took the observer pattern from a very simple example and evolved it into a more flexible, template-based implementation in C++. We ended up with abstracted publishers and subscribers, a templated message type for flexibility, and publishers controlling when and how updates are pushed." /><meta property="og:description" content="Last week, we took the observer pattern from a very simple example and evolved it into a more flexible, template-based implementation in C++. We ended up with abstracted publishers and subscribers, a templated message type for flexibility, and publishers controlling when and how updates are pushed." /><link rel="canonical" href="https://www.sandordargo.com/blog/2025/09/10/observers-part2" /><meta property="og:url" content="https://www.sandordargo.com/blog/2025/09/10/observers-part2" /><meta property="og:site_name" content="Sandor Dargo’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-09-10T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Discovering observers - part 2" /><meta name="twitter:site" content="@SandorDargo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2026-01-16T06:46:52+01:00","datePublished":"2025-09-10T00:00:00+02:00","description":"Last week, we took the observer pattern from a very simple example and evolved it into a more flexible, template-based implementation in C++. We ended up with abstracted publishers and subscribers, a templated message type for flexibility, and publishers controlling when and how updates are pushed.","headline":"Discovering observers - part 2","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sandordargo.com/blog/2025/09/10/observers-part2"},"url":"https://www.sandordargo.com/blog/2025/09/10/observers-part2"}</script><title>Discovering observers - part 2 | Sandor Dargo's Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-89625019-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-89625019-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/SANDOR_DARGO_ROUND.JPG" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sandor Dargo's Blog</a></div><div class="site-subtitle font-italic">On C++, software development and books</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/books/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BOOKS</span> </a><li class="nav-item"> <a href="/speaking/" class="nav-link"> <i class="fa-fw fas fa-microphone ml-xl-3 mr-xl-3 unloaded"></i> <span>SPEAKING</span> </a><li class="nav-item"> <a href="/dailycpp/" class="nav-link"> <i class="fa-fw fas fa-link ml-xl-3 mr-xl-3 unloaded"></i> <span>DAILY C++</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>HI...</span> </a></ul><ul class="w-100"><li class="nav-item"> <a href="https://www.patreon.com/sandordargo" class="nav-link"> <img src="https://c5.patreon.com/external/logo/become_a_patron_button.png"></a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/sandordargo" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/SandorDargo" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sandor.dargo','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog"> Blog </a> </span> <span> <a href="/2025"> 2025 </a> </span> <span> <a href="/09"> 09 </a> </span> <span> <a href="/10"> 10 </a> </span> <span>Discovering observers - part 2</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Discovering observers - part 2</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Sandor Dargo </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Sep 10, 2025, 12:00 AM +0200" prep="on" > Sep 10, 2025 <i class="unloaded">2025-09-10T00:00:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 16, 2026, 6:46 AM +0100" prefix="Updated " > Jan 16 <i class="unloaded">2026-01-16T06:46:52+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2540 words">14 min</span></div></div><div class="post-content"><p><a href="https://www.sandordargo.com/blog/2025/09/03/observers-part1">Last week</a>, we took the observer pattern from a very simple example and evolved it into a more flexible, template-based implementation in C++. We ended up with abstracted publishers and subscribers, a templated message type for flexibility, and publishers controlling when and how updates are pushed.</p><p>This week, we’re going to tackle the challenge of <strong>supporting multiple message types in a single publisher</strong>.</p><h2 id="first-attempt-multiple-inheritance-of-templated-bases">First attempt: multiple inheritance of templated bases</h2><p>It’s tempting to provide <strong>different specializations</strong> for our templates so the same publisher can push different message types.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
</pre><td class="rouge-code"><pre><span class="c1">// https://godbolt.org/z/9dWb5vabW</span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string_view&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Subscriber</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Subscriber</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Publisher</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Publisher</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">subscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Got a new subscriber</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">_subscribers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">unsubscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Someone unsubscribed</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">erase</span><span class="p">(</span><span class="n">_subscribers</span><span class="p">,</span> <span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="k">protected</span><span class="o">:</span>
    <span class="kt">void</span> <span class="n">notify</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Sending an update to "</span> <span class="o">&lt;&lt;</span> <span class="n">_subscribers</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
                  <span class="o">&lt;&lt;</span> <span class="s">" subscriber(s)</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">*</span> <span class="k">const</span> <span class="n">subscriber</span> <span class="o">:</span> <span class="n">_subscribers</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">notifyOne</span><span class="p">(</span><span class="n">subscriber</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="k">const</span><span class="p">,</span>
                           <span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*&gt;</span> <span class="n">_subscribers</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">Setting1Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Setting2Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">bool</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">SettingsSubscriber</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span><span class="p">,</span>
                           <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Setting1Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Subscriber is getting an update:</span><span class="se">\n</span><span class="s">"</span>
                  <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">"="</span> <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Setting2Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span> <span class="o">&lt;&lt;</span> <span class="s">"Subscriber is getting an update:</span><span class="se">\n</span><span class="s">"</span>
                  <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">"="</span> <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">SettingsPublisher</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span><span class="p">,</span>
                          <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">Setting1Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">Setting2Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting1</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting1</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting1"</span><span class="p">,</span> <span class="n">_setting1</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting2</span><span class="p">(</span><span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting2</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting2"</span><span class="p">,</span> <span class="n">_setting2</span><span class="p">});</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="kt">int</span> <span class="n">_setting1</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">bool</span> <span class="n">_setting2</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">SettingsPublisher</span> <span class="n">pub</span><span class="p">;</span>
    <span class="n">SettingsSubscriber</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">;</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span> <span class="c1">// ERROR!</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s2</span><span class="p">);</span> <span class="c1">// ERROR!</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting1</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span> <span class="c1">// ERROR!</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span> <span class="c1">// ERROR!</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting2</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/*
&lt;source&gt;: In function 'int main()':
&lt;source&gt;:89:9: error: request for member 'subscribe' is ambiguous
   89 |     pub.subscribe(&amp;s1);
      |         ^~~~~~~~~
&lt;source&gt;:16:10: note: candidates are: 'void Publisher&lt;Message&gt;::subscribe(Subscriber&lt;Message&gt;*) [with Message = std::pair&lt;std::__cxx11::basic_string&lt;char&gt;, bool&gt;]'
   16 |     void subscribe(Subscriber&lt;Message&gt;* subscriber) {
      |          ^~~~~~~~~
&lt;source&gt;:16:10: note:                 'void Publisher&lt;Message&gt;::subscribe(Subscriber&lt;Message&gt;*) [with Message = std::pair&lt;std::__cxx11::basic_string&lt;char&gt;, int&gt;]'
&lt;source&gt;:90:9: error: request for member 'subscribe' is ambiguous
   90 |     pub.subscribe(&amp;s2);
      |         ^~~~~~~~~
&lt;source&gt;:16:10: note: candidates are: 'void Publisher&lt;Message&gt;::subscribe(Subscriber&lt;Message&gt;*) [with Message = std::pair&lt;std::__cxx11::basic_string&lt;char&gt;, bool&gt;]'
   16 |     void subscribe(Subscriber&lt;Message&gt;* subscriber) {
      |          ^~~~~~~~~
&lt;source&gt;:16:10: note:                 'void Publisher&lt;Message&gt;::subscribe(Subscriber&lt;Message&gt;*) [with Message = std::pair&lt;std::__cxx11::basic_string&lt;char&gt;, int&gt;]'
&lt;source&gt;:92:9: error: request for member 'unsubscribe' is ambiguous
   92 |     pub.unsubscribe(&amp;s1);
      |         ^~~~~~~~~~~
&lt;source&gt;:21:10: note: candidates are: 'void Publisher&lt;Message&gt;::unsubscribe(Subscriber&lt;Message&gt;*) [with Message = std::pair&lt;std::__cxx11::basic_string&lt;char&gt;, bool&gt;]'
   21 |     void unsubscribe(Subscriber&lt;Message&gt;* subscriber) {
      |          ^~~~~~~~~~~
&lt;source&gt;:21:10: note:                 'void Publisher&lt;Message&gt;::unsubscribe(Subscriber&lt;Message&gt;*) [with Message = std::pair&lt;std::__cxx11::basic_string&lt;char&gt;, int&gt;]'
*/</span>
</pre></table></code></div></div><p>As the errors show, calls to <code class="language-plaintext highlighter-rouge">subscribe</code>/<code class="language-plaintext highlighter-rouge">unsubscribe</code> are ambiguous: the compiler doesn’t know which base <code class="language-plaintext highlighter-rouge">Publisher&lt;T&gt;</code> you mean.</p><p>We can disambiguate by qualifying the base, but it’s pretty ugly:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1">// https://godbolt.org/z/q4jnrj741</span>

<span class="c1">// Unchanged everything until main()</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">SettingsPublisher</span> <span class="n">pub</span><span class="p">;</span>
    <span class="n">SettingsSubscriber</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">;</span>
    
    <span class="c1">// Subscribe both subscribers to BOTH message types explicitly</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s2</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s2</span><span class="p">);</span>

    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting1</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>

    <span class="c1">// Unsubscribe s1 from BOTH channels</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>
    
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting2</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This compiles — but the public interface became painful to use - to say the least.</p><h2 id="attempt-2-separate-api-names-per-message-channel">Attempt #2: separate API names per message “channel”</h2><p>A mitigation is to give each “channel” its own explicit API on SettingsPublisher. This removes ambiguity but doesn’t scale as settings grow:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c1">// https://godbolt.org/z/WaajsfYoE</span>

<span class="c1">// The rest is unchanged</span>

<span class="k">class</span> <span class="nc">SettingsPublisher</span> <span class="cm">/* ... */</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="c1">// ..</span>
    <span class="kt">void</span> <span class="n">subscriberSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">);</span>
    <span class="kt">void</span> <span class="n">unsubscriberSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">);</span>

    <span class="kt">void</span> <span class="n">subscriberSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">);</span>
    <span class="kt">void</span> <span class="n">unsubscriberSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">SettingsPublisher</span> <span class="n">pub</span><span class="p">;</span>
    <span class="n">SettingsSubscriber</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">;</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s2</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting1</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">unsubscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting2</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

</pre></table></code></div></div><p>The problem is that we lost the nice interface of the publisher with unified names, but maybe this is what we wanted. Imagine, if instead of <code class="language-plaintext highlighter-rouge">setting1</code>, <code class="language-plaintext highlighter-rouge">setting2</code>, etc. we have <code class="language-plaintext highlighter-rouge">volume</code>, <code class="language-plaintext highlighter-rouge">speed</code>, <code class="language-plaintext highlighter-rouge">subtitles</code>, etc. You might take it as verbose, but it’s expressive.</p><h2 id="different-subscriber-classes-per-setting">Different subscriber classes per setting</h2><p>Notice that we implemented a <code class="language-plaintext highlighter-rouge">SettingsPublisher</code> supporting several publishers - through base classes. Maybe we want to make our intentions more explicit through different subscriber classes. For example, we could have:</p><ul><li>a class subscribing only to <code class="language-plaintext highlighter-rouge">setting1</code> changes<li>a class subscribing only to <code class="language-plaintext highlighter-rouge">setting2</code> changes<li>a class subscribing to all changes</ul><p>We could already instantiate <code class="language-plaintext highlighter-rouge">SettingsSubscriber</code> and subscribe to individual changes, but maybe we prefer to have different <code class="language-plaintext highlighter-rouge">Subscriber</code> implementations:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
</pre><td class="rouge-code"><pre><span class="c1">// https://godbolt.org/z/nEbx4qq8v</span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string_view&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Subscriber</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Subscriber</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Publisher</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Publisher</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">subscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Got a new subscriber</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">_subscribers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">unsubscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Someone unsubscribed</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">erase</span><span class="p">(</span><span class="n">_subscribers</span><span class="p">,</span> <span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="k">protected</span><span class="o">:</span>
    <span class="kt">void</span> <span class="n">notify</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Sending an update to "</span> <span class="o">&lt;&lt;</span> <span class="n">_subscribers</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
                  <span class="o">&lt;&lt;</span> <span class="s">" subscriber(s)</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">*</span> <span class="k">const</span> <span class="n">subscriber</span> <span class="o">:</span> <span class="n">_subscribers</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">notifyOne</span><span class="p">(</span><span class="n">subscriber</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="k">const</span><span class="p">,</span>
                           <span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*&gt;</span> <span class="n">_subscribers</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">Setting1Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Setting2Message</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">bool</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Settings1Subscriber</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Setting1Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Subscriber is getting an update:</span><span class="se">\n</span><span class="s">"</span>
                  <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">"="</span> <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Settings2Subscriber</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Setting2Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span> <span class="o">&lt;&lt;</span> <span class="s">"Subscriber is getting an update:</span><span class="se">\n</span><span class="s">"</span>
                  <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">"="</span> <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">AllSettingsSubscriber</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span><span class="p">,</span>
                              <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Setting1Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Subscriber is getting an update:</span><span class="se">\n</span><span class="s">"</span>
                  <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">"="</span> <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Setting2Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span> <span class="o">&lt;&lt;</span> <span class="s">"Subscriber is getting an update:</span><span class="se">\n</span><span class="s">"</span>
                  <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">"="</span> <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">SettingsPublisher</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;</span><span class="p">,</span>
                          <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">Setting1Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">Setting2Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting1</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting1</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting1"</span><span class="p">,</span> <span class="n">_setting1</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting2</span><span class="p">(</span><span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting2</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting2"</span><span class="p">,</span> <span class="n">_setting2</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting1Message</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">Setting2Message</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="kt">int</span> <span class="n">_setting1</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">bool</span> <span class="n">_setting2</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">SettingsPublisher</span> <span class="n">pub</span><span class="p">;</span>
    <span class="n">Settings1Subscriber</span> <span class="n">s11</span><span class="p">,</span> <span class="n">s12</span><span class="p">;</span>
    <span class="n">Settings2Subscriber</span> <span class="n">s21</span><span class="p">;</span>
    <span class="n">AllSettingsSubscriber</span> <span class="n">sa1</span><span class="p">;</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s11</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s12</span><span class="p">);</span>
    <span class="c1">// pub.subscribeSetting1(&amp;s21); // ERROR wrong subscriber for setting1</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s21</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sa1</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sa1</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting1</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">unsubscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sa1</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting2</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/*
Got a new subscriber
Got a new subscriber
Got a new subscriber
Got a new subscriber
Got a new subscriber
Sending an update to 3 subscriber(s)
Subscriber is getting an update:
setting1=42
Subscriber is getting an update:
setting1=42
Subscriber is getting an update:
setting1=42
Someone unsubscribed
Sending an update to 2 subscriber(s)
Subscriber is getting an update:
setting2=true
Subscriber is getting an update:
setting2=true
*/</span>
</pre></table></code></div></div><p>Where are we?</p><p>We have to implement a class template for each setting type - not necessarily for each setting, several settings can use the same message type. We have <code class="language-plaintext highlighter-rouge">string</code> key to identify the modified setting. At our examples, we only use the key in our print, but not much imagination is needed to see different usages.</p><p>Here is an example with one message type, but several settings.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
</pre><td class="rouge-code"><pre><span class="c1">// https://godbolt.org/z/3a5GhY9Th</span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string_view&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Subscriber</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Subscriber</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Publisher</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Publisher</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">subscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Got a new subscriber</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">_subscribers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">unsubscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Someone unsubscribed</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">erase</span><span class="p">(</span><span class="n">_subscribers</span><span class="p">,</span> <span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="k">protected</span><span class="o">:</span>
    <span class="kt">void</span> <span class="n">notify</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Sending an update to "</span> <span class="o">&lt;&lt;</span> <span class="n">_subscribers</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
                  <span class="o">&lt;&lt;</span> <span class="s">" subscriber(s)</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">*</span> <span class="k">const</span> <span class="n">subscriber</span> <span class="o">:</span> <span class="n">_subscribers</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">notifyOne</span><span class="p">(</span><span class="n">subscriber</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="k">const</span><span class="p">,</span>
                           <span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*&gt;</span> <span class="n">_subscribers</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">SettingMessage</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">SettingsSubscriber</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">SettingMessage</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Subscriber is getting an update:</span><span class="se">\n</span><span class="s">"</span>
                  <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">"="</span> <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">SettingsPublisher</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">SettingMessage</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting1</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting1</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting1"</span><span class="p">,</span> <span class="n">_setting1</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting2</span><span class="p">(</span><span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting2</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting2"</span><span class="p">,</span> <span class="n">_setting2</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting1</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">subscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;::</span><span class="n">subscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">unsubscribeSetting2</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;::</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="kt">int</span> <span class="n">_setting1</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">int</span> <span class="n">_setting2</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">SettingsPublisher</span> <span class="n">pub</span><span class="p">;</span>
    <span class="n">SettingsSubscriber</span> <span class="n">s11</span><span class="p">,</span> <span class="n">s12</span><span class="p">;</span>
    <span class="n">SettingsSubscriber</span> <span class="n">s21</span><span class="p">;</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s11</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s12</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">subscribeSetting2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s21</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting1</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
    <span class="n">pub</span><span class="p">.</span><span class="n">setSetting2</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/*
Got a new subscriber
Got a new subscriber
Got a new subscriber
Sending an update to 3 subscriber(s)
Subscriber is getting an update:
setting1=42
Subscriber is getting an update:
setting1=42
Subscriber is getting an update:
setting1=42
Sending an update to 3 subscriber(s)
Subscriber is getting an update:
setting2=1
Subscriber is getting an update:
setting2=1
Subscriber is getting an update:
setting2=1
*/</span>
</pre></table></code></div></div><p>The above example reveals another limitation. <code class="language-plaintext highlighter-rouge">Subscriber</code>s are effectively subscribed to all keys carried by <code class="language-plaintext highlighter-rouge">SettingMessage</code>. To subscribe per-key, we’d need extra bookkeeping (per-key subscriber lists), duplicating what the base <code class="language-plaintext highlighter-rouge">Publisher</code> already manages.</p><h2 id="a-pragmatic-split-one-publisher-per-setting">A pragmatic split: one publisher per setting</h2><p>The simplest clean cut is to have one publisher per setting (still using a common message shape), which keeps APIs small and intent clear:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
</pre><td class="rouge-code"><pre><span class="c1">// https://godbolt.org/z/az1ffsq1r</span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string_view&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Subscriber</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Subscriber</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Message</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Publisher</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">Publisher</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">subscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Got a new subscriber</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">_subscribers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">unsubscribe</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Someone unsubscribed</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">erase</span><span class="p">(</span><span class="n">_subscribers</span><span class="p">,</span> <span class="n">subscriber</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="k">protected</span><span class="o">:</span>
    <span class="kt">void</span> <span class="n">notify</span><span class="p">(</span><span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Sending an update to "</span> <span class="o">&lt;&lt;</span> <span class="n">_subscribers</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
                  <span class="o">&lt;&lt;</span> <span class="s">" subscriber(s)</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">*</span> <span class="k">const</span> <span class="n">subscriber</span> <span class="o">:</span> <span class="n">_subscribers</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">notifyOne</span><span class="p">(</span><span class="n">subscriber</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*</span> <span class="k">const</span><span class="p">,</span>
                           <span class="n">Message</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;*&gt;</span> <span class="n">_subscribers</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">SettingMessage</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">SettingsSubscriber</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">SettingMessage</span> <span class="n">message</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Subscriber is getting an update:</span><span class="se">\n</span><span class="s">"</span>
                  <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">"="</span> <span class="o">&lt;&lt;</span> <span class="n">message</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Settings1Publisher</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">SettingMessage</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting1</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting1"</span><span class="p">,</span> <span class="n">_setting1</span><span class="p">});</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="kt">int</span> <span class="n">_setting1</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Settings2Publisher</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;</span> <span class="p">{</span>
   <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">notifyOne</span><span class="p">(</span><span class="n">Subscriber</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;*</span> <span class="k">const</span> <span class="n">subscriber</span><span class="p">,</span>
                   <span class="n">SettingMessage</span> <span class="n">message</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="n">subscriber</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">setSetting</span><span class="p">(</span><span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_setting2</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
        <span class="n">Publisher</span><span class="o">&lt;</span><span class="n">SettingMessage</span><span class="o">&gt;::</span><span class="n">notify</span><span class="p">({</span><span class="s">"setting2"</span><span class="p">,</span> <span class="n">_setting2</span><span class="p">});</span>
    <span class="p">}</span>

   <span class="k">private</span><span class="o">:</span>
    <span class="kt">int</span> <span class="n">_setting2</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Settings1Publisher</span> <span class="n">pub1</span><span class="p">;</span>
    <span class="n">Settings2Publisher</span> <span class="n">pub2</span><span class="p">;</span>
    <span class="n">SettingsSubscriber</span> <span class="n">s11</span><span class="p">,</span> <span class="n">s12</span><span class="p">;</span>
    <span class="n">SettingsSubscriber</span> <span class="n">s21</span><span class="p">;</span>
    <span class="n">pub1</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s11</span><span class="p">);</span>
    <span class="n">pub2</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s12</span><span class="p">);</span>
    <span class="n">pub2</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s21</span><span class="p">);</span>
    <span class="n">pub1</span><span class="p">.</span><span class="n">setSetting</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
    <span class="n">pub2</span><span class="p">.</span><span class="n">setSetting</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/*
Got a new subscriber
Got a new subscriber
Got a new subscriber
Sending an update to 1 subscriber(s)
Subscriber is getting an update:
setting1=42
Sending an update to 2 subscriber(s)
Subscriber is getting an update:
setting2=1
Subscriber is getting an update:
setting2=1
*/</span>
</pre></table></code></div></div><p>By splitting publishers per setting, we avoid ambiguity, keep per-setting subscriber lists naturally separated, and reduce API noise. Notice how we’re drifting from deep inheritance toward composition of simple publishers, which often produces cleaner code.</p><p>We’ll explore that composition route next week.</p><h2 id="conclusion">Conclusion</h2><p>Supporting multiple message types under one publisher sounds convenient, but in practice it introduces API ambiguity, extra ceremony, and fragile coupling:</p><ul><li>Multiple inheritance of <code class="language-plaintext highlighter-rouge">Publisher&lt;T&gt;</code> bases leads to ambiguous calls (subscribe/unsubscribe), forcing awkward qualification.<li>Per-channel methods (e.g., <code class="language-plaintext highlighter-rouge">subscribeSetting1</code>, <code class="language-plaintext highlighter-rouge">subscribeSetting2</code>) remove ambiguity but don’t scale with the number of settings.<li>Collapsing to a single “keyed” message type centralizes notifications but requires per-key subscription bookkeeping, duplicating what the base publisher already manages.</ul><p>A pragmatic, maintainable compromise is to use one small publisher per setting (or per channel). This keeps responsibilities tight, APIs simple, and subscriber lists accurate. From here, the natural next step is to replace inheritance-heavy designs with composition. That’s where we’ll pick up next time.</p><h2 id="connect-deeper">Connect deeper</h2><p>If you liked this article, please</p><ul><li>hit on the like button,<li><a href="http://eepurl.com/gvcv1j">subscribe to my newsletter</a><li>and let’s connect on <a href="https://twitter.com/SandorDargo">Twitter</a>!</ul><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dev/'>dev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cpp/" class="post-tag no-text-decoration" >cpp</a> <a href="/tags/design-patterns/" class="post-tag no-text-decoration" >design patterns</a> <a href="/tags/observer/" class="post-tag no-text-decoration" >observer</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a><div class="share-wrapper"> <a href="https://www.patreon.com/sandordargo" style="float: left; padding-left: 0;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://c5.patreon.com/external/logo/become_a_patron_button.png" style="float: left; padding-left: 0;"></a> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Discovering observers - part 2 - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2025/09/10/observers-part2" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Discovering observers - part 2 - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2025/09/10/observers-part2" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Discovering observers - part 2 - Sandor Dargo's Blog&url=https://www.sandordargo.com/blog/2025/09/10/observers-part2" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=Discovering observers - part 2 - Sandor Dargo's Blog&u=https://www.sandordargo.com/blog/2025/09/10/observers-part2" data-toggle="tooltip" data-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews"> <i class="fa-fw fab fa-hacker-news"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/2026/01/21/clocks-part-8-cpp20-timezones">Time in C++: C++20 Brought Us Time Zones</a><li><a href="/blog/2019/04/10/lesson-of-a-booking-dont-trust-the-system">Lesson of a booking: Don't trust the system!</a><li><a href="/blog/2020/07/22/always-catch-exceptions-by-reference">Why should we always catch exceptions by reference?</a><li><a href="/blog/2020/11/28/emergent-design">Emergent Design: The Evolutionary Nature of Professional Software Development by Scott Bain</a><li><a href="/blog/2021/10/06/airy-code-reviews">Bring some fresh AIR and write effective code review comments</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self-improvement</a> <a class="post-tag" href="/tags/management/">management</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/2025/09/03/observers-part1"><div class="card-body"> <span class="timeago small" > Sep 3, 2025 <i class="unloaded">2025-09-03T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Discovering observers - part 1</h3><div class="text-muted small"><p> The goal of this mini-series is to explore the Observer Design Pattern in C++, walking through different implementations and weighing their pros and cons. First, let’s briefly recap what the obser...</p></div></div></a></div><div class="card"> <a href="/blog/2025/09/17/observers-part3"><div class="card-body"> <span class="timeago small" > Sep 17, 2025 <i class="unloaded">2025-09-17T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Discovering observers - part 3</h3><div class="text-muted small"><p> Over the last two weeks, we explored different implementations of the observer pattern in C++. We began with a very simple example, then evolved toward a more flexible, template- and inheritance-ba...</p></div></div></a></div><div class="card"> <a href="/blog/2023/03/15/binary-sizes-and-observer-pattern"><div class="card-body"> <span class="timeago small" > Mar 15, 2023 <i class="unloaded">2023-03-15T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The observer pattern and binary sizes</h3><div class="text-muted small"><p> In the previous article on binary sizes, we discussed how the decorator pattern’s classic and modern implementation fares in terms of binary size. We saw that the modern implementation had a smalle...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/2025/09/03/observers-part1" class="btn btn-outline-primary" prompt="Older"><p>Discovering observers - part 1</p></a> <a href="/blog/2025/09/17/observers-part3" class="btn btn-outline-primary" prompt="Newer"><p>Discovering observers - part 3</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//sandordargo-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Discovering observers - part 2'; this.page.url = 'https://www.sandordargo.com/blog/2025/09/10/observers-part2'; this.page.identifier = '/blog/2025/09/10/observers-part2'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><div id="amzn-assoc-ad-be5a767b-3346-40aa-bc00-2eff0ce33d2b"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=be5a767b-3346-40aa-bc00-2eff0ce33d2b"></script> <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us16.list-manage.com","uuid":"b073dbd5c29322302f59a8cd8","lid":"d26240427e"}) })</script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://twitter.com/SandorDargo">Sandor Dargo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/watercooler/">watercooler</a> <a class="post-tag" href="/tags/career/">career</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/cpp23/">cpp23</a> <a class="post-tag" href="/tags/stl/">stl</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/self-improvement/">self improvement</a> <a class="post-tag" href="/tags/management/">management</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.sandordargo.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
